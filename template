#!/bin/bash
. function.sh

usage()
{
	echot "\
usage: template [OPTION]... [one|two](one)
	one										perform the first command
	two										perform the second command
	--file <file>					the file for the command
	--server <server>			the server to use
	--interactive					prompt for changes
	--test								run in test mode
	--verbose							display detailed output"
	exit $1
}

init() 
{
	var='value'
}

args()
{
	unset file server interactive verbose test
	command='one'

	while [ "$1" != "" ]; do
		case $1 in
			-f|--file) shift; file=$1;;
			-s|--server) shift; server=$1;;
			-i|--interactive) interactive="true";;
			-t|--test) test="true";;
			-v|--verbose) verbose="true";;
			-h|--help) usage 0;;
			*) 
				if IsFunction ${1}Command; then
					command=$1
					args=( "${@:2}" )
					break; # remove if command does not have additional arguments
				else
					echoerr "Unknown argument $1"
					usage 1
				fi;;
		esac
		shift
	done

	[[ -z $command ]] && MissingOperand "command"
	[[ -z $file ]] && MissingOperand "file"
}

run()
{
	init
	args "$@"
	${command}Command "${args[@]}"
	exit $?
}

oneCommand()
{
	echo "command=$command args=${#args[@]} file=\"$file\" server=\"$server\" interactive=$interactive verbose=$verbose test=$test"
	echo "Command 1"
}

twoCommand()
{
	echo "Command 2"
}

run "$@"
