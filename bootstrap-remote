#!/usr/bin/env bash
. function.sh
# bootstrap-remote [REMOTE](pi@pi1) - bootstrap a remote system

init()
{
	. "${BASH_SOURCE[0]%/*}/bootstrap-config.sh" || return
	remote="${1:-pi@pi1}"
}

run()
{
	init "$@" || return
	configureSsh || return
	bootstrap || return
}

bootstrap()
{
	scp "$BIN/bootstrap-init" "$BIN/bootstrap-config.sh" "$remote:/tmp" || return
	ssh -t $remote bash -l "/tmp/bootstrap-init" || return
}

configureSsh()
{
	ssh $remote ls '~/.ssh >& /dev/null' && return
	ssh $remote '[[ -d ~/.ssh ]] || mkdir ~/.ssh' || return
	scp ~/.ssh/* ''$remote':~/.ssh' || return
}

run "$@"
