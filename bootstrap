#!/usr/bin/env bash
. bash.bashrc
. function.sh

run()
{
	init "$@" || return
	LinkDir "$PUB/Documents/data" /usr/local/data || return
	CopyCommonFiles || return
	inst --ignore-errors --no-run-prompt --hint "$install" bootstrap || return
}

init()
{
	computer="$1" install="$2"; shift 2; apps=( "$@" )
	[[ ! $computer ]] && MissingOperand "COMPUTER"
	[[ ! $install ]] && MissingOperand "INSTALL_DIR"
	! IsElevated && { EchoErr "bootstrap must be run as administrator"; return 1; }
	install="$(wtu "$install")"
}

LinkDir() # SRC LINK
{
	mkdir --parents "$1" || return
	MakeLink "$1" "$2" || return
}

CopyCommonFiles()
{
	[[ -d "$DATA/bin" ]] && return
	SyncLocalFiles --src-older "$computer"
}

run "$@"
