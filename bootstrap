#!/usr/bin/env bash
. function.sh

# bootstrap a system by copying files locally, generic to all platforms

run()
{
	init "$@" || return
	RunPlatform bootstrap || return
	ask 'Sync local files' && { SyncLocalFiles --src-older "$hostFiles" || return; }
	inst --ignore-errors --no-run-prompt --hint "$install" bootstrap || return
}

bootstrapWin()
{
	install="$(wtu "$install")"
	! IsElevated && { EchoErr "bootstrap must be run as administrator"; return 1; }
	LinkDir "$PUB/Documents/data" /usr/local/data || return
}

bootstrapDebian()
{
	[[ ! -d /usr/local/data ]] && { sudo mkdir "/usr/local/data" || return; }
	sudo chown $USER "/usr/local/data" || return
}

init()
{
	hostFiles="${1:-nas1}" install="$2"
}

LinkDir() # SRC LINK
{
	mkdir --parents "$1" || return
	MakeLink "$1" "$2" || return
}

run "$@"
