@echo off
SetLocal

gosub init
EndLocal /d SharedDocuments
quit %_?

REM Applications (AppCore, IntelAppCore)
REM
REM AppCore: office FoxitReader InternetExplorer Chrome BrowserHomePage SilverlightPlayer
REM IntelAppCore: VisionApp IntelSpeedDialer IntelBridgePlugIn
REM Other: Office/365/13/10/Final/Converters/Connectors
REM 	DesktopGadgets EverNote Omron Quicken SnagIt TouchPack WindowsLiveEssentials
REM 	Acrobat BitPim Mirada ScreenSavers Smilebox Vonage ZoneTick 
REM Book: Audible Kindle AdobeDigitalEditions MicrosoftReader Calibre calibre2opds
REM Browser:  Firefox InternetExplorer FlashPlayer Xmarks SilverlightPlayer Xmarks Cooliris
REM Clipboard: FreeClip
REM Collaboration: Skype ooVoo Trillian Pidgin Yugma Lync
REM Compression: WinZip 7Zip
REM Download: BitTorrent LimeWire InternetDownloadAccelerator (IDA)
REM Editor: sublime NotepadPP Emacs 
REM Google: Chrome GoogleDesktop GoogleToolbar Gears GoogleCommandLine Picasa
REM Intel:  IntelSpeedDialer IntelBridgePlugIn
REM News: FeedDemon
REM PDF: AdobeReader FoxIt PrimoPDF PDFzilla
REM Security: LastPass TrueCrypt  PGP Eraser eWallet SecretAgent 

REM Media (MediaCore)
REM
REM MediaCore: Audacity iTunes wmp ImageMagick JpegLosslessRotator Picasa HandBrake calibre calibre2opds AdobeDigitalEditions Plex
REM Audio: AlbumCoverArtDownloader AmazonCloudPlayer Audacity EvilLyrics TotalRecorder Mp3tag
REM Center: Plex
REM DVD: AnyDVD CloneDvd ImgBurn
REM Editing: AviDemux SonyVegas VideoStudio
REM Music: Sonos
REM Picture: AutoEnhance CoolPix Paint.NET Gimp ImageMagick JpegLosslessRotator EyeFi
REM Player: iTunes Pandora PowerDVD WinDVD wmp QuickTime
REM Video: HandBrake GraphEdit K-Lite WmpEncoder HdCodecPack CoreAVC HDHomeRun Comcast MediaCoder miro
REM Visualizations: WhiteCap Aeon
REM Other: Nero MceStandbyTool radioSHARK AirFoil PictureMotionBrowser

REM Game
REM
REM GameCore: Steam  PinnacleGameProfiler 
REM Games: BioShock Crysis Doom Hearts
REM Other: XboxWirelessReceiver GameJackal

REM Development (DevCore, IntelDevCore)
REM
REM DevCore: iis ss SqlPromt BlueGriffon doxygen
REM Platforms: .Net Java Android Asst
REM 
REM AsstDevCore: DevCore TortoiseSVN VisualSVN CruiseControlTray Telerik
REM AndroidDevCore: android
REM .NetDevCore: vs NUnit SilverlightSdk ReSharper .NetMemoryProfiler WebPlatformInstaller 
REM   vs/10/08 vs10clients  WebMatrix
REM   Telerik FxCop .NetSdk NDoc NAnt SnippetCompiler
REM   Regulator Reflector IsapiRewrite ComponentOne  DundasChart Infragistics 
REM   Packages: NugetPackageExplorer
REM JavaDevCore: jdk JavaDoc JavaSource Eclipse Ant
REM   EclipsePlugsIns: adClipsePlugin JBossTools
REM   ManageEngine JProbe DjJava
REM Revision Control: svn (TortoiseSVN, VisualSVN) git (GitExtensions TortoiseGit)
REM Documentation: doxygen
REM Debugging: DebuggingTools SymbolServer SourceServer LogParser
REM Database: DBArtisan Toad ERstudio OracleDrivers MicrosoftDb2Drivers
REM   SQL Server: ss/12/08r2/08/05 SsSamples SqlPrettyPrinter SqlPrompt
REM   MySQL: MySqlWorkbench
REM Languages: Perl Coldfusion Delphi
REM Services: SoapUI
 
REM Performance: dotTrace .NetMemoryProfiler
REM Reporting: CrystalReportServer11 TableauReader
REM Source  Control: TortoiseSVN
REM Web Design: BlueGriffon Expression Fireworks Freehand Dreamweaver Flash Homesite
REM Windows: WindowsSdk
REM XML: XmlNotepad XmlSpy 
REM Infrastructure: CloudFoundy
REM Other: CruiseControlTray Saba QualityCenter SilverRun ProVision Perl Python AmberPoint WebTrends RoboHelp  WindowsMobileDev WindowsDriverKit

REM Operating System
REM
REM OsCore: UnixCore pGina Sublime AutoHotKey CloneDrive SysInternals 7zip BeyondCompare
REM UnixCore: cygwin bash ssh
REM Other: environment ssd FileZilla SysInternals xxcopy Synology
REM   FileTransferManager Synergy growl MaxiVista ExtensionColumn LinkShellExtension
REM Unix: Cygwin ssh bash SubsystemForUnix
REM Windows: OsUpdate BaselineSecurityAnalyzer TweakUI DirectX WindowsAdminTools WindowsDesktopSearch 
REM Intel: IntelRemoteAccess, IntelSsdToolbox
REM Backup: Areca ConnectedNetworkBackup
REM Benchmark: Sandra PerformanceTest
REM Compare: BeyondCompare, WinMerge
REM Defense: SecurityEssentials NortonAntiVirusCorporate VirusScan
REM Defragmentation: Defraggler PerfectDisk MyDefrag
REM Directory: ApacheDirectoryStudio
REM Discovery: Bonjour
REM Disk: DriveMonitor DiskDirector TrueImage TrueImageWorkstation OsSelector EasyBCD OsLoader HdTune
REM Display: StarDock ObjectDock MaxiVista LogonStudio
REM Explorer: BetterExplorer PreviewHandlerPack
REM Human Interface: AutoHotKey  StrokeIt
REM ISO: CloneDrive MagicIso Alcohol52 MagicDisc DaemonTools IsoRecorder
REM Monitoring: Foglight
REM Network: Fiddler WireShark newt Nmap DynamicDns DynamicDnsCheck HttpWatch OpenVPN
REM Notification: Growl
REM Platform: Java .Net A+dobeAIR
REM Printing: AirPrint
REM Registry: RUndelete RegCleaner 
REM Remote Control: LogMeIn RealVNC UltraVNC VisionApp
REM Security: pGina FingerprintReader FingerAuth ProtectorSuite PSI UpdateChecker
REM Shell: PowerShell TakeCommand  TakeCommandPrepareImage
REM Storage: GoogleDrive DropBox iCloud SugarSync
REM Sync: gSyncit Easy2Sync
REM Performance : PerformanceTest QCheck  
REM Tuning:  SpeedFan ThinkPad FanController MotherboardMonitor
REM UPS: PowerPanel
REM Utility: NirSoftLauncher LiberKey
REM Virtualization: VMwareWorkstation VMwareServer VMwarePlayer VirtualPc VirtualServer, VirtualBox
REM Window: VistaSwitcher WinSplit

REM Server
REM
REM ServerCore: iis ss12
REM Micrsoft: SharePoint tfs10 tfs08

REM Hardware
REM
REM Apple: AirPortExpress
REM Gigabyte: GigabyteGaP35Dq6 EasyTune VgaEasyBoost
REM Bluetooth: BroadcomBluetooth  LinkSysBluetooth IoGearBluetooth
REM HP: Hp8560wLaptop
REM Lenovo: LenovoLaptop, LenovoT400Laptop
REM Intel: IntelRapidStorage  IntelProNetworkAdapter IntelSsdToolbox
REM   IntelMotherboardUtilities IntelDesktopUtilities IntelExtremeTuningUtility IntelIntegratorAssistant
REM   IntelDP67BG IntelP35 Intel865Perl 
REM Microsoft: MicrosoftMouse
REM RealTek: RealTekNic RealTekAudio 
REM Other: AiCharger nVidia  PowerMixer HarmonyRemote ViaEnvy24 IntelliTypePoint BrotherHl4070 EpsonV100 LogitechWebCam SetPoint
REM    CreativeSoundBlasterXFi SeaTools MotorolaDroid

REM
REM Other
REM
REM Windows Mobile: WindowsMobileCore DeviceCenter PocketQuicken WindowsMobileReader DockWare AdobeReaderPpc

REM Basic Template
:template
:AppName
text
************************
* App Name
************************
endtext

gosub run ""

echo Updating icons...
call MergeDir /q "%pp\(dir)" "%pp\Development\Other"
call MergeDir /q "%pp\(dir)" "%ao"
call MoveFile "%pd\(prog).lnk" "%pp\Applications"
call MoveFile "%pp\Applications\Office\Microsoft Word.lnk" "%ao\Word.lnk"
call DelFile "%pd\(prog).lnk"
call MakeShortcut "c:\dir1" "%pp\Applications\App.lnk"

return

REM Full Template
:AppName
REM Download: 
REM Installs:
text
************
* App Name
************
- (Display pre-installation instructions)
endtext

REM Run setup
gosub run ""

echo Moving data folder...
call MakeLink merge "%UserData\Adobe Digital Editions" hide "%UserDocuments\My Digital Editions"
call MergeDir /q /rename "%UserDocuments\Embarcadero" "%UserData\Embarcadero"
call DropBox MoveConfig "%AppData\FileZilla" "%CloudDocuments\data\FileZilla"

echo Creating directories...
call MakeDir c:\dir1\dir2

echo Updating registry...

REM Delete <startup program name> - <registry value>
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\NNN"

call registry import "%SetupFiles\(registration file).reg"

set r=HKCU\Software\Company\Program
call registry set "%r\key" REG_SZ value >& nul:
call registry set "%r\key" REG_SZ "%@RegQuote[value]" >& nul:

echo Registering objects...
regsvr32 /s (libraries to register)

echo Update web.config...
call XmlEdit Web.Config "/configuration/appSettings/add[@key='TFSNameUrl']/@value" http://%TfsDomain:%TfsHttpPort

echo Restoring the default profile...
call AppName profile restore default

echo Updating services...
call service manual (service name)

echo Updating tasks...
SchTasks /Change /Tn "(task name)" /Disable
SchTasks /Create /TN test /TR ls.exe /SC ONEVENT /EC System /MO "*[System[Provider[@Name='Microsoft-Windows-Power-Troubleshooter'] and EventID=1]]"
SchTasks /Create /RU %@SystemAccount[] /RP * /SC OnIdle /I %SleepTaskIdleTime /TN "sleep" /TR "%@sfn[%PublicDocuments\data\bin\]\tcc.exe /c SleepTaskSleep.btm"

echo Updating firewall...

REM Enable or disable a firewall rule
call firewall rule enable "SQL Server"

REM Add or update a firewall rule
call firewall rule add "SQL Server" `dir=in action=allow protocol=TCP localport=1433 profile=private ^
	program="%programs\Microsoft SQL Server\MSSQL.1\MSSQL\Binn\sqlservr.exe"`

call firewall rule add "SQL Server" `dir=in action=allow protocol=TCP localport=3180 profile=private ^
	program="%programs\Microsoft SQL Server\MSSQL.1\MSSQL\Binn\sqlservr.exe"`

call firewall rule add DCOM `dir=in action=allow protocol=TCP localport=135 profile=private program=%systemroot%\system32\svchost.exe service=rpcss`

REM Custom firewall rule
netsh advfirewall firewall set rule group="windows management instrumentation (wmi)" new enable=yes profile=private,domain
	
echo Updating shell extensions...
echo - Disable NNN, NNN
endtext
gosub RunProg ShExView32
pause

echo Updating path...
call SetVar /system /path path "%programs32\Cygwin\bin"

echo Updating icons...
call DelFile "%up\(user link to delete).lnk"
call DelFile "%pd\(desktop file to delete).lnk"
call MergeDir /q "%pp\(directory name)" "%ao"
call MergeDir /q /rename "%pp\(directory name)" "%ao\(new directory name)"
call MakeShortcut "c:\dir1" "%pp\Applications\App.lnk"

text
- (Display configuration instructions)
endtext
call sudo /standard EverNote startup
pause

text
- (Display post-installation instructions)
endtext

return

:init

call os init
set ao=%pp\Applications\Other
set ServerPrograms=%pp\%@if[ defined server ,Server,Development]

set rc=robocopy
set RcOptsRegular=/E /V /R:100 /W:2
set RcOptsMir=%RcOptsRegular /mir
set RcOpts=%RcOptsRegular

iff defined NewOs then
	set NetShareOptions=/grant:Everyone,full
else
	set NetShareOptions=
endiff

set SetupFiles=%@BatchDir[]\...\setup

gosub RunInit

REM Add remote bin folder to the path if there is no local bin folder
iff not IsDir "%AllUsersProfile\Documents\data\bin" then
  set path=%path;%SharedDocuments\data\bin
endiff

REM Default directories
if defined server .and. not IsDir "%ServerPrograms" call MakeDir "%ServerPrograms"

REM Get arguments
if %@IsHelpArg[%@UnQuote[%1]] == 1 goto usage

set select=

set arguments=%$

:GetArg

REM Find a specific install host
iff "%1" == "host" then
	if %# lt 2 goto usage
	
  call FindPublicDoc data\install %2
	if %_? != 0 return %_?
	
  shift 2  
  goto GetArg
	
endiff

REM Select the install host
iff "%1" == "select" then

  call FindPublicDoc data\install select
	if %? != 0 return %?
	
  shift
  goto GetArg
	
endiff

REM Change to the install folder
iff %# == 0 .or. "%1" == "cd" then
	shift
	
	call FindPublicDoc data\install %$  
  if %? == 0 cdd "%file"
  
	return 0 
	
endiff

REM Installs typically require elevation
iff %@IsElevated[] == 0 then
	call sudo /pause install.btm %arguments
	return 0
endiff

REM Optionally jump to a specific setup step.
iff %@LabelExists[here] then
	gosub here
	return 0
endiff

REM Execute choices on command line and exit
do while %# != 0

  set choice=%1
  shift

	iff %@LabelExists[%choice] == 1 then
		gosub %choice
	else
		echo %choice installation does not exist.
	endiff
	
	REM If the next argument is not an install assume the remaining arguments are leftover from the last install and leave
	if %# == 0 .or. %@LabelExists[%1] == 0 leave
	
	REM Pause between installs
	pause
	
enddo

return

:usage
text 
usage: install [select|host <host>](search) [cd|<application>*](cd)
  cd - change to the installation location
  search|select|host <host> - select or specify the installation host
endtext
quit 1

REM FindExe - find an executable in the installation directory or on an installation CD.  
REM
REM in: 
REM - exe: the executable to find, relative to the install directory
REM - exe: relative name of the exe to find.  If exe contains semi-colin list of wildcard filenames the user is prompted for the exe to use.
REM out:
REM - exe: an absolute path to the found exe.
REM - ExeDir: directory where the executable is found. and the parent
:FindExe [ExeArg]

REM Initialize
set exe=%@UnQuote[%ExeArg]
set dir=

REM Return if we do not need to find the exe

if "%@left[4,%exe]" == "http" .or. (IsFile "%exe" .and. %@IsWild[%exe] == 0 .and. "%@full[%exe]" == "%exe") return 0

REM Find the executable
call FindPublicDoc "data\install\%exe"
iff %_? != 0 then
	pause
	return 1
endiff

set install=%SharedDocuments\data\install
set exe=%install\%exe
set ExeDir=%@parent[%exe]

REM Prompt for the exectuable if it contains wildcards
iff %@IsWild[%exe] then

	call select.btm file "%exe"
	if %? != 0 return %?	
	
	set exe=%file
	
endiff

if "%exe" == "" pause

return %@if[ "%exe" == "" ,1,0]

:RunProg [program]

set prog=%@quote[%@search[%program]]
iff IsFile %prog then
	start /pgm %prog
endiff

return

:RunOption

switch "%option"

case "RunStandard"
	set RunStandard=call sudo /standard
	
case "OfficePlugin32"

	iff "%@ExecStr[call office.btm architecture]" == "x64" then
		EchoErr This install is not supported by Office x64.
		call ask.btm `Do you want to continue anyway` n
		return %@if[ %? == 1 ,0,1]
	endiff

endswitch

return 0

:run [ExeArg options]

iff %@words[%options] gt 0 then
	for option in (%@UnQuote[%options]) (
		gosub RunOption
		if %_? != 0 LeaveFor
	)
	if %_? != 2 return 1
endiff

REM Arguments
set exe=%@UnQuote[%ExeArg]
iff "%exe" == "" then 
	EchoErr Executable was not specified.
	return 1
endiff

REM Find the executable
gosub FindExe "%exe"
if %_? != 0 return %_?

gosub RunExe "%exe"
return %_?

REM exe - executable to run
REM NoCleanup - if defined do not cleanup
REM RunOptions - options to pass to executable
REM InstallDir - installation directory for folders and archive (zip) files
REM PostRun - if specified, secondary executable to run
:RunExe [ExeArg]

REM Arguments
set exe=%@UnQuote[%ExeArg]

REM Initialize
set ran=
set DefaultResponse=y 
set prefix=%@left[4,%exe]
   
iff "%prefix" == "http" then
	set ExeDesc=%exe		
else
	set ExeDesc=%@word["\",-0,%@path[%exe]]\%@fileName[%exe]
endiff

set ExeExt=%@ext["%exe"]
		
call ask `Do you want to run %ExeDesc?`
iff %? == 0 then
	gosub RunExeCleanup
  return 0
endiff

set ran=true

if "%prefix" != "http" pushd "%@parent[%exe]"
  
REM Folder
iff IsDir "%exe" then

	gosub PrepareInstallDir
	if %_? != 0 return %?

	call CopyDir "%exe" "%InstallDir"
	set NoPause=
		
REM archive - extract to InstallDir,  move up archive files to this folder if the root of archive contains only a single directory
elseiff %@IsArchive[%ExeExt] == 1 then

	gosub PrepareInstallDir
	if %_? != 0 return %?

  7z.exe x -o"%InstallDir" "%exe"		

	REM  Move up archive files to this folder if the root of archive contains only a single directory. 
	REM NumFiles == 1 ensures there is only one file or directory, NumDirs ensures it is a directory
	iff %@NumFiles["%InstallDir"] == 1 .and. %@NumDirs["%InstallDir"] == 1 then
		set dir=%@FindFirst["%InstallDir\*"]
		call MoveEx "%dir\*" "%InstallDir"
		rd "%dir"
	endiff
	set NoPause=

REM ShellRun
elseiff "%ExeExt" == "air" .or. "%ExeExt" == "msu" .or. "%ExeExt" == "xpi" then
	ShellRun "%@filename[%exe]" %RunOptions%
	
REM http
elseiff "%prefix" == "http" then
  ShellRun "%exe"
    
REM msi
elseiff "%ExeExt" == "msi" then
  start /pgm msiexec /i "%@filename[%exe]" %RunOptions%
    
REM bat
elseiff "%ExeExt" == "bat" then
  call %@filename[%exe] 
	    
REM iso
else iff "%ExeExt" == "iso" then
  call iso mount 1 "%@filename[%exe%]"    

REM registry file
else iff "%ExeExt" == "iso" then
  call registry 64 import "%@filename[%exe%]"

REM Windows Gadget, AdobeAIR program, Visual Studio extension
else iff "%ExeExt" == "gadget" .or. "%ExeExt" == "air" .or. "%ExeExt" == "vsix" then
  ShellRun "%@FileName[%exe]"
	
REM exe
else
  iff defined RunStandard then
		call sudo /standard "%exe" %RunOptions%
	else
		start /pgm "%@filename[%exe]" %RunOptions%
	endiff
    
endiff
  
if "%prefix" != "http" popd

iff "%PostRun" != "" then
	start /pgm  %@quote[%PostRun] %RunOptions%
endiff

iff defined NoPause then
  set NoPause=
else
  pause When the program has finished running press any key...
endiff

gosub RunExeCleanup

return 0

:RunExeCleanup

iff not defined NoCleanup then

	iff %ExeExt == iso then
		call iso unmountall
	endiff

endiff

gosub RunInit

return

:RunInit
set RunOptions=
set NoCleanup=
set RcOpts=%RcOptsRegular
set PostRun=
set RunStandard=
return

:PrepareInstallDir

iff "%InstallDir" == "" then
	echo Installation directory was not specified.
	return 1
endiff
		
iff IsDir "%InstallDir" then
	call ask `%@name[%InstallDir] exists.  Do you want to reinstall?` n
	if %? == 0 return 1
endiff

call DelDir ask "%InstallDir"
if %? != 0 return %?

call MakeDir "%InstallDir"
if %? != 0 return %?

return 0

:GetPid

input `/c `%@word["\",-0,%@path[%exe]]\%@fileName[%exe]` Product identifier (enter to skip)? ` %%pid
   
iff "%pid" != "" then
	set RunOptions=PIDKEY=%pid %RunOptions%
  return
endiff

return

:test
gosub FindExe "Sun\Java\jdk\*.exe;*.jar" j2sdk-1_4_2_05-windows-x86-p.exe
echo %exe
return

:environment

call ask `Set console defaults?` y
if %? == 1 call SetConsoleDefaults

call ask `Set operating system environment defaults?` y
if %? == 1 call os environment set

return

:core
text
**************************
* Core Setup
**************************
- Get initial registration informatiom from lastpass.com web site
endtext

REM Common
call install.btm SysInternals Sublime AutoHotKey BeyondCompare UnixCore CloneDrive 7zip pGina ^
	VistaSwitcher WinSplit UpdateChecker OsUpdate ^
	InternetExplorer Chrome BrowserHomePage FoxitReader jre .NET

REM Computer specific
switch %ComputerName

case oversoul
	call install.btm IntelDP67BG nVidia DropBox PowerMixer PowerPanel ^
		office365 SnagIt EverNote LastPass Quicken TrueCrypt ^
		EpsonV100 EyeFi calibre calibre2opds Sonos MediaCore

case jjbutare-mobl
	call install.btm Hp8560wLaptop DropBox PowerMixer OpenVPN IntelDevCore ^
		office13 SnagIt DesktopGadgets EverNote LastPass WindowsAdminTools IntelAppCore

case dune
	call install.btm GigabyteGaP35Dq6 nVidia PowerMixer DropBox LogMeIn

case shadow
	call install.btm GigabyteGaP35Dq6 nVidia LogMeIn

case ws08
	call install.btm iis ss08 TeamFoundationServer
	
endswitch

return

:UnixCore
text
************************
* UNIX Core
************************
endtext
call install.btm cygwin bash ssh
return

:IntelAppCore
REM - http://wrcs.intel.com/InfoSec/Security_Tools/Encryption/Whole+Disk+Encryption+FAQ.htm
text
************************
* Intel App Core
************************
endtext

call install.btm VisionApp IntelSpeedDialer IntelBridgePlugIn
call intel.btm cleanup

call MakeLink merge "%UserData\Add-in Express" hide "%UserDocuments\Add-in Express"

return

:DevCore
text
************************
* Development Core
************************
endtext

REM Directories
echo Creating directories...
call MakeDir "%UserDocuments\code\test"
call MakeDir "%LocalCode\test"

REM Icons
echo Updating icons...
call MakeShortcut "%LocalCode" "%pp\Development\Code.lnk"

REM Data folders
echo Moving data folders...
call MakeLink merge "%UserDocuments\code\web\sites" hide "%UserDocuments\My Web Sites"
call MakeLink merge "%UserData\LINQPad" hide "%UserDocuments\LINQPad Queries"

REM Core
call install.btm git iis BlueGriffon

REM Database
call install.btm ss SqlPrompt

REM Platforms

call ask `Do you want to install the .NET development platform core?` n
if %? == 1 gosub .NetDevCore

call ask `Do you want to install the JAVA development platform core?` n
if %? == 1 gosub gosub JavaDevCore

return

:git
text
*******************************
* git Source Control
*******************************
endtext
call install.btm CygwinGit GitExtensions TortoiseGit GitHub
return

:IntelDevCore
text
*******************************
* Intel Development Core
*******************************
endtext

call ask `Install Antidote?` y
iff %? == 1 then
	echo Installing Antidote...
	cmd /c \\azscsisweb998\f$\Software\AntidoteSetup\AntidoteSetup.cmd
	attrib /d +h c:\winnt
endiff

REM ProfileBroker: C:\Program Files\ITBAS\ProfileManager, C:\Program Files\ITBAS\Profiles
REM c:\windows\system32\ProfileManager.xml, c:\winnt\system32\ProfileManager.xml

call ask `Update machine.config?` y
iff %? == 1 then
	echo Updating machine.config...
	echo `<configuration><appSettings><add key="Environment" value="Development"/>...`
	call .net.btm MachineConfig
	pause
endiff

call install.btm DevCore TortoiseSVN CruiseControlTray SilverlightSdk Telerik

return

:MediaCore
text
************************
* Media Core
************************
endtext

echo Updating icons...
call MakeShortcut "%PublicBin\win32\gspot.exe" "%pp\Media\GSpot.lnk"
call MakeShortcut "%PublicBin\win32\InstalledCodec.exe" "%pp\Media\Installed Codecs.lnk"
call MakeShortcut "%PublicBin\win32\DSFMgr.exe" "%pp\Media\DirectShow Filter Manager.lnk"

echo Registering libraries...

REM Registerr taglib-sharp.dll, which is used by MediaCmd.exe
REM call .net.btm register "%PublicData\lib\taglib-sharp.dll"

return

:GameCore

gosub Steam
gosub XboxWirelessReceiver
gosub PinnacleGameProfiler
gosub GameJackal
gosub GameTap
gosub XboxWirelessReceiver

return

:ServerCore
text
************************
* Server Core
************************
endtext

call install.btm iis ss12

return

:WindowsMobileCore
text
************************
* Windows Moibile Core
************************
endtext

call instal.btm DeviceCenter

echo Opening Pocket PC setup instructions...
ShellRun "%UserDocuments\Technical\Pocket PC.doc"

return

:.net
REM reference - http://msdn.microsoft.com/winfx/ http://www.microsoft.com/net/Download.aspx
text
************************
* .NET Framework
************************
endtext
gosub .Net45
return

:.NetInit
set p=Microsoft\.NET\setup
return

REM 4.5
:.Net45
gosub .NetInit
gosub run "%p\v4.5\dotnetfx45_full_x86_x64.exe"
return

REM 4.0: targets 4.0, 3.5, 3.0, and 2.0.
:.Net40 
gosub .NetInit
gosub run "%p\v4.0\en_.net_framework_4_full_x86_x64_508940.exe"
return

REM 3.5: targets 3.5, 3.0, and 2.0.  Installs 2.0 and 3.0.  Comes with Windows 7.
:.Net35 
gosub .NetInit
gosub run "%p\v3.5\dotnetfx35.30729.01.exe"
return

REM 3.0: targets 3.0 and 2.0.  Comes with Windows Vista (6.0)
:.Net30
gosub .netInit
gosub run "%p\V3.0\dotnetfx3_%@OsArchitecture[].exe"
endiff

:.Net20
gosub .netInit
gosub run "%p\V2.0\.NET 2.0 %@OsArchitecture[].exe"
return

:.Net11
gosub .netInit
gosub run "%p\v1.1\dotnetfx.exe"
return

:.NetSdk
text
************************
* .NET Framework SDK
************************
- Uncheck Samples and Register Environment Variables
endtext

gosub .netInit
gosub run "%p\V1.0\SDK version 1.0a\setup.exe"

echo Updating icons...
call MergeDir /q "%up\Microsoft .NET Framework SDK" "%pp\Development\Other"

return

:Hearts
text
************************
* Hearts
************************
- SN: NS-100-000-554, Key: 43B7-0C21
- Install to c:\Hearts
endtext

gosub FindExe "MVP Software\Hearts Deluxe V2.3\SETUP.EXE"
if %_? != 0 return %_?

set SetupDir=c:\setup
call CopyDir "%ExeDir" "%SetupDir"
gosub RunExe "%SetupDir\Setup.exe"
call DelDir "%SetupDir"

mv c:\HEARTS "%programs32\HEARTS"

echo Updating icons...
call DelFile "%pd\Hearts.lnk"
call DelDir "%pp\MVP"
call MakeShortcut "%programs32\HEARTS\mvpheart.exe" "%pp\Games\MVP Hearts.lnk"

text
- Options, Music, Event Music Only
- Game, Change Rules
  - Uncheck Point cards allowed on first trick
  - Select Score exactly the ending score makes the score 0
  - Passing Left, right, across, none
endtext

return

REM Cleanup legacy JP software (4NT and TCI) and install Take Command
:JpClean

call install.btm TakeCommandUpgrade SrcOlder diff

REM Cleanup legacy 4NT and TCI 
call DelDir "%programs32\tci"
call registry.btm delete "HKEY_CLASSES_ROOT\Directory\shell\4NT" >& nul:
call registry.btm delete "HKEY_CLASSES_ROOT\Drive\shell\4NT" > nul:

call install.btm TakeCommand

return

:TakeCommand
:tc
REM - download ftp://jpsoft.com/, http://jpsoft.com/downloads.html
REM - changes http://jpsoft.com/forums/view/announcements.17/ and http://jpsoft.com/forums/view/support.4/
text
********************************
* Take Command
********************************
endtext

set TcVersion=13.04.64

set TcMajorVersion=%@InStr[0,2,%TcVersion]
set TcMinorVersion=%@replace[.,,%@InStr[3,2,%TcVersion]]
set TcArchitecture=%@if[ %@OsArchitecture[] == x64,x64,x86]
set TcProgramDir=%programs\JPSoft\TCMD%TcMajorVersion%%@if[ %TcArchitecture == x64,x64]
set p=JP Software\Take Command

gosub run "%p\setup\Take Command v%TcVersion %@OsArchitecture[].exe"	

set registry=setup v%TcMajorVersion %@OsArchitecture[].reg
set profile=default

call ask `Do you want to update the path?` y
iff %? == 1 then
	echo Updating path...
	echo Paste %TcProgramDir; before bin in the system path
	echo %@ClipW[%TcProgramDir;] >& nul:
	call os.btm path edit
	pause
endiff

REM Install default plugins
call ask `Do you want to install the default plugins?` y
if %? == 1 call CopyDir /fast "%install\%p\plugins\default\%TcArchitecture" "%TcProgramDir\plugins"

echo Copying files...
call CopyFile "%PublicDocuments\Icons\Command Prompt.ico" "%TcProgramDir"
call CopyFile "%install\%p\setup\other\TcStart.btm" "%TcProgramDir"

REM Set TCSTART and TCEXIT - must not be the system user, option dialog does not work properly
iff "%@option[TCStartPath]" != "%TcStartDir" .and. "%UserName" != "SYSTEM" then
	echo Updating TCSTART / TCEXIT Path...
	echo `- Startup, TCSTART / TCEXIT Path=<paste>`
	echo %@ClipW[%@BatchDir[]] >& nul:
	option
endiff

REM Common setup
call TakeCommand.btm setup

REM Registry
call ask `Do you want to restore the default registry settings?` n
if %? == 1 call registry import "%install\%p\setup\other\%registry"

REM Profile
iff "%profile" == "default" .or. IsFile %@quote[%profile] then
	call TakeCommand.btm profile restore %@quote[%profile]
endiff

REM Icons
echo Updating icons...
set dir=%pp\Operating System\Other\Take Command

set icon=Take Command%@if[ "%@OsArchitecture[]" == "x64" , x64] %TcMajorVersion.%@if[ %TcMajorVersion gt 12,0,%TcMinorVersion].lnk
call DelFile "%psm\%icon"
call DelFile "%pd\%icon"
call DelFile "%dir\%icon"

call MergeDir /q /rename "%pp\TCMD%TcMajorVersion" "%dir"
call MergeDir /q /rename "%pp\TCMD%TcMajorVersion%x64" "%dir"

call MakeShortcut /quiet "%TcProgramDir\tcc.exe" "%dir\Take Command Console.lnk"
call MakeShortcut /quiet "%TcProgramDir\tcmd.exe" "%dir\Take Command.lnk"

text
- View, uncheck Command Input, Folder and List View, and Status Bar
- Options, Theme, VS 2010
- Toolbar, Customize..., 
  - Toolbar, F(older and List Views) C(ommand Input) D(ebug) V(iew)
  - Keyboard, View, Folder and List Views, Ctrl+F
  - Options, check Show shortcut keys in ScreenTips
- Notes
  - ctrl-n/w=new/close, alt-left/right=cycle, num. 00paste+run
  - [alt] drag=[block] hilight and copy
  - middle mouse button: paste
  - (multiple monitors) tcc, Properties, Font, Size=4x6
    - Run 4nt to run Take Command with normal font size
- Option, Command Line, uncheck Complete hidden files and Complete hidden directories
endtext

return

REM Prepare a new Take Command image from the files in the current folder.
REM Requires: Take Command installation files copied to the current directory
:TakeCommandPrepareImage

iff not exist "tcmd.exe" then
  echo The current directory does not contain tcmd.exe.
  return 1
endiff

call MakeDir "other"

move /q /e batch.bcp French?.dll German?.dll Spanish?.dll license.txt readme.txt updater.* *.btm other
if exist Guide.pdf move Guide.pdf "Take Command Guide.pdf"

echo The Take Command image has been prepared.

return

:OsUpdate
REM path: c:\Windows\System32\wbem
text
************************
* OS Update
************************
endtext

iff "%data" != "c:" then

	call MakeDir "%data\Program Files"
	call MakeDir "%data\Program Files (x86)"
	
	echo Moving Windows Installer folder...
	call MakeLink merge "%data\Windows\Installer" "%WinDir\Installer"
	
	echo `- permissions for %data\Windows\Installer, %data\Program Files*: Everyone Read & execute, SYSTEM and Administrators Full control`
	pause
	
endiff

call os ServicePack

REM Install Windows updates
echo - Get updates for other Microsoft products, click Find out more
call os update
pause

REM Automatic updates
text
- Change Settings
  - Install updates automatically OR Check for updates but let me choose whether to download and install them
  - Check Include recommended updates when downloading, installing, or notifying me about updates
	- Check Use Microsoft Update
endtext

call os AutomaticUpdates
pause Press any key after all updates have been installed...

REM Cleanup
call os.btm StartMenuIcons
call CleanupFiles.btm

return

:MotherboardMonitor
REM No longer updated, latest version is 2004 and motherboard updates downloaded are dated 2004
REM Download: http://www.majorgeeks.com/download.php?det=311
REM Installs: mbmiodrvrMBMIO Driver, cansoft@livewiredev.com, c:\windows\system32\mbmiodrvr.sys	
text
************************
* Motherboard Monitor
************************
- Core: 2V, Port: 0
- Preferences, Run MBM on startup, No Splash, Log All three items, text only, Email: On alarms do
endtext

gosub run "Shareware\Motherboard Monitor\mbm5370.exe"

echo Updating icons...
call MergeDir /q "%up\MBM 5" "%pp\Operating System\Other"
call MergeDir /q "%pp\MBM 5" "%pp\Operating System\Other"

return

:WindowsAdminTools
REM Windows Server 2003 Service Pack 2 Administration Tools Pack -  http://www.microsoft.com/downloads/details.aspx?familyid=86B71A4F-4122-44AF-BE79-3F101E533D95&displaylang=en
REM Remote Server Administration Tools for Windows 7 -  http://www.microsoft.com/downloads/details.aspx?familyid=7D2F6AD7-656B-4313-A005-4E344E43997D&displaylang=en
REM Installing or Removing - http://technet.microsoft.com/en-us/library/ee449483%28WS.10%29.aspx
text
*****************************
* Windows Admin Tools
*****************************
endtext

echo Installing Remote Server Administration tools...
iff %@IsNewOs[] == 1 then
	gosub run "Microsoft\Server 2008\tools\Windows%_WinVer%-KB958830-%@OsArchitecture[]-RefreshPkg.msu"
	
	call ask `Enable Remote Server Administration features?` y
	iff %? == 1 then
	
		echo Enabling default features...
		dism /online /enable-feature /featurename:RemoteServerAdministrationTools
		dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles
		dism /online /enable-feature /featurename:RemoteServerAdministrationTools-Roles-RDS
		
		echo Enable other features...
		call os programs
		echo - Turn Windows features on or off, Remote Server Administration Tools
		echo   - (optional) Check other features
		pause
		
	endiff
	
else
	REM Will reinstall if shortcuts are moved and setup will not function if the name of the msi is changed
	gosub run "Microsoft\Server 2003\tools\WindowsServer2003-KB340178-SP2-%@OsArchitecture[]-ENU.msi"
endiff

echo Updating icons...
call MergeDir /q "%pp\Administrative Tools" "%pp\Operating System\Other\Administrative Tools" 

return

:TweakUI
text
************************
* TweakUI
************************
endtext

REM This version of TweakUI does not run under new operating systems
if defined NewOs return

gosub run "Microsoft\XP\other\Tweak UI\TweakUiPowertoySetup.exe"

call CopyFile "%pp\Powertoys for Windows XP\Tweak UI.lnk" "%pp\Administrative Tools\TweakUI.lnk"
call DelDir "%pp\Powertoys for Windows XP"
call DelDir "%up\Powertoys for Windows XP"

echo - Templates, uncheck all except Word, Excel, PowerPoint, Visio, Text Document, WinZip
gosub RunProg "%WinDir\system32\TweakUI.exe"

return

:PowerDVD
REM Player, x86 hardware based codec package (mpeg-2, H.264, DivX), nVidia PureHD hardware support, HdCodecPack is codecs only.
REM Installs
REM RichVideo - service, optionally uninstall using "%programs32\CyberLink\Shared files\richvideouninstall.exe"
text
************************
* PowerDVD
************************
endtext

gosub run "CyberLink\PowerDVD\setup\PowerDVD10_UltraUpgrade_fromUltra_1830_DVD100611-07.exe"

echo Updating registry...

REM Delete BDRegion - "C:\Program Files (x86)\Cyberlink\Shared Files\brs.exe" - remove the Blu-ray region
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\BDRegion"

REM Delete PDVD9LanguageShortcut - "C:\Program Files (x86)\CyberLink\PowerDVD9\Language\Language.exe"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\PDVD9LanguageShortcut"

REM Delete RemoteControl10 - "C:\Program Files (x86)\CyberLink\PowerDVD10\PDVD10Serv.exe"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\RemoteControl10"

echo Updating services...
call service manual RichVideo

echo Updating icons...
call MoveFile "%pd\CyberLink PowerDVD 10.lnk" "%pp\Media\PowerDVD.lnk"
call MergeDir /q /rename "%up\CyberLink PowerDVD 10" "%pp\Media\Other\PowerDVD"
call MergeDir /q /rename "%pp\CyberLink PowerDVD 10" "%pp\Media\Other\PowerDVD"

call PowerDVD start
pause

text
- To use PowerDVD H.264 decoder in DirectShow applications (WMC and WMP), run haali disable 
  and lower ffdshow Video Filter priority below Normal.
endtext

return

:HdCodecPack
REM CyberLink HD AVCHD codec pack - required to player older Hi8 video camera videos
text
************************************************
* CyberLink HD Codec Pack DirectShow Filters
************************************************
endtext

set InstallDir=%programs32\CyberLink\HD Codec Pack

iff IsDir "%InstallDir" then
	call ask `Uninstall the HD Codec Pack?` n
	set uninstall=%@if[ %? == 1 ,true]
endiff

if not defined uninstall gosub run "CyberLink\HD Codec Pack\HD Codec Pack.zip"

iff IsDir "%InstallDir" then

	echos Updating DirectShow filters...
	pushd "%InstallDir"
	for /r %file in ("*.ax") (
		regsvr32 %@if[ defined uninstall ,/u] /s %@quote[%file]
		echos .
	)
	popd
	echo done.

endiff

iff defined uninstall then 
	call DelDir ask "%InstallDir"
	echo Reboot required to remove the installation directory.
endiff

return

:Quicken
text
************************
* Quicken
************************
- Check GetUpdate
endtext

gosub run "Intuit\Quicken\Quicken_Home_Business_2013.exe"

REM Icons
call MergeDir /q /rename "%pp\Quicken 2013" "%ao\Quicken"
call MoveFile "%ao\Quicken\Quicken 2013.lnk" "%ao\Quicken\Quicken.lnk"
call DelFile "%pd\Free Credit Report and  Score.url"
call DelFile "%pd\Quicken Home ? Business 2013.lnk"

text
- Run Quicken, select I am already a Quicken user, Next, Next, Documents\Finances\Current\Finances
- Edit, Preferences
  - Quicken Preferences,  Setup\Backup, uncheck Manual Backup Reminder
  - Register\Data entry and QuickFill
    - Check Use enter key to move between fields
  - Reports and Graphs, select Customizing modifies current report or graph
- Click One Step Update, Register 
  - Check Don't show this summary again unless there is an error.
endtext

return
  
:Acrobat
text
************************
* Acrobat
************************
- V6.0 upgrade requires V5.0 installed or V4.0 CD.  

- V5.0 Setup - run if V5.0 is not already installed and you do not have the V4.0 CD
  - User Information: select A Business, John Butare, Intel, KWW500R7136748-606

- V6.0 Setup
  - If V5.0 is installed, V6.0 setup will ask if it should be uninstalled. Do this.
    After it is uninstalled, the V6.0 will run again.  
  - If V5.0 is not installed, cancel the V6.0 setup when it runs a second time.
  
  - Serial Number=1118-1236-4251-5463-2165-8673
  - Custom, Next, click Create Adobe PDF, click This feature will not be available.

- Custom, Uncheck, Create Adobe PDF and Print ME

- Custom Install
  - Acrobat Program Files, Uncheck Netscape Plug-In File
  - Check Acrobat PDF Writer Files
  - Uncheck Accessories
endtext

gosub run "Adobe\Acrobat V5.0\Setup.exe"
gosub run "Adobe\Acrobat V6.0\Setup Professional Upgrade\setup.exe"
gosub run "Adobe\Acrobat V6.0\Update to 6.0.1\Ac60PrP1.exe"
gosub run "Adobe\Acrobat V6.0\Update to 6.0.2\Acro-Reader_6.0.2_Update.exe"

echo Updating icons...

REM V5.0
call DelFile "%pp\Adobe Acrobat 5.0.lnk"
call DelFile "%pp\Acrobat Distiller 5.0.lnk"
call DelFile "%pp\Startup\Acrobat Assistant.lnk"
call DelFile "%pd\Adobe Acrobat 5.0.lnk"

call DelFile "%programs32\Microsoft Office\Office10\Startup\PDFMaker.dot"
call DelFile "%programs32\Microsoft Office\Office10\XLStart\PDFMaker.xla"

REM V6.0 Upgrade
call DelFile "%pd\Adobe Acrobat 6.0 Professional.lnk"
call DelDir "%pp\PrintMe Internet Printing"
call MoveFile "%pp\Adobe Acrobat 6.0 Professional.lnk & set dest=%pp\Applications\Acrobat.lnk"

text
- Edit, Preferences, Updates, Check for Updates=Manually
endtext

return

:Emacs
REM http://www.gnu.org/software/emacs/windows/ntemacs.html
text
************************
* Emacs
************************
endtext

set InstallDir=%programs32\emacs
gosub run "Shareware\emacs\emacs-22.1-bin-i386.zip"

return

:WinZip
text
************************
* WinZip
************************
endtext

gosub run "WinZip Computing, Inc\Winzip11.EXE"
gosub run "WinZip Computing, Inc\wzcline.exe"

echo Stopping the WinZip QuickPick application...
taskend /f wzqkpick >& nul:

echo Updating icons...
call MergeDir /q "%pp\WinZip" "%ao"
call MoveFile "%pd\WinZip.lnk" "%pp\Applications"
call DelFile "%pd\WinZip 8.0.lnk"
call DelFile "%psm\WinZip.lnk"
call DelFile "%pp\Startup\WinZip Quick Pick.lnk"

call WinZip
text
- Click View Style
endtext

return

:office
:office365
text
************************
* Office 365
************************
- How would you like your office to look=Clouds
endtext

REM Applications
gosub run "Microsoft\Office\setup\office\en_office_365_%@OsArchitecture[].exe"

REM Final setup
gosub OfficeFinal

return

:office13
text
************************
* Office 2013
************************
- Customize, Instalaltion Options, Microsoft Office, Run all from My Computer except 
  - (optional) Microsoft SkyDrive Pro
  - SharePoint Workspace (Groove)
  - Office Shared Features
    - International Support
    - Proofing Tools\French&Spanish
- User Information
endtext

REM Architecture
set architecture=x86
iff "%@OsArchitecture[]" == "x64" then
	call ask.btm `Do you want to install Office x64?`
	if %? == 1 set architecture=x64
endiff

REM Applications
set p=Microsoft\Office\setup
gosub run "%p\office\en_office_professional_plus_2013_%architecture%.iso"
gosub run "%p\visio\en_visio_professional_2013_%architecture%.exe"
gosub run "%p\project\en_project_professional_2013_%architecture%.exe"

REM Update
set p=Microsoft\Office\update
REM gosub run "%p\msores2013-kb2727009-fullfile-%architecture%-glb.exe"
REM gosub run "%p\msoloc2013-kb2737997-fullfile-%architecture%-glb.exe"
REM gosub run "%p\pj2013-kb2752101-fullfile-%architecture%-glb.exe"

REM Final setup
gosub OfficeFinal

return

:office10
text
************************
* Office 2010
************************
- Customize, Instalaltion Options, Run all from My Computer except 
  - (optional) Microsoft Office, Microsoft SharePoint Worksspace (Groove)
  - Office Shared Features
    - International Support
    - Proofing Tools\French&Spanish
- User Information
endtext

REM Architecture
set architecture=x86
iff "%@OsArchitecture[]" == "x64" then
	call ask.btm `Do you want to install Office x64?` n
	if %? == 1 set architecture=x64
endiff

REM Applications
set p=Microsoft\Office\setup
gosub run "%p\office\en_office_professional_plus_2010_%architecture%.exe"
gosub run "%p\visio\en_visio_2010_%architecture%.exe"
gosub run "%p\project\en_project_professional_2010_%architecture%.exe"
gosub run "%p\other\en_powerpivot_for_excel_2010_%architecture%_522026.msi"
gosub run "%p\sharepoint\en_sharepoint_designer_2010_%architecture%_515563.exe"

REM Updates
set u=Microsoft\Office\update
gosub run "%u\officesuite2010sp1-kb2460049-x64-fullfile-en-us.exe"

REM Fixes integration issues between Communicator R2 and Outlook x64.
iff %@IsInstalled[communicator] == 1 .and. "%architecture" == "x64" then
	call registry.btm import "%ExeDir\OCFixForOffice2010.reg"
endiff

REM Final setup
gosub OfficeFinal

return

:OfficeFinal

call office.btm init
iff %? != 0 then
	EchoErr Office is not installed
	return 1
endiff

echo Moving data folder...
call MakeLink merge "%UserData\mail" hide "%UserDocuments\Outlook Files"
call MakeLink merge "%UserData\Custom Office Templates" hide "%UserDocuments\Custom Office Templates"

echo Updating directories...
call MakeDir "%UserDocuments\data\Templates"
call MakeDir "%PublicDocuments\data\Templates"

call MakeDir "%UserDocuments\Outlook Files"
attrib /d +h "%UserDocuments\Outlook Files"

call DelFile "%UserData\templates\Welcome to Word.dotx"

REM Templates
call ask.btm `Restore normal templates?` y
iff %? == 1 then
	call word RestoreNormal
	call word close
endiff

REM Registry
call ask.btm `Update registry?` y
iff %? == 1 then

	call registry import "%SetupFiles\ShellNew.reg"

	echo Creating OneNote directories and registy keys...
	echo - Close OneNote
	call OneNote.btm start
	pause

	echo Updating registry keys...
	
	call registry.btm delete "HKCR\Directory\shell\OneNote.Open" >& nul:
	call registry.btm %OfficeBits% set "HKCU\Software\Microsoft\Office\%OfficeVersion%.0\OneNote\Options\Paths\UnfiledNotesSection" REG_SZ notes\unfiled.one
	call registry.btm %OfficeBits% set "HKCU\Software\Microsoft\Office\%OfficeVersion%.0\OneNote\Options\Save\Notebook Root" REG_SZ notes
	call registry.btm %OfficeBits% set "HKCU\Software\Microsoft\Office\%OfficeVersion%.0\Common\Security\DisableHyperlinkWarning" REG_DWORD 1

	REM Delete GrooveMonitor - "C:\Program Files\Microsoft Office\Office12\GrooveMonitor.exe"
	call registry.btm delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\GrooveMonitor"

	REM Delete BCSSync - "C:\Program Files\Microsoft Office\Office14\BCSSync.exe" /DelayServices
	call registry.btm delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\BCSSync"
	
	REM Delete OfficeSyncProcess - "C:\Program Files\Microsoft Office\Office14\MSOSYNC.EXE"
	call registry.btm delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\OfficeSyncProcess"
	
endiff

REM Directories
echo Moving OneNote directories...
iff IsDir "%UserDocuments\OneNote Notebooks" then
	iff IsDir "%UserData\OneNote" then
		call DelDir ask "%UserDocuments\OneNote Notebooks"
	else
		call MakeDir.btm "%UserData\OneNote\sample"
		call MoveEx.btm "%UserDocuments\OneNote Notebooks\*" "%UserData\OneNote\sample"
		call DelDir.btm "%UserDocuments\OneNote Notebooks"
		call MoveFile.btm "%UserData\OneNote\Unfiled Notes.one" "%UserData\OneNote\unfiles.one"
	endiff
endiff

REM Icons
call ask.btm `Update icons?` y
if %? == 1 gosub OfficeIcons

REM SharePoint Workspace
iff %@IsInstalled[SharePointWorkspace] == 1 then
	call ask.btm `Configure SharePoint Workspace?` y
	iff %? == 1 then

		echo - Restore an existing account, Documents\data\replicate\SharePoint Workspace Account.grv
		call SharePointWorkspace.btm start
		pause

		echo - (optional) Internet Explorer, Tools, Manage Add-ons, Toolbars and Extensions, Disable Groove GFS Browser Helper
		call InternetExplorer.btm 32
		pause
		
	endiff
endiff

REM Updates
iff not defined Office365 then
	call ask.btm `Update office?` y
	iff %? == 1 then
		call os.btm update 
		pause
	endiff
endiff

REM Search providers - must be done after Outlook, OneNote, and SharePoint Workspace have been run
call ask.btm `Update search provider names?` y
if %? == 1 call search.btm setup

REM Link directories
call MakeLink merge "%UserData\Visio\shapes" hide "%UserDocuments\My Shapes"
call MakeLink merge "%UserData\Workspace\archives" hide "%UserDocuments\Workspace Archives"
call MakeLink merge "%UserData\Workspace\templates" hide "%UserDocuments\Workspace Templates"

REM Options
call ask.btm `Set options?` y
iff %? == 1 then

	REM ShellRun fails with a file not found if not called from the SetupFiles folder. 
	pushd "%SetupFiles"
	ShellRun "Set Options.docm"
	pause

	ShellRun "Set Options.xls"
	pause

	popd

endiff

return

:OfficeIcons

set p=%ao\Office

call MergeDir /q /rename "%pp\Microsoft Office" "%p"
call MergeDir /q /rename "%pp\Microsoft Office 2013" "%p"
call MergeDir /q /rename "%p\Microsoft Office Tools" "%p\tools"
call MergeDir /q /rename "%p\Office 2013 Tools" "%p\tools"
call MergeDir /q /rename "%pp\Microsoft Office Live Add-in" "%p\Live Add-In"
call MergeDir /q /r "%pp\Microsoft Lync" "%ao\Office\Lync"
call MergeDir /q /r "%pp\Microsoft Office Live Meeting 2007" "%ao\Office\Live Meeting"
call MergeDir /q /rename "%p\Microsoft Office 2010 Tools" "%p\tools"
call MergeDir /q /rename "%pp\Microsoft Visual Studio 2005" "%pp\Development\.NET\Other\Visual Studio 2005"
call MergeDir /q /rename "%pp\Microsoft Office 2003 Developer Resources" "%pp\Development\Other\Office Developer Resources"

call DelFile "%pp\Startup\Microsoft Office OneNote 2003 Quick Launch.lnk"
call DelFile "%up\startup\OneNote 2010 Screen Clipper and Launcher.lnk"

call MoveFile "%pp\SharePoint\Microsoft SharePoint Workspace 2010.lnk" "%p"
call MoveFile "%pp\..\Open Microsoft Office Document.lnk" "%p\Open Office Document.lnk"
call MoveFile "%pp\..\New Microsoft Office Document.lnk" "%p\New Office Document.lnk"
call MoveFile "%up\Startup\OneNote * Screen Clipper and Launcher.lnk" "%p\OneNote Screen Clipper and Launcher.lnk"
call MoveFile "%up\Startup\Microsoft SharePoint Workspace.lnk" "%p\SharePoint Workspace.lnk"
call MoveFile "%up\Startup\Microsoft Office Groove.lnk" "%p"
call MoveFile "Microsoft SharePoint Workspace.lnk" "%p"
call MoveFile "%pp\Windows Live ID.lnk" "%pp\Applications\Accessories"

call MoveFile "%p\Lync\Microsoft Lync ????.lnk" "%p\Lync\Lync.lnk"
call MoveFile "%p\Lync\Microsoft Lync Recording Manager.lnk" "%p\Lync\Recording Manager.lnk"

REM Prevents installer from running when Lync started
call MakeDir "%pp\Microsoft Lync" 
attrib /d +h "%pp\Microsoft Lync" 

call DelDir "%pp\SharePoint"

pushd "%p"
for file in ("Microsoft Office*.lnk") call MoveFile "%file" "%@right[-17,%file]
for file in ("*2007.lnk") call MoveFile "%file" "%@left[-9,%file].lnk
for file in ("Microsoft*.lnk") call MoveFile "%file" "%@right[-10,%file]
for file in ("*2010.lnk") call MoveFile "%file" "%@left[-9,%file].lnk
for file in ("*2013.lnk") call MoveFile "%file" "%@left[-9,%file].lnk
popd

pushd "%p\tools"
for file in ("Microsoft Office 2010*.lnk") call MoveFile "%file" "%@right[-22,%file]
for file in ("Microsoft Office*.lnk") call MoveFile "%file" "%@right[-17,%file]
for file in ("Microsoft*.lnk") call MoveFile "%file" "%@right[-10,%file]
popd

return

:OfficeConnectors
text
************************
* Office Connectors
************************
endtext

call office init
if %? != 0 return %?

call ask `Install Outlook facebook connector?` y
if %? == 1 gosub run "Microsoft\Office\connectors\OSCFB-%OfficeArchitecture-en-us.exe"

call ask `Install Outlook Linked In connector?` y
if %? == 1 gosub run "Microsoft\Office\connectors\LinkedInOutlookConnector.exe"

echo Updating icons...
call DelFile "%pd\(prog).lnk"
call MoveFile "%pd\(prog).lnk" "%pp\Applications"
call MergeDir /q "%pp\(dir)" "%ao"

return

:TotalRecorder
text
************************
* TotalRecorder
************************
endtext

REM Setup
gosub run "High Criteria\Total Recorder Standard Edition V4.4\tr44se.exe"

REM Icons
call CopyFile "%pp\Total Recorder\Total Recorder.lnk" "%pp\Applications"
call DelFile "%pd\Total Recorder.lnk"
call MergeDir /q "%pp\Total Recorder" "%ao"

text
- Help, Registration 
  - Name: John Butare
  - Key: TR30.GUT8.LNB7.UAKQ.BTL9
- Options, Settings
  - System tab: Select Audio Playback and recording devices selected above
  - MP3 Encoding tab: Fraunhofer IIS MPEG Layer-3 Codec
- Options, Recording Source
  - Select Convert using paramaters supplied below
  - Change button, Format=Fraunhofer IIS MPEG Layer-3 Codec, Attributes=32kbs 24khz mono, Save button, Audio Book Quality
- View, Show Selection to enable markers
endtext

return

:WebMatrix
REM path: C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0
text
************************
* WebMatrix
************************
endtext

gosub run "Microsoft\WebMatrix\setup\webmatrix.exe"

gosub IISExpress

echo Updating icons...
call MergeDir /q /rename "%pp\Microsoft WebMatrix" "%pp\Development\other\WebMatrix"
call MergeDir /q "%pp\IIS 7.0 Extensions" "%pp\Development\other"
call MoveFile "%pp\Microsoft Web Platform Installer.lnk" "%pp\Development\.NET\Web Platform Installer.lnk"
call MoveFile "%pp\Development\other\WebMatrix\Microsoft WebMatrix.lnk" "%pp\Development\other\WebMatrix\WebMatrix.lnk"
call MoveFile "%pp\Development\other\WebMatrix\Microsoft Web Platform Installer.lnk" "%pp\Development\other\WebMatrix\Web Platform Installer.lnk"

text
- Tools, Options, Site, Default site location Documents\code\web
endtext
pause

return

:VisualStudio
:vs
:vs12
REM Path: %programs32\Microsoft Pex\bin\;%TFSPowerToolDir%;%BPADir%
REM Power Tools: http://visualstudiogallery.msdn.microsoft.com/3a96a4dc-ba9c-4589-92c5-640e07332afd
REM SQL Server Express: http://www.microsoft.com/en-us/download/details.aspx?id=29062
text
************************
* Visual Studio 2012
************************
- (optional) Uncheck Microsoft Foundation Classes for C++ (1.4 GB)
- Choose your default environment settings=Visual C# Development Settings
endtext

REM Initialize
gosub VsInit

REM Setup
gosub run "%vs\setup\vs\en_visual_studio_ultimate_2012_x86_dvd_920947.iso"
gosub run "%vs\update\VS2012.3.exe"
gosub run "%vs\setup\other\en_visual_studio_2012_sdk_x86_920808.exe"
gosub run "%vs\setup\other\SSDTSetup.exe"
gosub run "%vs\setup\other\Microsoft.TeamFoundation.Git.Provider.msi"

REM Extensions
gosub run "%vs\extension\ProPowerTools_2012.vsix"
gosub run "%vs\extension\NuGet.Tools.vsix"
gosub run "%vs\extension\WebEssentials2012.vsix"

gosub VsFinal

return

:vs10
REM Path: %programs32\Microsoft Pex\bin\;%TFSPowerToolDir%;%BPADir%
text
************************
* Visual Studio 2010
************************
- (Visual Studio, 4.7GB) Install Microsoft Visual Studio 2010, Custom
  - (optional) Uncheck Microsoft Visual Studio 2010, Visual C++ (1.4 GB)
  - Uncheck Microsoft Visual Studio 2010, Visual C++, Itanium Compilers and Tools
  - Uncheck Microsoft SQL Server 2008 Express Service Pack 1 (1.6 GB)
- (Optional, Pex) Complete
endtext

REM Initialize
gosub VsInit

REM Prerequisites
call ask.btm `Install .NET Framework v4.0?` y
if %? == 1 gosub .net40

REM Setup
gosub run "%vs\setup\vs\en_visual_studio_2010_ultimate_x86_dvd_509116.iso"
gosub run "%vs\setup\other\en_visual_studio_2010_sdk_x86_508948.exe"
gosub run "%vs\setup\other\en_visual_studio_2010_pex_0.94.51006.1_power_tools_%@OsArchitecture[]_exe_593303.exe"
gosub run "%vs\setup\other\en_visual_studio_2010_visualization_modeling_sdk_x86_511193.exe"
gosub run "%vs\setup\other\en_visual_studio_2010_visualization_modeling_feature_pack_x86_x64_535571.vsix"
gosub run "%vs\setup\other\SSDTSetup.exe"
gosub run "Microsoft\.NET\Silverlight\development\Silverlight5_Tools.exe"

REM Updates

set PostRun=c:\dev\iso1\setup.exe
gosub run "%vs\update\mu_visual_studio_2010_sp1_x86_dvd_651704.iso"

gosub run "%vs\setup\other\en_visual_studio_2010_fp2_x86_604352.msi"

REM Extensions
gosub run "%vs\extension\SolutionExplorerTools.vsix"
gosub run "%vs\extension\ProPowerTools_2010.vsix"
gosub run "%vs\extension\NuGet.Tools.vsix"

gosub VsFinal

return

:vs10clients
gosub VsInit
gosub run "%vs\setup\other\en_visual_studio_team_explorer_2010_x86_dvd_509698.iso
gosub run "%vs\setup\other\en_visual_studio_agents_2010_x86_dvd_509679.iso"
gosub run "%vs\setup\other\en_visual_studio_2010_remote_debugger_%@OsArchitecture[]_509319.exe
return

:vs08
REM Adds the following entry to the path: C:\Program Files (x86)\Microsoft Visual Studio 8\Common7\IDE\PrivateAssemblies\
text
************************
* Visual Studio 2008
************************
- (2.5GB, 15-21m) Install Visual Studio 2008, Custom
  - (optional 700MB) Language Tools, Visual C++, check only
    - Visual C++ Class & Template Libraries
    - Visual C++ Tools
    - (optional 400MB) X64 Compilers and Tools
    - Visual C++ Run-Time Libraries
  - Uncheck SQL Server 2005 Express Edition
  - Uncheck Crystal Reports Basic for Visual Studio 2008
endtext

gosub VsInit
set iso=c:\dev\iso1

REM Visual Studio - Allow other executables to be run from the ISO image
set NoCleanup=true
gosub run "%vs\setup\en_visual_studio_team_system_2008_team_suite_x86_x64wow_dvd_X14-26461.iso"

REM MSDN Setup - fails if run from c:\dev\iso1\msdn\setup\setup.exe
echo - (2.1GB, 15-18m) DVD, AutoPlay, Install Product Documentation
call os MyComputer
pause

REM Team Foundation Client setup - 10-20m
gosub run "%iso\tfc\setup.exe"

REM SQL pretty printer add-in
gosub run "Gudu Software\SQL Pretty Printer\Visual Studio Add-In v2.9.0.msi"

REM updates
gosub run "%vs\update\VS2008SP1ENUX1512962.iso"
gosub run "%vs\update\VS90SP1-KB971092-x86.exe"
gosub run "%vs\update\VS90SP1-KB973675-x86.exe"

REM Database Utilities
REM - http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&DisplayLang=en
gosub run "%vs\GDR\setup.exe"

echo Cleanup...
call iso unmount 1
del /e /q "%programs32\Microsoft Visual Studio 9.0\Microsoft Visual Studio Team System 2008 Team Suite - ENU\Logs\*.txt"

gosub VsFinal

return

:VsInit
set vs=Microsoft\Visual Studio
return

:VsFinal

gosub IISExpress

gosub VsInit

call VisualStudio init
if %? != 0 return %?

echo Creating directories...
call MakeDir "%LocalCode\test\vs%VsName%"
call MakeDir "%LocalCode\template"

REM Open VisualStudio - pick default environment and create default directories 
call ask.btm `Set default environment?` y
iff %? == 1 then
	echo - Choose your default environment settings=Visual C# Development Settings
	echo - Close Visual Studio
	call VisualStudio.btm start
	pause
endiff

echo Moving data folders...
call MakeLink merge "%VsData" hide "%UserDocuments\Visual Studio %VsName"
call MakeLink merge "%UserData\Visual Studio 2012" hide "%UserDocuments\Visual Studio 2012"
call MakeLink merge "%UserData\Visual Studio 2010" hide "%UserDocuments\Visual Studio 2010"
call MakeLink merge "%UserData\Work Item Templates" hide "%UserDocuments\Work Item Templates"
call MakeLink merge "%UserData\WCF Test Client Projects" hide "%UserDocuments\Test Client Projects"
call MakeLink merge "%UserData\Web Essentials" hide "%UserHome\Web Essentials"

REM Registry
call ask.btm `Update registry?` y
if %? == 1 gosub VsRegistry

call ask.btm `Update icons?` y
if %? == 1 gosub VsIcons

call ask.btm `Restore profile?` y
if %? == 1 call VisualStudio profile restore default

call ask.btm `Configure TFS servers?` y
if %? == 1 gosub TfsClientSetup

text
Tools, Options...
- Environment, Documents
  - check Auto-load changes, if saved
  - uncheck Check for consistent line endings on load
- Environment, Keyboard 
  - ctrl-shift-c = View.SynchronizeClassView
  - ctrl-alt-; = Project.SyncItem
- Text Editor, C#
  - General: check Line numbers
  - Tabs: Tab size=3, Indent size=3, Keep tabs
- Productivity Power Tools
  - All Extensions, enable only 
    Color Printing, Middle-click srolling, Power Commands, Quick Launch Tasks
Menu bar, Customize...
- Commands, Context menu, Editor Context Menus | Code Window, Add Command..., View.SynchronizeClassView
endtext
call VisualStudio.btm start
pause

return

:VsRegistry

call VisualStudio.btm init
if %? != 0 return %?

set r=%VsRegistryKey
set code=%LocalCode

REM  Default folders
call registry.btm 32 set "%r\DefaultBrowseComponentLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\DefaultFileOpenLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\DefaultNewProjectLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\DefaultNewProjItemLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\DefaultOpenProjectLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\DefaultOpenProjItemLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\DefaultOpenSolutionLocation" REG_EXPAND_SZ %code
call registry.btm 32 set "%r\VisualStudioProjectsLocation" REG_EXPAND_SZ %code

call registry.btm 32 set "%r\ProjectTemplates" REG_EXPAND_SZ %VsDir\Common7\IDE\ProjectTemplates
call registry.btm 32 set "%r\ItemTemplates" REG_EXPAND_SZ %VsDir\Common7\IDE\ItemTemplates

call registry.btm 32 set "%r\UserProjectTemplatesLocation" REG_EXPAND_SZ %VsData\Templates\ProjectTemplates
call registry.btm 32 set "%r\UserItemTemplatesLocation" REG_EXPAND_SZ %VsData\Templates\ItemTemplates

call registry.btm 32 set "%r\VisualStudioLocation" REG_EXPAND_SZ %VsData

return

:VsIcons

call VisualStudio.btm init
if %? != 0 return %?

set base=%pp\Development\.NET
set other=%base\Other
set vs=%other\Visual Studio %VsName
call MakeDir "%other"

REM Common
call MakeShortcut.btm "%WinDir\assembly" "%base\GAC.lnk"
call MergeDir.btm /q /rename "%pp\Microsoft Visual Studio %VsName" "%other\Visual Studio %VsName"
call MergeDir.btm /q /rename "%vs\Microsoft Windows SDK Tools" "%vs\Windows SDK Tools"
for f in ("%vs\Microsoft*.lnk") call MoveFile.btm "%f" "%@path[%f]%@right[-10,%@name[%f].lnk]"
call CopyFile.btm /quiet "%vs\Visual Studio %VsName.lnk" "%base"
call MergeDir /q /rename "%pp\Microsoft Team Foundation Server %VsName Power Tools" "%vs\Team Foundation Server Power Tools"
call MergeDir /q /rename "%pp\Microsoft Visual Studio %VsName SDK" "%vs\sdk"

REM VisualStudio 2012
call MergeDir /q "%pp\Windows Kits" "%vs"
call MoveFile "%pp\Microsoft Web Platform Installer.lnk" "%pp\Development\.NET\"
call MoveFile "%pp\SQL Server Data Tools 2012.lnk" "%base\SQL Server Data Tools.lnk"

REM VisualStudio 2010
call MergeDir /q /rename "%pp\Microsoft Sync Framework" "%vs\Sync Framework"
call MergeDir /q /rename "%pp\Microsoft Moles" "%vs\Moles"
call MergeDir /q /rename "%pp\Microsoft Pex" "%vs\Pex"
call MergeDir /q "%pp\WCF RIA Services V1.0 SP1" "%vs"
call MoveFile "%pp\Microsoft SQL Server Data Tools.lnk" "%base\SQL Server Data Tools.lnk"
call MergeDir.btm /q /rename "%pp\Microsoft Visual Studio 2010" "%other\Visual Studio 2010"

REM VisualStudio 2008
call MergeDir.btm /q /rename "%pp\Microsoft Windows SDK v6.0A\Tools" "%vs\Windows SDK Tools"
call DelDir "%pp\Microsoft Windows SDK v6.0A"	
call MoveFile "%pp\Microsoft Developer Network\MSDN Library for Visual Studio 2008 - ENU.lnk" "%vs\MSDN Library for Visual Studio 2008.lnk"
call DelDir "%pp\Microsoft Developer Network"

REM VisualStudio 2005
call MergeDir /q /rename "%pp\Microsoft .NET Framework SDK v2.0" "%vs\Framework SDK v2.0"
call MergeDir /q /rename "%pp\Innovasys HelpStudio Lite" "%vs\HelpStudio"

gosub SilverlightIcons
gosub ExpressionIcons

return

:SharePoint
text
************************
* SharePoint
************************
endtext

gosub run "Microsoft\SharePoint\setup\en_sharepoint_server_2010_with_service_pack_1_x64_759775.exe"

echo Updating icons...
call MergeDir /q /rename "%pp\Microsoft SharePoint 2010 Products" "%pp\Server\other\SharePoint"

return

:TeamFoundationServer
:tfs
:tfs10
text
************************
* Team Foundation Server
************************
- Configure
  - Configure Team Foundation Application Server, Standard Single Server, Start Wizard
    - Service Account, Readiness Checks
  - Configure Team FOundation Build Service, Start Wizard
- Download
  - Visual WIP (Kanban board) - http://visualwip.codeplex.com/releases/view/73605
endtext
set c=%ComputerName
echo - URLs: http://%c:8080/tfs http://%c:8080/tfs/web
echo    http://%c/ReportServer http://%c/Reports 
echo    http://%c/sites http://%c:17012 

REM Prerequisites
call ask.btm `Install prerequisites (IIS, SS08, .net40)?` y
if %? == 1 gosub iis ss08 .net40

REM Services
for service in (MsSqlServer ReportServer MsSqlServerOlapService) (
	call service auto %service
	call service start %service
)

REM Initialization
set tfs=Microsoft\Visual Studio\Team Foundation Server

REM Setup
set PostRun=c:\dev\iso1\TFS-%@OsArchitecture[]\setup.exe
gosub run "%tfs\setup\en_visual_studio_team_foundation_server_2010_x86_x64_dvd_509406.iso"

REM Other
gosub run "%tfs\other\Team Foundation Server Build Extensions 2010.msi"

REM Update
gosub run "%tfs\update\mu_team_foundation_server_2010_sp1_x86_x64_651711.exe"

echo Updating icons...
call MergeDir /q "%pp\Microsoft Team Foundation Server 2010" "%ServerPrograms\Other"

echo Configuring Kanban...
text
-Goals, Story Queue, UAT Review In Dev, In Test, Accepted
endtext
pause

return

:tfs08
REM Microsoft installation guide: http://go.microsoft.com/fwlink/?LinkId=52502
REM Intel installation guide: Microsoft\Visual Studio.NET V2005\doc\System Configuration Guide TFS Omnidroid 1 4.doc
text
************************
* Team Foundation Server
************************
- Uninstall or disable virus scanning software (or Sharepoint site extension fails)
- Test page (use from local machine to invoke): http://<server>:8080/services/v1.0/serverstatus.asmx
endtext

set tfs=Microsoft\Visual Studio\Team Foundation Server\2008\setup

call ask `Do you want to configure SQL server?` y
iff %? == 1 then
  set services=MsSqlServer SqlServerAgent ReportServer MsSqlServerOlapService SqlBrowser ReportServer MsFteSql MsDtsServer  
  
  for service in (%services) (
    call service auto wait %service
    call service start wait %service
  )
	
	text
	- Report Server Virtual Directory, Uncheck Require Secure Socket Layer (SSL) connections 
		(otherwise creation of TFS report server datasource fails)
	endtext
	call SqlServer RsConfig
	pause
    
endiff

REM FrontPage 2002 Uninstall
call ask `Do you want to uninstall FrontPage2002?` y
iff %? == 1 then

  echo - Application Server, Details, Internet Information Services (IIS), Detail, uncheck FrontPage2002 Server Extensions
  call os WindowsComponents
  pause
  
endiff

REM Accounts
call ask `Do you want to create prerequisite user accounts?` y
iff %? == 1 then

  REM Accounts must be in the local administrator group or Sharepoint site extension fails
  call user.btm create "TfsService-Team Foundation System service user-system"
  call user.btm create "TfsReports-Team Foundation System reports user-system"

	echo - TfsService/TfsReports, check Password next expires 
	call os ComputerManagement
	pause
	
endiff

REM SharePoint Services 2.0 with SP2
set RunOptions=/C:"setupsts.exe /remoteSql=yes /provision=no /qn+"
gosub run "Microsoft\Sharepoint\stsv2.exe"

REM Mount the ISO image.  So that we can run additional installations on the image, do not unmount it
set NoCleanup=true
gosub run "%tfs\Team Foundation Server.iso"

set prefix=c:\dev\iso1

call ask `Do you want to install Team Foundation Server?` y
iff %? == 1 then

  text
- Single-Server Installation
- Service Account, Account name=<paste, TfsService>
- Report Data Source Account, Account name=TfsReports
- Team Foundation Alerts
  - Check Enable Team Foundation Alerts
  - SMTP server=<smtp address, i.e. smtp.comcast.net, smtp.intel.com>
  - From e-mail address=<tfs@domain.com>
  endtext
	echo %@ClipW[TfsService] >& nul:

  REM Setup fails if not run from the current directory
  pushd %prefix
  gosub RunProg autorun.exe
	pause
  popd
  
endiff

echo Validate SharePoint...
echo - Validate SharePoint Central, Browse, Create a top-level Web site, Version for Default Web Site is 6.0.2.6568.  
call iis manager
pause 

echo - Value default SharePoint site
call http://%ComputerName/default.aspx
pause

call ask `Do you want to install TFS build?` y
iff %? == 1 then
	echo %@ClipW[TfsService] >& nul:
	echo `- Service Account, Account name=<paste, TfsService>`
	gosub RunProg "%prefix\build\setup.exe"
	pause
endiff

call ask `Do you want to install eScrum (TFS project management)?` y
iff %? == 1 then
	gosub run "%tfs\en_eScrum_1.0.msi"
endiff

echo Cleanup...
call iso unmount 1

echo Updates...
gosub run "%tfs\VS80-KB919156-X86.exe"
gosub run "%tfs\VS80sp1-KB926738-X86-ENU.exe"
gosub run "%tfs\MSF for Agile Software Development TFS Update.EXE"

set TfsUrl=
gosub TfsRemoteAccess
gosub TfsRename
gosub TfsTest

REM Custom SQL
echo - Execute TFS custom SQL scripts
call SqlServer ExecuteSql "%ExeDir\tfs.sql"

REM Web Access
gosub run "%tfs\Team System Web Access V1.0.msi"

echo Updating icons...
call MakeDir "%pp\Development\Other\Visual Studio 2005"
call MergeDir /q /rename "%pp\Microsoft .NET Framework SDK v2.0" "%pp\Development\Other\Visual Studio 2005\Framework SDK v2.0"

return

:TfsGetUrl

if defined TfsUrl return

set TfsUrl=http://%ComputerName
input /c Default Web Site URL? (%TfsUrl)?` ` %%TfsUrl
set TfsDomain=%@word["/",1,%TfsUrl]

echo Validate %TfsDomain...
ShellRun %TfsUrl

call ask `Is %TfsUrl correct? `
if %? == 0 goto TfsGetUrl

set TfsHttpPort=8080
input /c TFS Team Foundation Server HTTP port? (%TfsHttpPort)?` ` %%TfsHttpPort

set TfsHttpsPort=7070
input /c TFS Team Foundation Server HTTPS port? (%TfsHttpsPort)?` ` %%TfsHttpsPort

return

:TfsRename

gosub TfsGetUrl

echo Update internal references to %TfsDomain...
"%programs32\Microsoft Visual Studio 2005 Team Foundation Server\Tools\TfsAdminUtil.exe" ActivateAt %TfsDomain

echo Update reporting services web parts to the public URL if the Default Web Site...
call registry.btm 32 set "HKLM\Software\Microsoft\VisualStudio\8.0\TeamFoundation\ReportServer\key" REG_SZ %TfsUrl

echo Update web.config...
call XmlEdit Web.Config "/configuration/appSettings/add[@key='TFSNameUrl']/@value" http://%TfsDomain:%TfsHttpPort
call XmlEdit Web.Config "/configuration/appSettings/add[@key='TFS Name']/@value" %TfsDomain

echo - Uncomment TFSUrlPublic and change it to the friendly name for project alert WI links, update the protocol and port
echo `<ADD value="`%TfsUrl:%TfsHttpsPort`" key="TFSUrlPublic" /`>`
call TextEdit "%programs32\Microsoft Visual Studio 2005 Team Foundation Server\Web Services\web.config"
pause

echo Update scheduler URL to start the adapters...
call service stop TFSServerScheduler
call XmlEdit TFSServerScheduler.exe.config "/configuration/appSettings/add[@key='BisDomainUrl']/@key" TFSNameUrl
call XmlEdit TFSServerScheduler.exe.config "/configuration/appSettings/add[@key='TFSNameUrl']/@value" http://%TfsDomain:%TfsHttpPort
call service start TFSServerScheduler

call iis service reset

return

:TfsTest

gosub TfsGetUrl

echo Test installation...
text
-	Create a new TFS site named sandbox, click Project Velocity, verify site report URL is correct
- Registration Status, GetRegistrationEntries, Invoke, verify <Type>vstfs</Type> 
endtext
ShellRun "https://%TfsDomain/sites/sandbox"
ShellRun "https://%TfsDomain:%TfsHttpsPort/services/v1.0/ServerStatus.asmx"
ShellRun "https://%TfsDomain:%TfsHttpsPort/services/v1.0/Registration.asmx"

return

:TfsRemoteAccess

echo Remote access configuration...
text
- Web Sites, Directory Security, IP address and domain name restrictions, Edit, By default, 
  all computers will be Granted access
- Install an SSL certificate, enable an SSL port, and enable Basic Authentication on the 
  Default Web Site and Team Foundation Server web sites.  
endtext
call iis manager
pause

call ask `Do you want to create the IIS authetnication filter?` y
iff %? == 1 then
  set file=%programs32\Microsoft Visual Studio 2005 Team Foundation Server\TF Setup\ AuthenticationFilter.ini
  echo [config] > "%file"
  echo RequireSecurePort=true >> "%file"
  echo SubnetList=192.168.1.0/255.255.255.0 >> "%file"
  echo - Update the SubnetList to identify local addresses that can use Windows Integrated authentication
  call TextEdit "%file"
  pause
endiff

echo Updating event viewer configuration...
reg.exe add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\TFS ISAPI Filter" /v EventMessageFile /t REG_SZ /d %windir%\Microsoft.NET\Framework\v2.0.50727\EventLogMessages.dll /f 
reg.exe add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\TFS ISAPI Filter" /v TypesSupported /t REG_DWORD /d 7 /f 

echo Configure the authentication ISAPI filter...
text 
- Team Foundation Server, Properties, ISAPI Filters, Add
  - Filter name= TFAuthenticationFilter
  - Executable=c:\Program Files\Microsoft Visual Studio 2005 Team Foundation Server\TF Setup\AuthenticationFilter.dll
endtext
call iis manager
pause

return

:TfsClientSetup

REM Set visual studio variables
call VisualStudio.btm init
if %? != 0 return %?

REM Team Foundation Server Power Tools - http://msdn.microsoft.com/en-us/vstudio/bb980963.aspx
echo - (optional) Custom, check Windows Shell Extension and PowerShell Cmdlets
gosub run "%vs\setup\TFS\Team Foundation Server Power Tools %VsName.msi"

REM Team Foundation Server Source Control integration for other products (such as SQL Server Management Studio) - http://msdn.microsoft.com/en-us/vstudio/bb980963.aspx
gosub run "%vs\setup\TFS\Team Foundation Server MSSCCI Provider %VsName.msi"

echo Addings default TFS servers...
REM call TeamFoundationServer.btm server add Intel http://source.intel.com:8080
call TeamFoundationServer.btm server add Intel http://source2010.intel.com:8090
iff %@OnNetwork[Wiggin] == 1 then
	call TeamFoundationServer server add test http://ws08:8080/tfs
endiff
call VisualStudio start
pause

text
- (Team Foundation Server, for Wiggin requires podzone installed in root certificate store) 
  - Tools, Connect to Team Foundation Server..., 
    - Connect to a Team Foundation Server=<TFS Server>
    - Team projects=<select projects>
  - File, Source Control, Workspaces..., Select computer, Edit..., Working folders
    - Status=Active
    - Source Control Folder=<$/ or sub-folder>
    - Local Folder=<c:\code or sub-directory>
    - Examples $/HCMS/MyLearning=C:\code\MyLearning
- Tools, Add-in Manager, SqlParser, uncheck startup (startup as needed due to toolbar placement issues)
- Notes
  - When added projects to source control, delete the name=<sol>.root 
  - Close Team Explorer if not always connected to the TFS server (prevent VS slow start)
endtext
call VisualStudio.btm start
pause

return

:ss12
:ss
REM Updates: http://support.microsoft.com/kb/2755533
REM Installs:
REM - Path:
REM   c:\Program Files (x86)\Microsoft SQL Server\110\Tools\Binn\
REM   c:\Program Files\Microsoft SQL Server\110\Tools\Binn
REM   c:\Program Files\Microsoft SQL Server\110\DTS\Binn
REM   c:\Program Files (x86)\Microsoft SQL Server\110\Tools\Binn\VSShell\Common7\IDE
REM   c:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies
REM   c:\Program Files (x86)\Microsoft SQL Server\110\DTS\Binn\
text
****************************
* SQL Server 2012
****************************
endtext

set base=Microsoft\SQL Server

echo.
echo Checking for IIS (required for reporting services)...
gosub IisCheck

text

Note: Logs are in "%programs\Microsoft SQL Server\110\Setup Bootstrap\Log"
- Installation, New SQL installation or add features to an existing installation
- Setup Roles, All Features with Defaults
- Feature Selection
  - (full development, 8gb) No changes
  - (light development+SQL Server Express, 6gb) Uncheck all Instance Features
  - (server, 2gb) Uncheck all Shared Features
 - Instance Configuration
  - (optional) Named instance=MSSQLSERVER<version>
	- (optional) Instance root directory=d:\Program Files\Microsoft SQL Server\
- Database Engine Configuration
  - Authentication Mode=Mixed Mode, Enter password=XXX, Confirm password=XXX
  - Add..., Add Current User, (optional) Add..., Administrators
- Analysis Services Configuration
  - Add..., Add Current User, (optional) Add..., Administrators
- Distributed Replay Controller
  - Add..., Add Current User
endtext

REM Install
iff %@IsWindowsClient[] == 1 then
  gosub run "%base\setup\en_sql_server_2012_developer_edition_x86_x64_dvd_813280.iso"
	gosub run "%base\express\SQLEXPR_x64_ENU.exe"
else
	gosub run "%base\setup\en_sql_server_2012_enterprise_edition_x86_x64_dvd_813294.iso"
endiff

REM Updates
gosub run "%base\update\SQLServer2012SP1-KB2674319-%@OsArchitecture[]-ENU.exe"

REM Determine which components were installed

set ClientTools=%@if[exist "%programs32\Microsoft SQL Server\110\Tools\Binn\ManagementStudio\Ssms.exe" ,true]


set server=%@if[exist "%programs\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Binn\sqlservr.exe" .or. exist "d:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Binn\sqlservr.exe" ,true]

iff defined ClientTools then
	REM http://www.ssmsboost.com/
	gosub run "%base\plugins\SSMSBoostInstaller2012_2.10.4957.30631.msi"
endiff

gosub SsLogCleanup
gosub SsUpdateServices

iff defined server then 
	call SqlServer service start
	gosub SsFirewall
	gosub SsServerConfig
	gosub SsMailConfig
	gosub SsReportServerConfig
endiff

iff defined ClientTools then
	gosub SsManagementStudioConfig
endiff

gosub SsFinal

return

:ss08r2
REM Installs:
REM - Path:
REM   c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\
REM   c:\Program Files\Microsoft SQL Server\100\Tools\Binn
REM   c:\Program Files\Microsoft SQL Server\100\DTS\Binn
REM   c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE
REM   c:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies
REM   c:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\
text
****************************
* SQL Server 2008 Release 2
****************************
endtext

set base=Microsoft\SQL Server

echo.
echo Checking for IIS (required for reporting services)...
gosub IisCheck

text

Note: Logs are in "%programs\Microsoft SQL Server\100\Setup Bootstrap\Log"
- Installation, New SQL installation or add features to an existing installation
- Setup Roles, All Features with Defaults
- Feature Selection
  - (development, 6gb) No changes
  - (server, 2gb) Uncheck all Shared Features
  - (client tools only, 4gb) Uncheck all Instance Features
- Server Configuration
  - Use the same account for all SQL Server instances, Account Name=wsystem, Password=XXX
    - Note: To execute maintenance plans using a domain account, SQL Server Agent service account must have access to the AD
- Database Engine Configuration
  - Authentication Mode=Mixed Mode, Enter password=XXX, Confirm password=XXX
  - Add..., Add Current User and (optional) Add..., Administrators
- Analysis Services Configuration
	- Add..., Add Current User and (optional) Add..., Administrators
endtext

REM Install
iff %@IsWindowsClient[] == 1 then
  gosub run "%base\setup\en_sql_server_2008_r2_developer_x86_x64_ia64_dvd_522665.iso"	 
else
	gosub run "%base\setup\en_sql_server_2008_r2_enterprise_x86_x64_ia64_dvd_520517.iso"
endiff
gosub run "Microsoft\SQL Server\update\SQLServer2008R2SP1-KB2528583-%@OsArchitecture[]-ENU.exe"

REM Determine which components were installed

set ClientTools=
iff exist "%programs32\Common Files\Microsoft Shared\Help 9\dexplore.exe" then
	set ClientTools=true
endiff

set server=
iff exist "%programs\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\Binn\sqlservr.exe" then
	set server=true
endiff

gosub SsLogCleanup
gosub SsUpdateServices

iff defined server then 
	call SqlServer service start
	gosub SsFirewall
	gosub SsServerConfig
	gosub SsMailConfig
	gosub SsReportServerConfig
endiff

iff defined ClientTools then

  REM http://www.tsqltidy.com/tsqltidySSMSAddin.aspx
	gosub run "%base\plugins\T-SQL Tidy for SQL Server 2008 R2 Setup.msi"
	
	REM http://www.ssmstoolspack.com/
	gosub run "%base\plugins\SSMSToolsPack.msi"

  echo Initializing help...
  start /wait /pgm "%programs32\Common Files\Microsoft Shared\Help 8\dexplore.exe" /helpcol ms-help://MS.SQLCC.v10 /usehelpsettings SQLServerBooksOnline.10.0 /LaunchNamedUrlTopic SQLServerBooksOnline

	gosub SsManagementStudioConfig
endiff

gosub SsFinal

return

:ss08
REM Notes
REM - Adds the following entries to the path:
REM   c:\Program Files\Microsoft SQL Server\100: Tools\Binn,DTS\Binn, Tools\Binn\VSShell\Common7\IDE
REM   c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies
REM   c:\WINDOWS\system32\WindowsPowerShell\v1.0
text
************************
* SQL Server 2008
************************
endtext

echo.
echo - Check IIS (required for reporting services)
gosub IisCheck

echo - If present, remove pending file operations from PendingFileRenameOperations and reboot
set key=HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations
call registry.btm 64 %key
pause

text
- Note: Logs in %programs\Microsoft SQL Server\100\Setup Bootstrap\Log
- Installation, New SQL Server stand-alone installation or add features to an existing installation
- Feature Selection, Select All
  - (development, 2.7gb) 
  - (server, 900mb) Uncheck Shared Features
  - (client tools only, 1.8gb) Uncheck Instance Features
- Server Configuration
  - Use the same account for all SQL Server instances, Account Name=wsystem, Password=XXX
    - To execute maintenance plans using a domain account, SQL Server Agent service account must have access to the AD
  - SQL Full-text Filter Daemon Launcher, Account Name=wsystem, Password=XXX
- Database Engine Configuration
  - Authentication Mode=Mixed Mode, Enter password=XXX, Confirm password=XXX
  - Add..., Add Current User
- Analysis Services Configuration
  - Add..., Add..., Administrators
endtext

REM Install
iff %@IsWindowsClient[] == 1 then
  gosub run "Microsoft\SQL Server\setup\en_sql_server_2008_developer_x86_x64_ia64_dvd_x14-88839.iso"
else
	gosub run "Microsoft\SQL Server\setup\en_sql_server_2008_enterprise_x86_x64_ia64_dvd_x14-89207.iso"
endiff
gosub run "Microsoft\SQL Server\update\SQLServer2008SP2-KB2285068-%@OsArchitecture[]-ENU.exe"

REM Determine which components were installed

set ClientTools=
iff exist "%programs32\Common Files\Microsoft Shared\Help 9\dexplore.exe" then
	set ClientTools=true
endiff

set server=
iff exist "%programs\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Binn\sqlservr.exe" then
	set server=true
endiff

gosub SsLogCleanup
gosub SsUpdateServices

iff defined server then 
	call SqlServer service start
	gosub SsFirewall
	gosub SsServerConfig
	gosub SsMailConfig
	gosub SsReportServerConfig
endiff

iff defined ClientTools then

	echo Updating help...
	gosub run "Microsoft\SQL Server\update\SQLServer2008_BOL_August2008_ENU.msi"

  echo Initializing help...
  start /wait /pgm "%programs32\Common Files\Microsoft Shared\Help 8\dexplore.exe" /helpcol ms-help://MS.SQLCC.v10 /usehelpsettings SQLServerBooksOnline.10.0 /LaunchNamedUrlTopic SQLServerBooksOnline

	gosub SsManagementStudioConfig
endiff

gosub SsFinal

return

:ss05
REM Notes
REM - Setup logs: C:\Program Files\Microsoft SQL Server\90\Setup Bootstrap\LOG\Files\
REM - WMI configuration error: rebuild WMI catalog by running FixWmi (http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=193534&SiteID=1)
REM - COM+ System Configuration Check Failure in SQL Server Setup: reinstall COM+ (http://msdn2.microsoft.com/en-us/library/ms143690.aspx)
REM - Installing on x64: http://technet.microsoft.com/en-us/library/ms143293.aspx
REM - Adds the following entries to the path:
REM   - C:\Program Files (x86)\Microsoft SQL Server\80\Tools\Binn\
REM   - C:\Program Files\Microsoft SQL Server\90\DTS\Binn\
REM   - C:\Program Files\Microsoft SQL Server\90\Tools\binn\
REM   - C:\Program Files (x86)\Microsoft SQL Server\90\Tools\binn\
REM   - C:\Program Files (x86)\Microsoft SQL Server\90\DTS\Binn\
REM   - C:\Program Files (x86)\Microsoft SQL Server\90\Tools\Binn\VSShell\Common7\IDE\
text
************************
* SQL Server 2005
************************
endtext

echo.
echo - IIS is required for reporting services
gosub IisCheck

text
- Notes
  - Install logs to %programs\Microsoft SQL Server\90\Setup Bootstrap\LOG\Files
  - If any components fail, reboot and re-run.
  - (xp) Uninstall Microsoft Office Web Components
  - (xp) Remove IIS certificates from the Default Web Site
- Install Server components, tools, Books Online, and samples
- Components to Install, check all, Advanced 
  - (development, 2.1gb) (optional, 400mb) uncheck Documentation\Sample Databases
  - (server, max 700mb) Uncheck Client Components, Documentation, and server components not required.
  - (client tools only, 2.2gb) Select only
    - Client Components (1.3GB)
    - (optional) Sample Code and Applications (237MB)
- Use a domain user account=wsystem, Password=XXX, Domain=(blank)
  - To execute maintenance plans using a domain account, SQL Server Agent service account must have access to the AD
- Authentication Mode=Mixed Mode
- SQL collations, Dictionary order, case-insensitive, for use with the 1252 Character Set.
- (optional) Report Server Installation Options, check Install the default configuration
endtext

REM Install - dev setup fails unless both discs combined together
iff %@IsWindowsClient[] == 1 then
  gosub run "Microsoft\SQL Server\setup\en_sql_2005_dev_%@OsArchitecture[].iso"
else
  gosub run "Microsoft\SQL Server\setup\en_sql_2005_ent_%@OsArchitecture[]_dvd.iso"
endiff

REM Determine which components were installed

set ClientTools=
iff exist "%programs32\Common Files\Microsoft Shared\Help 8\dexplore.exe" then
	set ClientTools=true
endiff

set server=
iff exist "%programs\Microsoft SQL Server\mssql.1\mssql\binn\sqlservr.exe" then
	set server=true
endiff

REM Install updates

text

Install service Pack...
- Wait until the .NET optimization process (mscorsvw.exe) is finished before running service pack
- Note: Log files in %WinDir\Hotfix
endtext

REM Stop services so files are not open for update
call SqlServer service stop all

gosub run "Microsoft\SQL Server\update\SQLServer2005SP2-KB921896-%@OsArchitecture[]-ENU.exe"
gosub run "Microsoft\SQL Server\update\SQLServer2005-KB934458-%@OsArchitecture[]-ENU.exe"

REM Update SQL books online
iff defined ClientTools then
	gosub run "Microsoft\SQL Server\update\SqlServer2K5_BOL_Sep2007.msi"
endiff

REM Cleanup
echos Removing log files...
call DelFile "%programs\Microsoft SQL Server\90\Setup Bootstrap\LOG\Files\*.log"
echo done.

REM %WinDir\hotfix contains log files for SQL Server 2005 SP1 hotfix, ~70mb
call DelDir "%WinDir\hotfix"

echo Updating icons...
call MergeDir /q /rename "%pp\Microsoft SQL Server 2005" "%pp\Development\Other\SQL Server 2005"
call MergeDir /q /rename "%pp\Microsoft Visual Studio 2005" "%pp\Development\Other\Visual Studio 2005"
set link=%pp\Development\Other\SQL Server 2005\SQL Server Management Studio.lnk
call CopyFile "%link" "%pp\Development"

REM Client Tools
iff defined ClientTools then

  REM SQL Pretty Printer add-in 
	gosub run "Gudu Software\SQL Pretty Printer\SQL Server Management Studio Add-In V2.9.0.msi"

  echo Initializing help...
  start /wait /pgm "%programs32\Common Files\Microsoft Shared\Help 8\dexplore.exe" /helpcol ms-help://MS.SQLCC.v9 /usehelpsettings SQLServerBooksOnline.9.0 /LaunchFKeywordTopic sql9.portal.f1
endiff

REM Compress service pack files
set BackupDir=%programs\Microsoft SQL Server\MSSQL.1\MSSQL\Backup
iff exist "%BackupDir" then
	iff %@DirSize["%BackupDir"] gt 0 then
		call ask `Compress backup files?` n 5
		iff %? == 1 then
			call CompactDir "%programs\Microsoft SQL Server\MSSQL.1\MSSQL\Backup"
		endiff
 endiff
endiff

REM Surface area configuration
iff defined server then

  echo Updating firewall...
	call firewall rule add "SQL Server" `dir=in action=allow protocol=TCP localport=1433 profile=private program="%programs\Microsoft SQL Server\MSSQL.1\MSSQL\Binn\sqlservr.exe"`

	REM Start SQL Server for access by surface area configuration and client tools
	call SqlServer service start

	text
Surface area configuration...
- Surface Area Configuration for Services and Connections
  - MSSQLSERVER, Database Engine, Remote Connections, select Local and remote connectios 
    using TCP/IP only (or Using both TCP/IP and named pipes)
	endtext
	call SqlServer SurfaceArea
	pause
	
endiff

REM Configure mail
iff defined server then

  call ask `Do you want to configure SQL mail?` n
  iff %? == 1 then

    echo - Surface Area Configuration for Features
    echo   - MSSQLSERVER, Database Engine, Database Mail, check Enable Database Mail stored procedures
	  call SqlServer studio
		pause
		
		call SqlServer ExecuteSql "%ExeDir\....\other\Database Mail Setup.sql"
		
		echo Execute the mail setup script ...
		echo %@ClipW[%MailSetupScript] >& nul:
	  call TextEdit "%MailSetupScript"

		text
- Object Explorer, Server, SQL Server Agent (SQL Server Agent service must be running), 
  - Properties
    - Advanced, check Define idle CPU condition
    - Alert System
      - Check Enable mail profile
      - Mail system=Database mail
      - Mail profile=Public Mail Profile
  - New, Operator..., New Operator..., Name=NNN, E-mail name=NNN
		endtext
		
		call SqlServer studio
		pause
		
	endiff
endiff

REM Configure server
iff defined server then
	text
- Object Explorer, Server, Properties, Memory, Maximum server memory=256
	endtext
	call SqlServer studio
	pause
endiff

REM Configure client tools
iff defined ClientTools then
	echo %@ClipW[%UserDocuments\data\replicate\databases.regsrvr] >& nul:
	call SqlServer studio
	pause
	
endiff

REM Configure reporting services
iff IsFile "%programs\Microsoft SQL Server\90\Tools\Binn\RSConfigTool.exe" then
	text

SQL server reporting services configuration...
- Report Server Virtual Directory, Uncheck Require Secure Socket Layer (SSL) connections 
- (if default report server configuration was not selected) Reporting Services Configuration 
  - Server Status, Start
  - Report Server Virtual Directory, New, Ok
  - Report Manager Virtual Directory, New, Ok
  - Windows Service Identity, Apply
  - Web Service Identity, Apply
  - Database Setup
    - Server Name=<hostname>, Connect
    - Database Name, New, Ok
    - Apply, Ok
	endtext
	call SqlServer RsConfig
	pause
endiff

REM Set services to manual - services must be started for service pack installation
REM MSSQLServerADHelper and SQLBrowser services are disabled by defaults
iff %@IsWindowsClient[] == 1 then

  echo Updating services...
  call service manual MsDtsServer 
  call service manual MsFteSql
  call service manual MsSqlServerOlapService
  call service manual ReportServer
  call service manual SqlServerAgent
  call service manual SQLWriter 
  call service manual MsSqlServer 
endiff

text
- (xp) Add back IIS certificates
- (optional, 350MB from SP2) Cleanup %WinDir\Installer
- (option) Remove the SQL entries from the system path
endtext

return

:SsLogCleanup
echos Removing log files...
call DelDir ask quiet "%programs\Microsoft SQL Server\110\Setup Bootstrap\Log"
echo done.
return

:SsUpdateServices

REM Set services to manual - services must be started for service pack installation
iff %@IsWindowsClient[] == 1 then
 	echo Updating services...
	call SqlServer service demand all instance default
	call SqlServer service demand all instance express
endiff

return

:SsManagementStudioConfig

call ask 'Restore profile?' y
if %? == 1 call SqlServer profile restore default

text
- View: Registered Servers at top left, Solution Explorer at bottom right
- Tools, Options
  - Environment
    - 20 items shown
    - Startup, At startup Open empty environment
  - Text Editor
    - All Languages, check Line numbers
    - (if using SQL Prompt) Transact-SQL, uncheck Auto list members
    - Editor Tab and Status Bar, Tab Text, all but Include File Name to False
  - (optional) Source Control, Current source control plug-in=Team Foundation Server MSCCI Provider
- Help, Yes	
endtext
call SqlServer studio
pause

return

:SsFirewall

echo Updating firewall...
call firewall rule add "SQL Server" ^
	`dir=in action=allow protocol=TCP localport=1433 profile=private program="%programs\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Binn\sqlservr.exe"`

echo - SQL Server Network Configuration, Protocols for MSSQLSERVER
echo  - Named Pipes and TCP/IP=Enabled
echo  - TCP/IP, IP Addresses, (IP for primary NIC) IPn, Enabled=Yes
call SqlServer config
pause

return

:SsServerConfig
echo - Object Explorer, Server, Properties, Memory, Maximum server memory=128 or 256
call SqlServer studio
pause
return

:SsReportServerConfig

if %@ServiceExist[ReportServer] == 0 return

call ask `Do you want to configure SQL Server Reporting Services?` n
if %? == 0 return
	
text

SQL Server Reporting Services configuration...
- Report Server Virtual Directory, Uncheck Require Secure Socket Layer (SSL) connections 
- (if default report server configuration was not selected) Reporting Services Configuration 
  - Server Status, Start
  - Report Server Virtual Directory, New, Ok
  - Report Manager Virtual Directory, New, Ok
  - Windows Service Identity, Apply
  - Web Service Identity, Apply
  - Database Setup
    - Server Name=<hostname>, Connect
    - Database Name, New, Ok
    - Apply, Ok
endtext
	
call SqlServer RsConfig
pause

return

:SsMailConfig

call ask `Do you want to configure SQL mail?` n
if %? == 0 return
		
echo - Object Explorer, Server, Facets, Facet=Surface Area Configuration, DatabaseMailEnabled=True
call SqlServer studio
pause

call SqlServer ExecuteSql "%ExeDir\....\other\Database Mail Setup.sql"

echo Execute the mail setup script ...
echo %@ClipW[%MailSetupScript] >& nul:
call TextEdit "%MailSetupScript"

text
- Object Explorer, Server, SQL Server Agent (SQL Server Agent service must be running), 
- Properties
	- Advanced, check Define idle CPU condition
	- Alert System
		- Check Enable mail profile
		- Mail system=Database mail
		- Mail profile=Public Mail Profile
- New, Operator..., New Operator..., Name=NNN, E-mail name=NNN
endtext
	
call SqlServer studio
pause

return
	
:SsFinal

echo Creating sql directory...
set SqlDir=%UserData\sql
call MakeDir "%SqlDir"
call MakeShortcut.btm "%CloudData\sql" "%SqlDir\cloud.lnk"

echo Moving data folders...

set dest=%UserData\SQL Server
call MakeDir "%dest"
call MergeDir /q "%UserDocuments\Integration Services Script Component" "%dest"
call MergeDir /q "%UserDocuments\Integration Services Script Task" "%dest"

set dir=%UserData\SQL Server Management Studio
call MakeLink merge "%UserData\SQL Server Management Studio" hide "%UserDocuments\SQL Server Management Studio"
call MakeShortcut.btm "%UserData\sql" "%dir\Projects\sql.lnk"

gosub SsRegistry
gosub SsIcons

iff %@index[%path,SQL Server] != -1 then
	echo Updating path...
	echo - Remove the SQL entries from the system path
	call os path editor
	pause
endiff

return

:SsIcons

echo Updating icons...
call MergeDir /q /rename "%pp\Microsoft SQL Server 2012" "%ServerPrograms\Other\SQL Server 2012"
call MergeDir /q /rename "%pp\Microsoft Visual Studio 2010" "%pp\Development\.NET\Other\Visual Studio 2010"

call MergeDir /q /rename "%pp\Microsoft SQL Server 2008 R2" "%ServerPrograms\Other\SQL Server 2008 R2"
call MergeDir /q /rename "%pp\Microsoft SQL Server 2008" "%ServerPrograms\Other\SQL Server 2008"
call MergeDir /q /rename "%pp\Microsoft Visual Studio 2008" "%pp\Development\.NET\Other\Visual Studio 2008"

call MergeDir /q /rename "%pp\Windows PowerShell 1.0" "%pp\Operating System\Other\PowerShell"

set link=%ServerPrograms\Other\SQL Server 2012\SQL Server Management Studio.lnk
call CopyFile "%link" "%ServerPrograms"

return

:SsRegistry

call ask.btm `Update registry?` y
if %? != 1 return

echo Updating registry...

set r=HKCU\Software\Microsoft\Microsoft SQL Server\110\Tools\Shell
call registry set "%r\DefaultBrowseComponentLocation" REG_SZ %SqlDir >& nul:
call registry set "%r\DefaultFileOpenLocation" REG_SZ %SqlDir >& nul:
call registry set "%r\DefaultNewProjectLocation" REG_SZ %SqlDir >& nul:
call registry set "%r\DefaultNewProjItemLocation" REG_SZ %SqlDir >& nul:
call registry set "%r\DefaultOpenProjectLocation" REG_SZ %SqlDir >& nul:
call registry set "%r\DefaultOpenProjItemLocation" REG_SZ %SqlDir >& nul:
call registry set "%r\DefaultOpenSolutionLocation" REG_SZ %SqlDir >& nul:

return

:SsSamples
text
************************
* SQL Server Samples
************************
endtext

gosub run "Microsoft\SQL Server\samples\SQL2008.AdventureWorks_All_Databases.%@OsArchitecture[].msi"
gosub run "Microsoft\SQL Server\samples\SQL2008.All_Product_Samples_Without_DBs.%@OsArchitecture[].msi"

echo Updating icons...
call MergeDir /q /r "%pp\Microsoft SQL Server 2008 Community `&` Samples" "%ServerPrograms\Other\SQL Server 2008\samples"
call DelFile "%pd\Microsoft SQL Server 2008 Community ? Samples Code.lnk"
call DelFile "%pd\Microsoft SQL Server 2008 Community ? Samples License.lnk"
call DelFile "%pd\Microsoft SQL Server 2008 Community ? Samples Portal.lnk"

pause

return

:iis
REM - Add/Remove Windows Components requires inf files
REM - Remote Desktop Web Connection reference http://www.microsoft.com/windowsxp/using/networking/expert/northrup_03may16.mspx
text
************************
* IIS
************************
endtext

switch %_WinVer

REM Windows XP / IIS 5.1
case 5.1
  
  echo - Install Optional Windows Components
  echo - Check Internet Information Services (IIS)
  echo - When prompted for a Windows XP installation or SP2 location, specify c:\dev\iso1\i386 (in clipboard)
  echo.
  echo %@CLipW[c:\dev\iso1\i386] >& nul:
    
  REM Mount Windows XP installation CD
  gosub run "Microsoft\XP\setup\en_windows_xp_professional_n_with_service_pack_3_x86_cd_vl_x14-78118.iso"
	  
  REM Get IIS updates
  call os update
    
  REM IIS 6 Manager  
  gosub run "Microsoft\Internet Information Services\IIS V6.0 Manager for Windows XP.exe"
 
  call firewall console
  pause

REM Windows Server 2003 / IIS 6.0
case 5.2
  echo - Add or remove a role, Next, Application server, check Enable ASP.NET, uncheck FrontPage Server Extensions
  start /pgm "%WinDir\system32\mshta.exe" res://%WinDir\system32\mys.dll/mys.hta
  pause

REM Vista / IIS 7.0
case 6.0 .or. 6.1

  text
- Internet Information Services, check all
- (optional) Internet Information Services Hostable Web Core
	endtext
  call os optional
	pause
	
endswitch

REM HTTP firewall configuration
iff %@IsWindowsClient[] == 1 then
      
  echo Updating firewall...
  call firewall rule enable "World Wide Web Services HTTP Traffic In"
  
endiff

echo Updating services...
call service manual SMTPSVC
call service manual FTPSVC

call ask `Do you want IIS to start automatically ?` y
iff %? == 0 then
  call service manual IISADMIN
  call service manual w3svc
  call service manual AppHostSvc
endiff

echo Updating icons...

set file=%WinDir\system32\inetsrv\iis.msc
iff IsFile "%file" then
	call MakeDir "%pd\Development\Other\IIS"
	call MakeShortcut "%file" "%pp\Development\Other\IIS\IIS Client Manager.lnk"
endiff

call MergeDir /q "%pp\IIS" "%pp\Development\Other\IIS"

set file=%WinDir\system32\inetsrv6\iis6.msc
iff IsFile "%file" then
	call MakeShortcut "%file" "%pp\Development\Internet Information Services 6.lnk"
endiff

call ask `Do you want to configure WebDAV?`
if %? == 1 gosub IisWebDAV

call ask `Do you want to configure the FTP service?`
if %? == 1 gosub IisFtp

call ask `Do you want to configure IIS debugging?`
if %? == 1 gosub IisDebugging

call ask `Do you want to enable IIS compression?`
if %? == 1 gosub IisCompression

call ask `Do you want to enable SSL?` y
if %? == 1 gosub IisSsl

iff %_WinVer == 5.2 then
	echo - (IIS6) Computer, Properties, check Enable Direct Metabase Edit
	call iis manager
	pause
endiff

REM Install IIS Remote Manager on Windows clients.  Not required on server as it is included with server IIS install.
if %@IsWindowsClient[] == 1 call install.btm IisRemoteManager

REM Computer specfic IIS configuration
iff IsLabel Iis%ComputerName then
  echo %ComputerName specific IIS configuration...
  gosub Iis%ComputerName
endiff

echo Restarting IIS...
iisreset

return

:IisCheck

iff %@IsInstalled[iis] == 0 then
	echo.
	call ask `Do you want to install IIS?`
	if %? == 1 gosub iis
endiff

return

:IisWebDAV

text
- Default Web Site, WebDAV Authoring Rules, Enable WebDAV
  - Add Authoring Rule, Specified users=jjbutare, Permissions=Read&Source&Write
- Create directory c:\inetpub\wwwroot\share
  - Authentication, Anonymous Authentication=Disabled, Windows Authentication=Enabled
  - Directory Browsing=Enable
  - Site, Add Virtual Directory..., Alias=Public, Physical path=c:\Users\Public
  - Site, Add Virtual Directory..., Alias=<user friendly name, i.e. John>, path=c:\Users\<username>,
    Connect As=Specific user, Set..., User name=<user with permissions to the users share, i.e. the user, system account, other>
endtext
		call iis manager
pause

return

:IisFtp

echo Updating firewall...
call firewall rule enable "FTP Server (FTP Traffic-In)"
call firewall rule enable "FTP Server Passive (FTP Passive Traffic-In)"
call firewall rule enable "FTP Server Secure (FTP SSL Traffic-In)"

text
- Sites, Add FTP Site..., FTP site name=ftp, Physical path=c:\inetpub\ftproot
  - SSL=No SSL, Authentication=Basic, Allow access to=Specified users, <username>, check Read and Write
- FTP Directory Browsing, check Virtual directories
- Site, Add Virtual Directory..., Alias=Public, Physical path=c:\Users\Public
- Site, Add Virtual Directory..., Alias=<user friendly name, i.e. John), Physical path=c:\Users\<username>
endtext
call iis manager
pause

return

:IisDebugging
REM Reference: http://support.microsoft.com/default.aspx?scid=kb;en-us;290398

echo - Component Services\Computers\My Computer\DCOM Config\Machine Debug Manager,
echo   Properties, Security, Access Permissions Edit, Add..., Interactive;IWAM_<ComputerName>
gosub RunProg dcomcnfg

return


:IisCompression

echo IIS Manage updates...
text
- (IIS6) Computer, Properties, check Enable Direct Metabase Edit
- (enable compression for IIS6 and below)
  - Web Sites, Properties, Service
    - Check Compress application files 
    - Check Compress Static files
    - Maximum temporary directory size=1000
  - Web Service Extension, Add a new Web service extension...
    - Extension name=HTTP Compression
    - Add..., Path to file=c:\windows\system32\inetsrv\gzip.dll 
    - Check Set extension status to Allowed
endtext
call iis manager
pause

echo Direct metabase updates...
text
- (two places, one for deflate and one for gzip) <IIsCompressionScheme 
  - HcScriptFileExtensions: Add extensions (aspx, asmx, php, etc) using existing format
- HcDynamicCompressionLevel=9 (0 min compression to 10 max compression)
endtext
iis config
pause

return

:IisSsl

REM Install the SSL Certificate
echo Install the computer or wildcard certificate to use in IIS
call certificate manager
pause

REM HTTPS firewall configuration
iff %@IsWindowsClient[] == 1 then
  echo Updating firewall...
  call firewall rule enable "World Wide Web Services HTTPS Traffic In"
endiff

REM Configure wildcard certificate
text
- Wildcard certificates (i.e. *.podzone.net) are required if you will be hosting more than 
  one domain using SSL (i.e. site1.podzone.net, site2.podzone.net).
- Edit the SecureBindings metabase key, i.e. ":443:site1.podzone.net"
endtext
call iis service stop
call iis config
call iis service start
pause

REM Install the certificate in IIS    
iff %_WinVer lt 6.0 then
  echo - Default Web Site, Directory Security, Secure communications, Server Certificate...,   
else
  echo - Server Certificates, Import
	echo - Default Web Site, Edit Bindings, Add, type=https, SSL certificate=%ComputerName.podzone.net
endiff
call iis manager
pause	

REM Install the certificate on clients to prevent certificate error in Internet Explorer and enables use of SourceSafe Internet
text
- Note: Each client machine that visits trust the SSL certificate used.  If the certificate
  is not from a trusting authority that has a certificate already installed, import 
  the certificate on the client using Certificate Manager Import
endtext

return

:IisRemoteManager
REM download - http://www.iis.net/download/iismanager
text
************************
* IIS Remote Manager
************************
endtext

gosub run "Microsoft\Internet Information Services\extensions\inetmgr_%@OsArchitecture[].msi"

echo Updating icons...
call MoveFile "%pp\Internet Information Services (IIS) 7 Manager.lnk" "%ServerPrograms\Internet Information Services (IIS) Manager.lnk"

return

:IISExpress

echo Moving data folders...
call MakeLink merge "%UserData\IISExpress" hide "%UserDocuments\IISExpress"
call MergeDir /quiet /rename "%UserDocuments\My Web Sites" "%UserDocuments\code\web"

return


:IntelRemoteAccess
REM - AnyConnect (iss 8102) - AnyConnect replaced SoftID and NetStructure
REM  - installs: Cicso AnyConnect client, Intel remote access certificate, and Intel ProxyManager
REM  - note: install requires domain access for certificate provisioning
REM - faq : http://servicedesk.intel.com/sdcxuser/Intel/userbrowse.asp?sprt_fid=79c22297-9202-48c5-8fe4-e24f1affc720
REM - install: http://servicedesk.intel.com/sdcxuser/Intel/defcontent_view2.asp?ssfromlink=true&sprt_cid=e2311896-1a61-439e-ad93-ee15b9114918
REM - certificate issues: if there is an error installing the certificate, copy the certificate setup program while the AnyConnect.exe setup is running, then run IntelCertificateUtility.exe separately
REM   issues: https://intelpedia.intel.com/Windows_7_at_Intel
text
************************
* Intel Remote Access
************************
- Must be connected to the Intel network
endtext

gosub run "Intel\Remote Access\setup\AnyConnect.EXE"

echo Updating icons...
call MergeDir /q "%pp\Cisco" "%pp\Operating System\Other"
call MergeDir /q "%pp\ProxyManager" "%pp\Operating System\Other"
call DelFile "%pd\AnyConnect Pocket Guide.lnk"
call DelFile "%pd\Cisco AnyConnect VPN Client.lnk"
call MoveFile "%psm\Cisco AnyConnect VPN Client.lnk" "%pp\Operating System"

echo Updating registry...

REM Delete LoadProxyMan - C:\PROGRA~2\PROXYM~1\ProxyMan.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\LoadProxyMan"

text
- Wireless Configuration
  - Intel Guest: SSID=Guest
    - Connection, check  Connect even if the network is not broadcasting its name (SSID)
    - Security, Security type=No authentication (Open), Encryption type=None
  - Intel: SSID=TSNOfficeWLAN
    - Connection, check  Connect even if the network is not broadcasting its name (SSID)
    - Security, Security type=WPA2-Enterprise, Encryption type=AES
endtext

return

:SnagIt
text
************************
* SnagIt
************************
- Custom, uncheck Windows Explorer Menu Extension
endtext

gosub run "TechSmith\SnagIt\setup\SnagIt V11.2.1.172.exe"
REM gosub run "TechSmith\SnagIt\setup\SnagItUp.exe"

echo Updating icons...
call MergeDir /q /rename "%pp\TechSmith" "%ao\TechSmith"
call MoveFile "%ao\TechSmith\Snagit ?? Editor.lnk" "%ao\TechSmith\Snagit Editor.lnk"
call MoveFile "%ao\TechSmith\Snagit ??.lnk" "%ao\TechSmith\Snagit.lnk"
call DelFile "%pd\SnagIt ??.lnk"
call DelFile "%pd\SnagIt ?? Editor.lnk"
call DelFile "%pp\Startup\SnagIt ??.lnk"

REM Start SnagIt now so that the registry entries below are created
call SnagIt start
pause Close SnagIt then press any key to continue...

echo Updating registry...
set r=HKCU\Software\TechSmith\SnagIt\11
set folder=%UserDocuments\data\SnagIt
call registry.btm 32 set "%r\CatalogFolder" REG_SZ %folder\
call registry.btm 32 set "%r\ExternalOutputDir" REG_SZ %folder\Program\
call registry.btm 32 set "%r\StampCustomFolder" REG_SZ %folder\Stamps\
call registry.btm 32 set "%r\IMOutputDir" REG_SZ %folder\Instant Messenger\

echo Updating directories...
call MergeDir /q /rename "%UserDocuments\SnagIt" "%UserData\SnagIt"
call MakeDir "%UserData\SnagIt\Stamps"
call DelDir.btm "%UserDocuments\SnagIt Stamps"

echo Installing outputs...
set p=%install\TechSmith\SnagIt\outputs
REM ShellRun "%p\Flickr.snagacc"
REM ShellRun "%p\WordPress.snagacc"

REM Restart AutoHotKey so ctrl-shift-p is released
call sudo /standard AutoHotKey.btm restart

text
- Quick Launch, Turn off OneClick
- Tools, Program Preferences...,
  - Program Options, check Minimize to tray
  - Notifications, uncheck Show all tips and Show all balloon tips
  - Updater Options, uncheck Enable automated update checking
- Profile Settings
  - Share=Clipboard, uncheck Preview in Editor, Save as New Profile, Name=Clipboard
  - Share=Word, uncheck Preview in Editor, Save as New Profile, Name=Word
- Notification Area
  - Customize, Snagit, Show icon and notifications 
endtext
call SnagIt.btm start

return

:WindowsMediaPlayer
:wmp
text
************************
* Windows Media Player
************************
- Don't run Microsoft Music Assistant
endtext

iff not defined NewOs then
  gosub run "Microsoft\Media\Player V11\wmp11-windowsxp-%@OsArchitecture[]-enu.exe"
endiff

text
- Click Turn shuffle on and Turn repeat on
- Tools, Options
  - Player, uncheck Add local media files to library when played
  - Rip Music 
    - (music roo) Rip music to this location=Public\Music
    - File Name..., Check only Song title	
    - Format=mp3
    - Check Eject CD after ripping
    - Audio Quality=256 Kbps
  - Devices, Advanced, Store files temporarily to this location=d:\temp
  - Burn
    - uncheck Burn CD without gaps
    - Add a list of burned files to the disc in the this format=M3U
	- Library
    - Uncheck Retrieve additional information from the internet, Only add missing information
    - (music roo) Check Rename music files using rip music settings
    - (music roo) Check Rearrange music in rip music folder, using rip music settings
    - Check Maintain my star ratings as global ratings in files
- File, Manage Libraries
  - Validate personal and public libraries are selected
	- (media roo Music) Set default save location to Public
- Customize navigation pane..., 
  - Music check Year, Rating, Composer
  - Videos check Rating, Folder
  - Picture check all
  - Recorded TV check Series, Genre 
- Navigation Pane, right click each Sonos device, remove from list
- Music, columns Title, Rating, #, Length, Contributing artist, Composer
- Notes
  - Tools, Apply media information changes to apply tag changes to media files and rearrange and rename music according to rip settings
endtext
call WindowsMediaPlayer start
pause

call WindowsMediaPlayer service manual

echo Windows Media Center...
iff %@IsInstalled[WindowsMediaCenter] == 1 then
	text
- Settings, add features, Add features to Windows
- Tasks, Settings
  - Library Setup
	- (prevent wakeup) General, Automatic Download Options, uncheck Automatically download Windows Media Center data between the following times:
	endtext
	call WindowsMediaCenter.btm start
	pause
endiff

return

:WmpEncoder
REM - Download http://www.microsoft.com/windows/windowsmedia/forpros/encoder/default.mspx
text
******************************
* Windows Media Player Encoder
******************************
endtext

gosub run "Microsoft\Media\Encoder V9\WMEncoder %@OsArchitecture[].exe"

iff %@ServiceExist[WmdmPmSN] == 1 then
	echo Updating services...
	call service manual WmdmPmSN
endiff

echo Updating icons...
call MergeDir /q "%pp\Windows Media" "%pp\Media\Other"

return

:DirectX
REM Reference http://www.appdeploy.com/packages/detail.asp?id=169
text
************************
* DirectX
************************
endtext

iff "%@RegQuery["HKLM\SOFTWARE\Microsoft\DirectX\Version"]" == "4.09.00.0904" then
  echo DirectX V9.0c is already installed.
else
  echo Installation of DirectX will run silently.

  set RunOptions=/silent
  gosub run "Microsoft\DirectX V9.0c Redistributable\DXSETUP.exe"
endiff

return

:QCheck
text
************************
* QCheck
************************
endtext

gosub run "netiq\qcheck 2.1.939\qcinst21.exe"

echo Updating icons...
call MoveFile "%pd\QCheck.lnk" "%pp\Operating System"
call MergeDir /q "%pp\NetIQ Qcheck" "%pp\Operating System\Other"

return

:AdobeAIR
:AIR
text
************************
* Adobe AIR
************************
endtext

gosub run "Adobe\AIR\Adobe AIR v3.0.0.4080.exe"

return

:AdobeReader
:reader
REM  Download: http://www.adobe.com/products/acrobat/readstep2.html
text
************************
* Adobe Reader
************************
endtext

gosub run "Adobe\reader\AdbeRdr1001_en_US.exe"

echo Updating registry...

REM Delete  Adobe ARM - "C:\Program Files\Common Files\Adobe\ARM\1.0\AdobeARM.exe"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Adobe ARM"

REM Delete Adobe Reader Speed Launcher - "C:\Program Files (x86)\Adobe\Reader 9.0\Reader\Reader_sl.exe"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Adobe Reader Speed Launcher"

echo Updating icons...
call MoveFile "%pp\Adobe Reader 9.lnk" "%pp\Applications\Adobe Reader.lnk"
call MoveFile "%pp\Adobe Reader X.lnk" "%pp\Applications\Adobe Reader.lnk"
call MoveFile "%pp\Acrobat.com.lnk" "%pp\Applications"
call DelFile "%pd\Adobe Reader 9.lnk"
call DelFile "%pd\Adobe Reader X.lnk"
call MoveFile "%pd\Acrobat.com.lnk" "%pp\Applications"
call DelFile "%pp\Startup\Adobe Reader Speed Launch.lnk"
call DelFile "%pp\Startup\Adobe Reader Synchronizer.lnk"

text
- Tools, Customize Toolbars...
  - File Toolbar: Check only: Save, Search, Email
  - Page Display Toolbar: Single Page Continuous
  - Page Navigation Toolbar: Previous and Next View
  - Select & Zoom Toolbar: Select Tool, Hand Tool, Dynamic Zoom, Fit Width, Fit Page
endtext
call AdobeReader.btm start

return

:FlashPlayer
:flash
REM Download: http://www.filehippo.com/download_flashplayer_ie_64 (full version) 
REM   http://get.adobe.com/flashplayer/ http://get.adobe.com/flashplayer/otherversions/ (partial download)
REM Version: http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_15507
REM Install: http://get.adobe.com/flashplayer/
REM Beta: http://labs.adobe.com/downloads/ (x64 flash faq http://labs.adobe.com/technologies/flashplayer10/faq.html)
REM Versions: http://www.adobe.com/software/flash/about/
REM Test; http://www.adobe.com/software/flash/about/, http://www.chemgapedia.de/vsengine/info/en/help/requirements/flash.html
REM Full screen patch (click on other monitor does not close): http://my.opera.com/d.i.z./blog/2009/04/22/watch-fullscreen-flash-while-working-on-another-screen and http://deve.loping.net/projects/ignoflash/
REM Install log: C:\Windows\SysWOW64\Macromed\Flash\FlashInstall.log
text
************************
* Flash Player
************************
- Never check for updates
endtext

set test=http://www.adobe.com/software/flash/about/

set version=11.6.602.180
set p=Adobe\Flash Player\setup
gosub run "%p\Flash v%version.exe"
if %_WinVer le 6.2 gosub run "%p\Flash for IE v%version.exe"

echo Updating registry...

REM Delete FlashPlayerUpdate - C:\WINDOWS\system32\Macromed\Flash\NPSWF32_FlashUtil.exe -p
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce\FlashPlayerUpdate"

call ask `Do you want to test Flash?`
iff %? == 1 then
	call chrome %test%
	call chrome beta %test%
	call firefox %test%
	call InternetExplorer 32 %test%
	call InternetExplorer 64 %test%
endiff

return

:Chrome
REM download - http://www.google.com/chrome/eula.html?system=true&standalone=1
text
************************
* Google Chrome Browser
************************
endtext

gosub run "Google\Chrome\setup\ChromeStandaloneSetup.exe"	n

echo Updating icons...
call DelFile "%ud\Google Chrome.lnk"
call DelFile "%pd\Google Chrome.lnk"
call DelFile "%ud\Google Chrome Canary Build.lnk"
call MergeDir /q /rename "%pp\Google Chrome" "%ao\Chrome"
call MergeDir /q /rename "%up\Google Chrome" "%ao\Chrome"
call MergeDir /q /rename "%up\Google Chrome Canary Build" "%ao\Chrome Beta"

echo Updating registry...

REM Delete Google Update - c:\users\jjbutare\appdata\local\google\update\googleupdate.exe	
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Google Update"

text
- (for Browser Texting) Gmail Offline, select Allow offline mail
- Defer, Options, Default Service=Instapaper
- Browser Texting, scan QR code from phone
- (optional) chrome://flags, enable features
endtext
call chrome start
pause

return

:Picasa
REM download - http://picasa.google.com/#sitelink=picasa&utm_campaign=en&utm_source=en-ha-na-us-bk-sitelink&utm_medium=ha&utm_term=picasa
text
************************
* Google Picasa
************************
- Completing the Picasa 3 Setup
  - Uncheck Set Google as my default search engine in Internet Explorer
  - Uncheck Send anonymous usage stats to Google
- Only search My Documents, My Pictures, and Desktop
- Select Don't use Picasa Photo Viewer
endtext

gosub run "Google\Picasa\Picasa Setup v3.9.136.200.exe"

echo Updating icons...
call MergeDir /q /rename "%pp\Picasa 3" "%ao\Picasa"
call MoveFile "%ao\Picasa\Picasa 3.lnk" "%ao\Picasa\Picasa.lnk"
call DelFile "%ao\Picasa\Uninstall.lnk"
call DelFile "%pd\Picasa 3.lnk"

return

:GoogleCommandLine
REM http://code.google.com/p/googlecl/ http://code.google.com/p/gdata-python-client/
text
************************
* Google Command Line
************************
endtext

call ask `Do you want to install Python?`
if %? == 1 gosub python

echo.
echo Installing Google Data API...
set InstallDir=%programs\Google\Data API
gosub run "Google\Data API\gdata-2.0.10.zip"
pushd "%InstallDir" & setup.py install & popd

echo.
echo Installing Google Command Line...
set InstallDir=%programs\Google\Command Line
gosub run "Google\Command Line\googlecl-0.9.5.7z"
pushd "%InstallDir" & setup.py install & popd

echo.
echo Configuring Google Command Line...
echo - Hit enter, then add the following to the GENERAL section:
echo auth_browser = %LocalAppData\Google\Chrome\Application\chrome.exe 
call google.btm docs list
call TextEdit.btm
pause

echo.
echo Testing Google Command Line...
call google.btm docs list

return

:GoogleToolbar
REM Update - "C:\Users\jjbutare\AppData\Local\Google\Update\GoogleUpdate.exe" /c
text
************************
* Google Toolbar
************************
endtext

ShellRun http://toolbar.google.com/install
pause

text
Toolbar:
- Install Without advanced features
- Move the QuickLinks to the right of the IE icons. 
- Google, Toolbar Options
  - Options, Check
    - Drop-down search history
    - Highligh button
    - Word-find buttons
    - Popup Blocker
    - AutoFill button
    - BlogThis!
  - More  
    - Search Options - check all
    - Web buttons - check Up, Next & Previoys
    - Extra search buttons - check Search Groups
    - Extras - check Automatically hilight fields that AutoFill can fill
endtext

return

:VideoStudio
REM Updates: http://www.ulead.com/download/download.htm, http://www.corel.com/servlet/Satellite/us/en/Content/1197911963266
REM Installs:
REM - Path: C:\Program Files\Common Files\Ulead Systems\MPEG
REM - Run: UVS12 Preload - "C:\Program Files\Corel\Corel VideoStudio 12\uvPL.exe"
REM - Service: UleadBurningHelper
text
************************
* VideoStudio
************************
endtext

REM VideoStudio, patches, and plug-ins
set pre=Corel\Video Studio 12

gosub run "%pre\setup\setup.exe"
gosub run "%pre\update\VSX2PROPATCH.exe"

echo Installing Bonus Pack (WinDVD and media)... 
gosub run "%pre\Bonus Pack\AutoRun.exe"

echo Installing Content Pack (SmartSound Quicktracks)...
gosub run "%pre\Content Pack\setup.exe"

REM Registry
echo Updating registry...

REM Delete UVS12 Preload - C:\Program Files\Corel\Corel VideoStudio 12\uvPL.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\UVS12 Preload"

REM SmartSound
echo Configuring SmartSound...
call MergeDir /r "c:\SmartSound Software" "%UserData\SmartSound"
text
- Audio, Audio, Auto Music, SmartSound QuickTracks, Folders
  - Add Folder, Documents\data\SmartSound\Quicktracks\Library, Set Copy Destination
endtext
call VideoStudio start
pause
call DelDir "c:\SmartSound Software"

REM Icons
echo Updating icons...
call MergeDir /q /r "%pp\Corel VideoStudio 12" "%pp\Media\Other\VideoStudio"
call MergeDir /q "%up\InterVideo WinDVD" "%pp\Media\Other"
call MoveFile "%pd\Corel VideoStudio 12.lnk" "%pp\Media\VideoStudio.lnk"

call MakeDir "%UserDocuments\media\work\proxy"

REM Instructions
text
- File, Preferences
  - General
      - Working folder=\Documents\media\work
      - Check Display DV timecode on Preview Window (interferes with MaxiVista)
  - Edit, check Cache image clips in memory
	- Capture
    - Captured still image save format = JPEG
  - (if data drive exists) Preview, uncheck 1, check 2=d:\temp
  - Smart Proxy, Proxy folder=\Documents\media\work\proxy
- Library
  - Library manager, create Sample and Capture custom folders
- Notes
  - Additional content in install\Ulead\content
endtext

return

:AppleCore

echo Updating Apple icons...
call MakeDir "%ao\Apple"
call MoveFile "%pp\Apple Software Update.lnk" "%ao\Apple"

return

:iCloud
REM http://support.apple.com/kb/DL1455
text
************************
* iCloud
************************
endtext

gosub run "Apple\iCloud\iCloudSetup v2.1.2.exe"

REM Delete iCloudServices - C:\Program Files (x86)\Common Files\Apple\Internet Services\iCloudServices.exe
REM call registry delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\iCloudServices"

REM Delete MobileDocuments - C:\Program Files (x86)\Common Files\Apple\Internet Services\ApplePhotoStreams.exe
REM call registry delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\MobileDocuments"

REM Delete ApplePhotoStreams - C:\Program Files (x86)\Common Files\Apple\Internet Services\ubd.exe
REM call registry delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ApplePhotoStreams"

text
- uncheck Mail, Contacts, Calendars, & Tasks
- uncheck Bookmarks
- check Photo Stream, Options..., Photo Stream Location: Change..., Pictures\Photo Stream
endtext

echo Updating icons...
call MergeDir /q "%pp\iCloud" "%pp\Operating System\Other"

gosub AppleCore

return

:Bonjour
REM Installs Bonjour Service
text
****************************
* Bonjour Service Discovery
****************************
endtext

gosub run "Apple\Bonjour\BonjourSetup.exe"

echo Updating icons...
call MoveFile "%pd\Bonjour Printer Wizard.lnk" "%pp\Operating System"
call MergeDir /q "%pp\Bonjour" "%pp\Operating System\Other"

return

:AirPrint
REM Install AirPrint to enable printing from iOS devices
REM http://www.brucetdoesit.com/2011/08/airprint-for-windows-no-jailbreak-reqd.html
text
************************
* AirPrint
************************
endtext

echo Installing the AirPrint service...
echo - Install AirPrint Service, AirPrint Auth=Use Guest Account
gosub run "Shareware\AirPrint\setup\AirPrint_Installer.exe"
pause

call registry import "%ExeDir\AirPrint iOS 5 FIX - %@OsBits[]Bit.reg"

text
- Shared printers will be displayed as AirPrint printers
endtext

return

:iTunes
REM Download: http://itunes.com
REM Setup: VBScript is not installed error: http://coderjournal.com/2007/03/apple-wants-vista-to-run-un-secured-to-install-itunes/
REM AirPrint: http://discussions.apple.com/thread.jspa?threadID=2659544 or http://ipadhelp.com/ipad-help/how-to-enable-airprint-for-windows-and-use-any-printer/
REM Installs:
REM   - iTunesHelper - optional, for quick launch
REM   - Shell Extension: iTunes
REM   - Task Scheduler: AppleSoftwareUpdateApple
REM -   Services: Apple Mobile Device (required), iPod Service (recognize iPods), Bonjour Service (sharing), AirPrint
text
************************
* iTunes
************************
- Uncheck Use iTunes as the default player for audio files
- Uncheck Automatically update iTunes and other Apple software
endtext

gosub run "Apple\iTunes\setup\iTunes v11.0.5.5 %@OsArchitecture[].exe"

echo Updating icons...
call DelFile "%pd\iTunes.lnk"
call MergeDir /q "%pp\iTunes" "%ao"

echo Updating registry...

REM Delete iTunesHelper - "C:\Program Files\iTunes\iTunesHelper.exe"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\iTunesHelper"

REM Delete APSDaemon - "C:\Program Files (x86)\Common Files\Apple\Apple Application Support\APSDaemon.exe"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\APSDaemon"

echo Updating services...
call service auto "iPod Service"

gosub QuickTimePost
gosub AppleCore

echo Restoring the default profile...
call iTunes profile restore default

text
Use alt to open menu items
- iTunes Store, Sign In
- Store, Authorize Computer...
- Edit, Preferences
	- General
    - Library Name=<first name>'s Library
    - Sources, check all
    - Import Settings
      - Import Using=MP3 Encoder
      - Setting=Higer Quality
	- Store, uncheck Automatic Downloads, Music, Apps, Books
	- Advanced
    - iTunes Music folder location=Music\My Music or (Music ROO) Music\Public Music
    - uncheck Keep iTunes Music folder organized
    - uncheck Copy files to iTunes Music folder when adding to library
    - check Enable full keyboard navigation
- File, Add folder to library..., Music\My Music or (Music ROO) Music\Public Music
- Connect iOS device
  - (optional) Music, check Selected playlists, artists, and genres, check Best or 5 Star
  - (optional) Info
    - Check Sync Contacts with Outlook
    - (one time) check Sync Mail Accounts from Outlook
    - Check Sync notes with Outlook
- Notes: Ctrl-t visualizer, ctrl-f full screen
endtext
call sudo /standard iTunes start

return

:QuickTime
REM Reference http://www.QuickTime.com
text
************************
* QuickTime
************************
- Load software from Apple's site.  
- Custom installation, select all options.
endtext

gosub run "Apple\QuickTime\QuickTimeInstaller.exe"

gosub QuickTimePost

text
- Edit, Preferences, QuickTime Preferences..., Advanced
  - Uncheck Install QuickTime icon in system tray
endtext

return

:QuickTimePost

REM QuickTime Task - "C:\Program Files\QuickTime\qttask.exe" -atboottime
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\QuickTime Task"

echo Updating icons...
call DelFile "%pd\QuickTime Player.lnk"
call MoveFile "%pp\Apple Software Update.lnk" "%ao\Apple"

REM Installer will run if the QuickTime folder is not present
iff IsDir "%pp\QuickTime" then
	call CopyDir "%pp\QuickTime" "%ao\Apple\QuickTime"
	attrib /d +h "%pp\QuickTime"
endiff

return

:JavaDevCore
text
************************
* Java Development
************************
endtext

call MakeDir "%pp\Development\Java\Other"

echo Adding Java development registry entries...
call registry import "%SetupFiles\JavaDev.reg"
call registry set "HKLM\SOFTWARE\Classes\classfile\shell\open\command\" REG_SZ ^
	"%@search[tcc.exe]" /c JavaUtil.btm decompile "^%1" ^%*
call registry set "HKLM\SOFTWARE\Classes\classfile\DefaultIcon\" REG_SZ ^
	"%PublicDocuments\icons\Java-coffe.ico"

REM Add lib folder to CLASSPATH
call MakeDir "%PublicData\Lib"
call SetVar /path ClassPath "%PublicData\Lib"

call install.btm jdk JavaDoc JavaSource Ant Eclipse

return

:jre
REM Download 7: http://www.oracle.com/technetwork/java/javase/downloads/index-jsp-138363.html#javasejdk
REM Download: http://www.java.com/en/download/manual.jsp
REM Download: http://www.oracle.com/technetwork/java/javase/downloads/index.html
REM Eary access: http://www.oracle.com/technetwork/java/javase/downloads/ea-jsp-142245.html
REM Test: http://www.java.com/en/download/installed.jsp http://java.com/en/download/help/testvm.xml
REM Services: JavaQuickStarterService
text
**************************
* Java Runtime Environment
**************************
endtext

gosub run "Sun\Java\jre\*-x86.exe"
if %@OsArchitecture[] == x64 gosub run "Sun\Java\jre\*-x64.exe"

gosub JavaFinal

return

:jdk
REM http://java.sun.com/javase/downloads/index.jsp
REM http://java.sun.com/products/archive/
text
************************
* Java Development Kit
************************
- (optional) Browser Registration, Uncheck Microsoft Internet Explorer
endtext

REM Under x64 show both x86 and x64 JDKs
set pattern=%@if[ %@OsArchitecture[] == x86 ,*-x86.exe,*.exe]

do forever
	gosub run "Sun\Java\jdk\%pattern"
	call ask.btm `Do you want to install another jdk?`
	if %? == 0 leave
enddo

echo Updating JAVA_HOME...
call ask `Do you want to update the JDK Home?` y
if %? == 1 call JavaUtil SetHome

echo Updating icons...
call DelFile "%pd\Java Web Start.lnk"
call MergeDir /q "%pp\Java Web Start" "%pp\Operating System\Other"

iff %@IsInstalled[eclipse] == 1 then

	call ask `Do you want to set the default JRE for Eclipse?` y
	if %? == 1 call eclipse select SetJre

	call ask `Do you want to add the new JDK to Eclipse?` y
	iff %? == 1 then
		call eclipse select start
		echo - Window, Preference, Java, Installed JREs, Search..., %programs\Java
		pause
	endiff

endiff

gosub JavaFinal

return

:JavaFinal

echo Updating registry...

REM Delete SunJavaUpdateSched - C:\Program Files\Java\jre1.5.0_05\bin\jusched.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SunJavaUpdateSched"
call registry.btm 64 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SunJavaUpdateSched"

call ask `Do you want to test the Java browser plugin?` y
if %? == 1 call JavaUtil test

return

:JavaDoc
REM http://java.sun.com/javase/downloads/index.jsp (current)
REM http://java.sun.com/javase/downloads/previous.jsp (previous)
text
************************
* Java Documentation
************************
endtext

echo.
echo Installing common documentation...
set InstallDir=%programs\Java\doc
set RcOpts=%RcOptsRegular /xf *.zip
gosub run "Sun\Java\doc"

echo.
echo Compacting documentation...
call CompactDir "%InstallDir"

echo.
echo Installing JDK documentation...
set InstallDir=`%programs\Java\doc\%@name[%exe]`
gosub run "Sun\Java\doc\jdk-*-docs.zip"

echo.
echo Installing JDK language specification...
set InstallDir=`%programs\Java\doc\%@name[%exe]`
gosub run "Sun\Java\doc\langspec-*.zip"

echo.
echo Updating icons...
call MakeShortcut "%programs\Java\doc\default.html" "%pp\Development\Java\Java Doc.lnk"

return

:JavaSource
REM For DEBUG jar files, run jar setup and copy src.zip.
REM http://java.sun.com/javase/downloads/index.jsp (current)
REM http://java.sun.com/javase/downloads/previous.jsp (previous)
text
************************
* Java Source Code
************************
endtext

gosub FindExe Sun\Java\src\*-src*.zip
if %_? != 0 return %_?

set InstallDir=%programs\Java\src
call MakeDir "%InstallDir"

REM Copy source unextracted to source directory
echo Copying Java source...
call CopyFile "%exe" "%InstallDir"

iff %@IsInstalled[eclipse] == 1 then

	echo Updating Eclipse with the new JDK source...
	call ask `Do you want to update Eclipse with the new JDK source?` y
	iff %? == 1 then
		call eclipse select start
		echo %@ClipW[%InstallDir\%@FileName[%exe]] >& nul:
		echo - Window, Preference, Java, Installed JREs, select the JDK, Edit..., rt.jar, Source Attachment..., paste
		echo - Note: Some source is availble in the jdk directory in src.zip
	endiff

endiff

return

:ant
REM http://ant.apache.org/bindownload.cgi
text
************************
* Ant - Java build tool
************************
endtext

set version=apache-ant-1.7.1

set InstallDir=%programs\ant
gosub run "Java\Ant\%version-bin.zip"

REM ensure zip file does not conain extra level when unziupped
iff IsDir "%InstallDir\%version" then
	call MoveEx "%InstallDir\%version\*" "%InstallDir"
	rd "%InstallDir\%version"
endiff

REM Deploy custom ant.bat
call CopyFile "%ExeDir\ant.bat" "%programs\ant\bin"

REM Update the path
call SetVar /system /path path "%InstallDir\bin"

echo Updating icons...
call MakeDir "%pp\Development\Java\Other\Ant"
call MakeShortcut "%InstallDir\docs\index.html" "%pp\Development\Java\Ant Doc.lnk"
call MakeShortcut "%InstallDir\docs\index.html" "%pp\Development\Java\Other\Ant\Ant Doc.lnk"

return

:JProbe
text
************************
* JProbe
************************
endtext

gosub run "Quest Software\JProbe\setup\JProbeforWindowsEXEFormat_700.exe"

echo Updating icons...
call MergeDir /q "%up\JProbe 7.0" "%pp\Development\Other"
call CopyFile "%pp\Development\Other\JProbe 7.0\JProbe Console.lnk" "%pp\Development"

return

:DjJava
REM DjJava  uses the free JAD utility which is preferred if a GUI is not required.
REM V3.9.9.91, $20
REM http://members.fortunecity.com/neshkov/dj.html
REM Purchase - http://www.sharewareplaza.com/DJ-Java-Decompiler-download_38114.html
REM Purchase - http://www.softpedia.com/get/Programming/Debuggers-Decompilers-Dissasemblers/DJ-Java-Decompiler.shtml
text
************************
* DJ Java Decompiler
************************
endtext

gosub run "Java\DJ Java\SetupDJ.exe"

echo Updating icons...
call MoveFile "%pd\DJ Java Decompiler 3.9.lnk" "%pp\Development"
call DelFile "%pp\DJ Java Decompiler 3.9.lnk"

echo Copying license files...
call CopyFile "%install\Shareware\DJ Java\dj.exe" "%programs32\decomp"
call CopyFile "%install\Shareware\DJ Java\Archiver.exe" "%programs32\decomp"

call ask `Do you want to update the configuration files?` n
iff %? == 1 then
  echo Copying configuration files...
  call CopyDir "%install\Shareware\DJ Java\DJ Java Configuration" "%programs32\decomp"
endiff

gosub RunProg "%programs32\decomp\DJ.exe"

text
- Check I have a serial number and want to activate DJ Java Decompiler now.
- Settings, Decompiler Settings...
  - Check Output original line numbers as comments
- Settings, Configuration
  - Check Disable Save Dialog (on Close)
  - Select the Output Directory for .JAD files=%temp
  - Select Initial Directory for Open dialog: (on Open)=c:\code
endtext

return

:VirusScan
REM (McAfee products though comcast.net)  http://us.mcafee.com/root/dashboard.asp?affid=108
REM (Intel home use) McAfee 8.0i and updates available for home use at 
REM   http://secure.intel.com/InfoSec/Response_Services/PC+and+Network+Protection/Anti-Virus/Home+Computer+Anti-Virus+Software.htm
REM   file://fmea1pub006/Anti_Virus_Software/VirusScan_Home_User_CD/McAfee80i/MVSE80iHomePC.EXE
REM   unc: \\fmea1pub006/Anti_Virus_Software
REM Vista
REM - Beta program - https://secure.nai.com/apps/downloads/beta/login.asp?region=us&segment=enterprise
REM - http://www.mcafee.com/us/enterprise/downloads/beta/beta_mcafee/vse_vista.html
REM - http://secure.nai.com/us/enterprise/downloads/beta/beta_mcafee/vse.html
REM Memory usage ~82MB, minimal performance impact.
REM When uninstsalling:
REM - Stop Network Associate and McAfee services
REM - Autoruns, delete Network Associates and McAfee services (McAfee Framework Service, McAfeeUpdaterUI)
REM - Delete c:\Program Files\Network Associates McAfee Framework
text
************************
* VirusScan
************************
endtext

iff "%UserDomain" == "AMR" .or. defined server then
  set exe=McAfee\VirusScan V8.0i\VSE84564.EXE
elseiff defined NewOs then
  echo VirusScan for new operating systems not available.
	return 1
else
  gosub run "McAfee\VirusScan V8.0i\MVSE80iHomePC.EXE"
endiff

call MakeDir "%AllUsersProfile\documents\data\quarantine"

echo Updating icons...
call MergeDir /q "%pp\Network Associates" "%pp\Operating System\Other"
call MergeDir /q "%pp\McAfee" "%pp\Operating System\Other"

REM Delete ShStatEXE - C:\\Program Files\\Network Associates\\VirusScan\\SHSTAT.EXE\" /STANDALONE
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ShStatEXE"

REM Delete McAfeeUpdaterUI - "C:\Program Files\Network Associates\Common Framework\UpdaterUI.exe" /StartedFromRunKey
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\McAfeeUpdaterUI"

REM Delete Network Associates Error Reporting Service - C:\\Program Files\\Common Files\\Network Associates\\TalkBack\\tbmon.exe\"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Network Associates Error Reporting Service"

REM Delete McAfeeUpdaterUI - \"C:\\Program Files\\Network Associates\\Common Framework\\UpdaterUI.exe\" /StartedFromRunKey
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\McAfeeUpdaterUI"

call VirusScan setup

text
- VirusScan Console...,
  - Scan All Fixed Disks, Schedule, uncheck Enable
  - On-Access Scanner
    - General Settings, General
      - Check Enable on-access scanning at system startup
      - Quarantine Folder=%UserDocuments\data\quarantine
    - All Processes, Detection, Exclusions..., Add jphelp.chm
  - Buffer Overflow Protection, Disable
  - On-Delivery E-mail Scanner, Disable
  - (Virtual Machine) Tools, Edit AutoUpdate Repository List..., Add..., 
    - Repository Description=Intel HTTP
    - URL=virusscan.intel.com/mcafee/80i
    - port=9876
endtext

return

:AutoEnhance

gosub run "MediaChance\DCE Auto Enhance Pro V2.0\dcefull.exe"

echo Updating icons...
call MoveFile "%ud\DCE AutoEnhance.lnk" "%pp\Applications"
call MergeDir /q "%pp\DCE AutoEnhance" "%ao"

return

:ComponentOne
text
************************
* Component One
************************
- SN: SE40309-YC-100001, SE40309-LN-100000
endtext

gosub run "Component One\Studio Enterprise Q32003\C1StudioNet_Q303.msi"   
gosub run "Component One\Studio Enterprise Q32003\C1StudioAsp_Q303.msi"

echo Updating icons...
call MergeDir /q "%pp\ComponentOne Studio.NET" "%pp\Development\Other"
call MergeDir /q "%up\ComponentOne Studio.NET" "%pp\Development\Other"
call MergeDir /q "%pp\ComponentOne Studio ASP.NET" "%pp\Development\Other"
call MergeDir /q "%up\ComponentOne Studio ASP.NET" "%pp\Development\Other"

return

:DundasChart
text
************************
* Dundas Chart
************************
- ASP.NET: Username: john.butare@intel.com, Password: 043-170-134-181
- Windows Forms: Username:john.butare@intel.com, Password:046-160-137-023
endtext

gosub run "Dundas\Dundas Chart.NET Pro Edition V3.0\DCWCP30.exe"
gosub run "Dundas\Dundas Chart for Windows Forms V3.0\DCWFP30.exe"

echo Updating icons...
call MergeDir /q "%pp\Dundas Software" "%pp\Development\Other"
call MergeDir /q "%up\Dundas Software" "%pp\Development\Other"

return

:WebTrends
text
************************
* WebTrends
************************
- Don't enter license information during setup
- Set services to Manual if this machine is a backup WebTrends server
endtext

gosub run "NetIQ\WebTrends Reporting Center eBusiness V4.0c\setup.exe"

echo Updating icons...
call MergeDir /q "src=%pp\(directory name)" "%ao"

text
- Local Security Policy, grant IUIS System "Act as part of the operating system"
- Services, "WebTrends Reporting Center" and "WebTrends Reporting UI", run as IUIS System
- In c:\Program Files\WebTrends Reporting Center\wtm_wtx\datfiles\profiles
  remove unwanted profiles and copy new profiles from %SharedDocuments\Projects\WebTrends\Profiles
- (Re)start services
- Start WebTrends Reporting Center
  - Enter Product Serial Numbers: 40000BE-EGE-4H3g32rE-2ee000L
  - Login, don't put domain in for User Name  
  - Help, Product Links, Subscription/Add-ons, 40010z5-EGE-4H3g32X1-2dj000C
  - Configuration, User Access, add users as needed
  - Configuration, Options, General Options
    - Report Serving
      - Select Specigy a different web server for serving the reports
      - Report Directory - d:/Projects/WebTrends/%PROFILE%.wlp
      - Report URL Path - http://IuApp.Intel.Com/WebTrends/%PROFILE%.wlp/index.html.
        - Note: http://IuApp.Intel.Com/WebTrends should be setup as a virtual directory
          that is a share located on another computer, which points to the WebTrends
          computer, such as \\rrs3app002\d$\Projects\WebTrends.  It should be set to 
          Connect As IUIS System.
    - Reporting Method, select Pre-generated Reports      
    - Reports, check all Report Types, set all Report to Store to 1 Year or equivalent
    - Scheduler, Frequency - 2 hours
- Stop services if needed
endtext

return

:ProVision
text
************************
* ProVision
************************
endtext

gosub run "Proforma\ProVision\InstallProvision.exe"

copy %install\Proforma\License\pvwlicense.lic c:\PVLicServer\Licenses

text
- Note: If want to, EDM can host license server and possibly pool licenses (Russel Lambert)
- Run ProVision Floating License Server Utility.  On the Config Server tab,
  set Path to the lmgrd.exe file to C:\PVLicServer\lmgrd.exe.  Set Path to
  the license file to C:\PVLicServer\Licenses\pvwlicense.lic.  Click Save Service.
  On the Start/Stop/Reread tab click Start Server.
- Share C:\PVLicServer read only as "ProVision License".  Users can view licenses log
  at \\rrs3app002\ProVision License\pvlicServer.log
endtext
pause

return

:NortonAntiVirusCorporate
REM When uninstsalling:
REM - Remove "%programs32\Symantec AntiVirus"
REM - Remove "%AllUsersProfile\Application Data\Symantec"
REM - Autoruns, delete Startup\VPtray
text
- Mem usage ~32.5MB
- Client, Unmanaged
endtext

REM Intel
REM set RunOptions=none
REM set exe=Symantec\Norton AntiVirus V8.1 Corporate Edition\savce81825-32.EXE

gosub run "Symantec\Norton AntiVirus V10.0 Corporate Edition\SAV\Setup.exe"

echo Updating icons...
call CopyFile "%pp\Symantec Client Security\Symantec AntiVirus Client.lnk" "%pp\Operating System\AntiVirus.lnk"
call MergeDir /q "%pp\Symantec Client Security" "%pp\Operating System\Other"

gosub RunProg autoruns


text
- Symantec AntiVirus, Configure, File System Auto-Protect, Advanced, 
  - Auto-Protect will scan files that are Modified
- autoruns
  - Uncheck vptray (tray icon)
  - (Intel build) Uncheck RasC service and rascagnt - Intel Terminus Agent, since it does not recognize Norton AntiVirus as valid virus software, must run terminus manually.
- Notes
  - V8.X of NAV cannot report status to Windows Security Center
  - Can be installed on client or server, less disk overhead than McAfee
  - Uninstall password: symantec
  - Manual update at virusscan.(rr/sc).intel.com or http://securityresponse.symantec.com/avcenter/download.html.
endtrxt
pause

call DelDir "c:\CAPLOG"
call DelDir "c:\CAPTMP"

return

:Mirada
text
************************
* Mirada
************************
- Install to C:\Program Files\mirada
emdtext

gosub run "UNM\Mirada V5.0\Setup.exe"

echo Updating icons...
call DelFile "%pd\Mulberry CBT.lnk"
call DelFile "%pd\Using Mulberry at UNM.lnk"
call DelFile "%pd\Mirada Shortcut.lnk"
call MergeDir /q "%pp\Mirada" "%ao"
call MakeDir "%users\lluna\Desktop\Mirada"
call CopyDir "%ao\Mirada" "%dir"

return

:PerformanceTest
text
************************
* PerformanceTest
************************
- User: John Butare
- Key : 000H7V-5CUEEB-T4K4E4-1QHDW4-HV420Z-E29ARN-4JZZKX
endtext

gosub run "PassMark Software\Performance Test V6.0\petst.exe"

echo Updating icons...
call MergeDir /q "%pp\PerformanceTest" "%pp\Operating System\Other"

return

:MicrosoftDb2Drivers
REM This references an older version of the HIS which no longer works under VB6 with TESS
text
************************
* Microsoft DB2 Drivers
************************
- *** Install cannot be run from terminal server ***
- Seelct Features,  Data Integration
  - ODBC Driver for DB2
  - OLE DB Provider for DB2
endtext

gosub run "Microsoft\Host Integration Server\client V2002 SP1\HIClient.msi"
gosub run "Microsoft\Host Integration Server\client V2002 SP1\HIS2000-KB815012-All-ENU.EXE"

REM Encountered errors using linked server with SP2
REM gosub run "Microsoft\Host Integration Server\client V2002 SP2\HIClient.msi"

echo Updating icons...
call MergeDir /q "%pp\Host Integration Server End-User Client" "%pp\Operating System\Other"

return

:RUndelete
REM  http://www.r-undelete.com/Download.shtml 
text
************************
* r-undelete
************************
- Key V2.0: RAAALr/t9UOTiCdB4k5oCd/QvRUsq4aqfSkcf1NLnWDE8Zt0753JcQLlTCd8vdcRCPYwJZt04o6hnv01BpnGkXhDz9Vb
- Key V1.0: RAAAOoPpnSk7VWRRj6DSNWJRHu9fgNRJ7weuGLDNRmeQJF98TCcCwQnRNj9nzbWwPK7TrQkRFnTzpVyGQtwxKzCsX1MI
- Order ID: SCQVWPQMZCZP and CC first 4246/last 4362
- 2.0 does not appear work with ZIP disks, 1.0 does
endtext

gosub run "r-tools\r-undelete V1.0\ruu_en_10.exe"

echo Updating icons...
call MergeDir /q "%pp\R-UNDELETE" "%pp\Operating System\Other"

return

:BitPim
REM http://www.bitpim.org/#download
text
************************
* BitPim
************************
endtext

gosub run "Shareware\BitPim\bitpim-1.0.6-setup.exe"

REM Copy the standard C runtime library if it is not installed
iff "%@search[msvcp71.dll]" == "" then
	call CopyFile "%install\Shareware\BitPim\msvcp71.dll" "%programs32\BitPim"
endiff

echo Updating icons...
call MergeDir /q "%pp\BitPim" "%ao"

call ask `Configure default phone?` y
iff %? == 1 then

	echo Configure default phone...
	start /pgm "%programs32\BitPim\bitpimw.exe"
	pause

	echo Moving default phone directory...
	call MakeDir "%UserData\BitPim"
	call MoveEx "%UserDocuments\bitpim" "%UserData\BitPim\%@FullName[]"
	
	call MakeShortcut "%UserData\BitPim\%@FullName[]\.bitpim" "%pp\Applications\BitPim %@FullName[].lnk"
	
endiff


text
- Notes
  - Shift-Add to bypass conversion dialogs (which sometimes crash)
endtext

return

:FxCop
text
************************
* FxCop
************************
endtext

gosub run "Microsoft\.NET\FxCop\FxCopInstall1.35.MSI"

call CopyFile "%ExeDir\FxCop.chm" "%programs32\Microsoft FxCop 1.35"

echo Updating icons...
call MergeDir /q "%pp\Microsoft FxCop 1.35" "%pp\Development\Other"
call CopyFile "%pp\Development\Other\Microsoft FxCop 1.35\FxCop.lnk" "%pp\Development"

REM Update Geckos FxCop files
gosub GeckosUpdateFxCop

text 
- Visual Studio 2003
  - Tools, External Tools
    - Add
      - Title=FxCop
EndText
echo `      - Command=%programs32\Microsoft FxCop 1.30\FxCopCmd.exe`
Text
      - Arguments=/f:$(TargetPath) /c /p:"c:\Projects.NET\Common\FxCop\Geckos Rules.FxCop" /i:"c:\Projects.NET\Common\FxCop\Geckos.FxCop"
      - Check Use Output window
    - Add
      - Title=FxCop Geckos
EndText
echo `      - Command=%programs32\Microsoft FxCop 1.30\FxCop.exe`
text
      - Arguments="c:\Projects.NET\Common\FxCop\Geckos.FxCop"
    - Move command near the top of the External Commands list to position n 
  - (optional to put command on toolbar) Right click on toolbar, Customize, Commands, Tools
    - Drag External Command n to toolbar
    - Right click on External Command n, check Begin a Group.
- Ensure that the two FxCop files in $/Projects.NET/Common are up to date
- (optional) After running FxCop, double click on the Output window to expand it
endtext

return

:NDoc
text
************************
* NDoc
************************
- Un-check 1.0 framework
endtext

gosub run "Shareware\NDoc\NDoc-1.3-beta1a.msi"
gosub run "Microsoft\Visual Studio .NET Help Integration Kit\VSHIK2003.exe"
gosub run "The Helpware Group\H2Reg\h2reg_setup136.exe"

set NDocGui=%programs32\NDoc 1.3\bin\net\1.1\NDocGui.exe

echo Updating icons...

call MergeDir /q "%up\NDoc 1.3" "%pp\Development\Other"
call MergeDir /q "%pp\Helpware" "%pp\Development\Other"

call CopyFile "%pp\Development\Other\NDoc 1.3\Microsoft .NET 1.1\NDoc.lnk" "%pp\Development"

text 

- Visual Studio 2003, Tools, External Tools
  - Add
    - Title=NDoc
EndText
echo `    - Command=`%NDocGui
text
    - Move commands near the top of the External Commands list to position n 
  - (optional to put command on toolbar) Right click on toolbar, Customize, Commands, Tools
    - Drag External Command n to toolbar
    - Right click on External Command n, check Begin a Group.
- Ensure that the two FxCop files in $/Projects.NET/Common are up to date
endtext

return

:NAnt
text
************************
* NAnt - .NET build tool
************************
endtext

set InstallDir=%programs32\NAnt
gosub run "Shareware\.NET\NAnt\nant-0.85-20040812.zip"

REM Update the  path
call SetVar /s /p path "%InstallDir\bin"

echo Updating icons...
call MakeDir "%pp\Development\.NET\Other\NAnt"
call MakeShortcut "%InstallDir\doc\index.html" "%pp\Development\.NET\Other\NAnt Documentation.lnk"
call MakeShortcut "%InstallDir\doc\index.html" "%pp\Development\.NET\NAnt Documentation.lnk"

echo %@ClipW[%InstallDir\NAnt.exe] >& nul:
text
- Tools, External Tools
  - Add
    - Title=NAnt
    - Command=<paste>
      - Arguments=1.1 debug undeploy
      - Initial directory=$(SolutionDir)
      - Check Use Output window
      - Check Prompt for arguments 
    - Move command near the top of the External Commands list to position n 
  - (optional to put command on toolbar) Right click on toolbar, Customize, Commands, Tools
    - Drag External Command n to toolbar
    - Right click on External Command n, check Begin a Group.
- *** Additional required components ****
- Install Framework 1.0a to enable cross compilation to the .NET Framework 1.0
endtext
call VisualStudio

return

:SnippetCompiler
text
************************
* Snippet Compiler
************************
endtext

gosub run "Microsoft\.NET\SnippetCompiler"

echo Updating icons...
call MakeShortcut "%ProgramDir\SnippetCompiler.exe" "%pp\Development\Snippet Compiler.lnk"

return

:Regulator
text
************************
* Regulator
************************
endtext

gosub run "Microsoft\.NET\Regulator\RegulatorSetup.msi"

echo Updating icons...
call DelFile "%ud\The Regulator.lnk"
call MoveFile "%up\The Regulator.lnk" "%pp\Development\Regulator.lnk"

return

:Reflector
text
************************
* Reflector
************************
endtext

echo Updating icons...
call MakeShortcut "c:\Data\Bin\Reflector.exe" "%pp\Development\Reflector.lnk"

return

:DeviceCenter
REM Installs
REM - Services: RapiMgr, WcesComm
REM - Run: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Windows Mobile Device Center=%windir%\WindowsMobile\wmdc.exe
text
*************************************
* Windows Mobile Sync (Device Center)
*************************************
endtext

iff defined NewOs then
	gosub run "Microsoft\Mobile\Device Center\Mobile Device Center V6.1 %@OsArchitecture[].exe"
else
	gosub run "Microsoft\Mobile\Device Center\ActiveSync V4.2.exe"
endiff

echo Updating icons...
call MoveFile "%ud\Windows Mobile Device Center.lnk" "%pp\Applications"
call MoveFile "%pp\Windows Mobile Device Center.lnk" "%pp\Applications"
call MoveFile "%pp\Microsoft ActiveSync.lnk" "%pp\Applications\ActiveSync.lnk"

REM Delete H/PC Connection Agent - "C:\Program Files\Microsoft ActiveSync\WCESCOMM.EXE"
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\H/PC Connection Agent"
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\H/PC Connection Agent"


text
- Reference: "\\oversoul\John\Documents\Products\Microsoft\Pocket PC.doc"
- Place the PPC in the cradle
- Synchronize with this desktop computer, Next
- (primary PC)
  - Check only Contacts, Calendar, E-mail, Tasks, Notes
  - Double click Tasks, select Synchronize all tasks (otherwise, completed tasks in Outlook do not complete on PPC)
- (secondary PC) 
  - No, I want to synchronize with two computers (does not delete existing partnership), Next
  - Uncheck Calendar, Contacts, Inbox, Tasks, and Favorites (IMPORTANT: Favorites and Files must be unchecked, see notes above), Next, Finish.
- ActiveSync, Tools
  - Add/Remote Programs, uncheck Install program into the default installation folder
  - Options, Rules, uncheck Open ActiveSync when my mobile device connects
endtext

return

:eWallet
REM http://www.iliumsoft.com/site/support/kb/article.php?id=123
REM Issues: when running causes video to stutter
text
************************
* eWallet
************************
endtext

gosub run "Ilium Software\eWallet\eWallet v7.1.1.29661.exe"
gosub run "Ilium Software\eWallet\ewalletautopass.xpi"
gosub run "Ilium Software\eWallet\FlexWalletIconPack-WinMobile-PE-Setup.exe"

echo Updating icons...
call DelFile "%ud\eWallet.lnk"
call MergeDir /q "%pp\Ilium Software" "%ao"
call MergeDir /q "%up\Ilium Software" "%ao"

echo Moving data folder...
call MakeLink merge "%UserData\eWallet" hide "%UserDocuments\eWallet"

text
- File\Open..., Documents\data\eWallet\wallet.wlt
- Help, About eWallet, Register
- (optional) Synchronize, Setup
  - Copy remote wallet to local data\eWallet
  - Add... 
    - (PC) Another Computer
      - Location Name=Oversoul
      - Location Path=\\oversoul\John\Documents\data\eWallet
    - (iPod) eWallet, Synchronize (PC) Synchronize Add..., iPhone or iPod touch
  - Home, Setup, Options
    - Syncronize Wallet Files=Manually Only
    - Confirm each synchronization=Never
- (Android) 
  - Download and run eWallet from the Android store
  - phone USB, notifications, USB connection, USB connection=USB Mass Storage
  - eWallet, Setup, Add..., Android
- (iPod) Download from store
- (BlackBerry) BlackBerry Desktop Manager
  - Application Loader, Start, check eWallet
  - Synchronization, Add-ins, check eWallet Synchronizer, Configure
    - Add, Documents\data\eWallet\Wallet.wlt
    - Settings..., select Desktop overwrites BlackBerry, sync, select Full Sync
endtext
call eWallet.btm start

return

:DockWare
text
************************
* DockWare
************************
endtext

gosub run "Ilium Software\DockWare Pro V2.0\DockWareProPKTSetup.exe"

echo Updating icons...
PpcMoveLink "DockWare" "Applications"

text
- DockWare - may need to reset PPC
  - Display Options..., Clock=Digital Clock, Calendar=Long Date
  - Picture Options..., check Use Transitions, change picture after 5 seconds, Picture Order=Random,
    check Scale JPEG pictures to fit screen,  
  - Picture Folders..., check Include All Pictures from Memory Card=Storage Card
  - Date/Time Color..., 79, 255, 159
  - Setup..., check Automatically Start DockWare after Pocket PC is idle for 2 minutes
endtext

return

:PocketQuicken
text
************************
* PocketQuicken
************************
endtext

gosub run "LandWare\PocketQuicken V2.03\PocketQuickenPPC203_Install.exe"

echo Updating icons...
call MergeDir /q "%up\Pocket Quicken 2.0 for Pocket PC" "%ao"
call MergeDir /q "%up\Quicken" "%ao"
PpcMoveLink "Pocket Quicken" "Applications\Quicken.lnk"


text
- PPC
  - Start, Settings, Personal, Owner Information, Name=jbutare.  Note: Must keep owner name=jbutare.
  - Start Pocket Quicken, Activate, should display Owner Name=jbutare, User ID: 81184572, enter 
    registration code 199360 (was 11264334)
- ActiveSync, right click on Pocket Quicken, Settings..., select Upon each connection, synchornize once per day, 
  check Hide Pocket Quicken Connect when synchornizing
endtext

return

:AdobeReaderPpc
text
************************
* PPC Acrobat Reader
************************
- PPC installation dialog, Name=(Install Here)
endtext

gosub run "Install\Adobe\Acrobat Reader for Pocket PC V2.0\AdbeRdr20_ppc_enu.exe"

echo Updating icons...
PpcMoveLink "Acrobat Reader 1.0" "Applications\Acrobat.lnk"

return

:WindowsMobileDev
text
************************
* Windows Mobile Development
************************
SDK - Microsoft\Mobile\Development\en_windows_moblile_50_Dev_resource_kit.msi
PowerToys - Microsoft\Pocket PC\Development\WindowsMobilePowerToys V1.0.msi
PowerToyes EMU Configuration - Microsoft\Pocket PC\Development\EmuASConfig.msi
endtext

return

:Cygwin
REM http://www.cygwin.com/
text
********
* Cygwin
********
endtext

set CygwinHome=%programs\Cygwin

echo - install: util-linux, openssh, dialog
call cygwin.btm setup
if %? != 0 return %?

call FindPublicDoc data\install\Cygwin\setup
iff %_? == 0 then
	echo Copying files...
	call CopyFile "%file\Command Prompt.ico" "%CygwinHome\etc"

	echo Updating registry...
	call registry import "%file\setup %@OsArchitecture[].reg"
endiff

call ask `Do you want to update the path ?` y
iff %? == 1 then
	echo Updating path...
	
	call SetVar /system /path path "%CygwinHome\bin"
	call SetVar /system CYGWIN nodosfilewarning

	echo - Move Cygwin before data\bin directories
	call os.btm path editor
	pause
endiff

echo Updating icons...
call MakeShortcut "%CygwinHome\bin\mintty.exe" "%pp\Operating System\bash.lnk" /args "-" 
call DelFile "%pd/Cygwin64 Terminal.lnk"
call DelDir "%pp/Cygwin"

echo Cleaning up...
call DelFile.btm "%CygwinHome\Cygwin.bat"
call DelFile.btm "%CygwinHome\Cygwin.ico"
call DelFile.btm "%CygwinHome\Cygwin-Terminal.ico"

echo Modifying /etc/password...
echo - /users/... to /cygdrive/c/users/...	
pause

return

:Firefox
REM Released - https://www.mozilla.com/en-US/firefox/fx/?from=getfirefox
REM Minefield (trunk build) - http://www.mozilla.org/projects/minefield/
text
************************
* Firefox
************************
- Uncheck Use Firefox as my default web browser
- Don't import anything
- Close FireFox
endtext

REM call ask.btm `Install beta? ` n
set version=%@if[ 0 == 1 ,NA,18.0.1]
gosub run "Mozilla\Firefox\setup\Firefox Setup v%version%.exe"	

echo Updating icons...
call DelFile "%pd\Mozilla Firefox*.lnk"
call DelFile "%pp\Mozilla Firefox*.lnk"
call MergeDir /q /rename "%pp\Mozilla Firefox" "%ao\Firefox"

REM Pre-release icons
call MergeDir /q "%pp\Minefield" "%ao"
call DelFile "%pd\Minefield.lnk"

echo Restoring the default profile...
call firefox profile restore default

text
- Options
  - General, When Firefox starts Show my home page
  - Tabs
    - uncheck Warn me when closing multiple tabs
    - check Show tab previews in the Windows taskbar
  - Advanced
    - General
      - Check Search for text when I start typing
      - Check Use smooth scrolling
- about:config
  - network.automatic-ntlm-auth.trusted-uris=localhost,intel.com,goto
  - network.negotiate-auth.trusted-uris=intel.com
  - browser.sessionstore.resume_from_crash=true
- Tools, Options, Advanced, Encryption, View Certificates, Authorities, Import..., 
  data\certificate\public: Intel*, check Trust this CA to identify web sites
endtext
call firefox.btm start
pause

call ask.btm `Do you want to install extensions?` y
iff %? == 1 then
	call firefox.btm extension
	pause
endiff

echo Saving profile changes...
call firefox.btm profile backup

return

:RoboHelp
text
************************
* RoboHelp
************************
- SN RH011-QTZLSVRL (may be O)
endtext

return

:VMwareWorkstation
REM http://vmware.com/download/ws/
REM Services:
REM - VMAuthdService: run virtual machines as non-admin or in the background
text
************************
* VMware Workstation
************************
- Custom
  - Uncheck development environment plug-ins 
  - Workstation Server Component COnfiguration
    - Store shared VMs to=Public\Documents\data\VMware
    - HTTPS Port=444
- Uncheck Check for product updates on startup
endtext

gosub run "VMware\workstation\setup\VMware-workstation-full-9.0.2-1031769.exe"

echo Updating firewall...

REM When the guest uses NAT echo replies (ICMP type and code 0) must be allowed for ping to function on the guest
call firewall rule add "VMware NAT Echo Reply" `dir=in action=allow enable=yes profile=private,domain localip=any remoteip=any protocol=icmpv4:0,0 interfacetype=any edge=yes`

REM Disable the Visual Studio debugger as it can slow load time
call CopyFile "VMware\workstation\setup\Visual Studio Integrated Debugger.reg" "%programs32\VMware\VMware Workstation"
call vmware debugger disable

echo Creating VMware directory...
call MakeDir "%UserDocuments\data\VMware"

echo Updating icons...
call MergeDir /q "%pp\VMware" "%pp\Operating System\Other"
call DelFile "%pd\VMware Workstation.lnk"

REM echo VMware network configuration...
echo VMnet1 (host-only), VMnet8 (NAT)
echo   uncheck Connect a host virtual adapter to this network, Apply
call VMware network
pause

REM Services
iff  "%@ServiceState[SysMain]" != "STOPPED" then
	call ask `Disable SuperFetch (causes excessive disk utilization with virtual machines)?` y
	if %? == 1 call os DisableSuperFetch
endiff

text
- Edit, Preferences...
  - Workspace
    - Default location for virtual machines and teams=Documents\data\VMware
    - Check keep VMs running after workstation closes
  - Hotkeys, select Ctrl and Win only
  - Display
    - Uncheck Autofit Window
    - Check Autofit guest
    - Uncheck Show toolbar edge when unpinned in full screen
  - Memory, How much host RAM=12000 (Oversoul)
  - Priority
    - Input grabbed=High
    - Input ungrabbed=Low
    - (optional) Uncheck Take and restore snapshots in the background when possible
  - Devices, Uncheck Disable Autorun on the host when a VM is running
endtext
REM Start manually default location folder is not yet configured
start /pgm "%programs32\VMware\VMware Workstation\vmware.exe"
pause

return

:VMwarePlayer
text
************************
* VMware Player
************************
endtext

gosub run "VMware\player\VMware-player-2.0.4-93057.exe"

echo Updating icons...
call DelFile "%pd\(desktop file to delete).lnk"
call MergeDir /q "%pp\(directory name)" "%ao"


text
- (Display post-installation instructions)
endtext

return

:VMwareServer
REM Download - http://www.vmware.com/download/server/
REM For management, 1.x uses a GUI console, 2.x uses web console
text
************************
* VMware Server
************************
- If install fails, disabled installer verification and installer cache to 0
endtext

gosub run "VMware\server\setup\VMware-server-2.0.0-122956.exe"

echo Updating icons...
call MoveFile "%pd\VMware Server Home Page.lnk" "%pp\Operating System"
call MoveFile "%pd\VMware Server Console.lnk" "%pp\Operating System"
call MoveFile "%pd\VMware Virtual Machine Importer 2.lnk" "%pp\Operating System"

call MergeDir /q "%pp\VMware" "%pp\Operating System\Other"
call MergeDir /q "%up\VMware" "%pp\Operating System\Other"

iff %@IsWindowsClient[] == 1 then
  echo Updating firewall...
  call firewall rule add "VMware Server Console" `dir=in action=allow protocol=TCP localport=902 profile=private,domain program="%programs32%\VMware\VMware Server\vmware-authd.exe"`
  call service restart VMAuthdService
endiff


text
- VMware Server Console, Summary
  - Datastores, standard, Remove Datastore
  - Datastores, Add Datastore, C:\Documents and Settings\All Users\Documents\data\VMware
- VMWare Server Home Page, Continue to this website, Certificate Error, View certificates, Install Certificate...,
  Place all certificates in the following store, Trusted Root Certificate Authorities
endtext

return

:VMwareConsole
text
************************
* VMware Console
************************
endtext

gosub run "VMware\server\setup\VMware-console-1.0.2-39867.exe"
gosub run "VMware\server\setup\VMware-VmCOMAPI-1.0.2-39867.exe"

call MoveFile "%pd\VMware Server Console.lnk" "%pp\Operating System\Other"
call MergeDir /q "%up\VMware" "%pp\Operating System\Other"
call MergeDir /q "%pp\VMware" "%pp\Operating System\Other"

return

:VirtualServer
text
************************
* Virtual Server
************************
endtext

REM Reference: http://www.microsoft.com/technet/prodtechnol/virtualserver/2005/proddocs/vs_deploy_installCMD.mspx
set RunOptions=/q
gosub GetPid
gosub run "Microsoft\Virtual Server 2005\Virtual Server 2005 Install.msi"

echo Updating icons...
call MergeDir /q "%pp\Microsoft Virtual Server" "%pp\Development\Other"

return

:VirtualPC
text
************************
* VirtualPC
************************
endtext

gosub run "Microsoft\Virtual PC\en_virtual_pc_2007_x32.exe"

REM Set default VirtualMachine folder
iff "%UserDomain" == "AMR" then
  set MyVirtualMachines=%UserDocuments\data\vpc
else
  set MyVirtualMachines=%UserDocuments\data\vpc
endiff
setx MyVirtualMachines "%MyVirtualMachines"
call MakeDir "%MyVirtualMachines"

echo Updating icons...
call MoveFile "%pp\Microsoft Virtual PC.lnk" "%pp\Operating System\Virtual PC.lnk"


text
- Notes: Keyboard Shortcuts - Right Alt is the default host key.  Press right-Alt and
  - Right-Alt Enter - toggle full screeen
  - Right-Alt Move the mouse -  uncapture mount
  - Right-Alt Delete - Control-Alt-Delete - Enter - toggle full screeen
endtext

return

:SymbolServer
REM Reference
REM - Setup: http://msdn.microsoft.com/msdnmag/issues/02/06/Bugslayer/
REM - Symbol Download: http://www.microsoft.com/whdc/devtools/debugging/debugstart.mspx
text
************************************
* Symbol Server
************************************
- Add a symbols DNS entry for %ComputerName and disable strict LAN Manager name checking
endtext

iff "%@search[SymStore]" == "" then
	echo Debugging tools for windows is not installed.
	return 1
endiff

REM Initialize
set SymbolDir=%AllUsersProfile\Documents\data\symbols
echo %@ClipW[%SymbolDir] >& nul:

REM Create and compress symbol directory
call MakeDir "%SymbolDir"
iff %@wattrib["%SymbolDir",c] == 0 then
  echo Compressing symbols...
  call CompactDir "%SymbolDir"
endiff

echo Sharing symbol folder as symbols...
net share "symbols"="%SymbolDir" %NetShareOptions /Remark:"Symbol Server" >& nul:

gosub FindExe "Microsoft\debugging\symbols"
if %_? != 0 return %_?

set symbols=%exe

REM Windows 7 and Windows Server 2008 R2
set args=`/c:"symbols.exe /u %dest"`
gosub InstallSymbolPackage "Windows 7" "Build 7600 x86 free" en_windows_7_debugging_symbols_x86_398756.msi
gosub InstallSymbolPackage "Windows 7" "Build 7600 x64 free" en_windows_7_and_windows_server_2008_r2_debugging_symbols_x64_398754.msi

REM Windows Vista with SP1 and Windows Server 2008
set args=`/c:"symbols.exe /u %dest"`
gosub InstallSymbolPackage "Windows Longhorn" "Build 6001 x86 free" Windows_Longhorn.6001.080118-1840.x86fre.Symbols.exe
gosub InstallSymbolPackage "Windows Longhorn" "Build 6001 x64 free" Windows_Longhorn.6001.080118-1840.amd64fre.Symbols.exe

REM Windows Server 2003 with SP2
set args=`/u "%dest"`
gosub InstallSymbolPackage "Windows Server 2003" "Build 5.2.3790 x86 free" WindowsServer2003-KB933548-v1-x86-symbols-NRL-ENU.exe
gosub InstallSymbolPackage "Windows Server 2003" "Build 5.2.3790 x64 free" WindowsServer2003-KB933548-v1-x64-symbols-NRL-ENU.exe

REM Windows XP with SP3
set args=`/u "%dest"`
gosub InstallSymbolPackage "Windows XP" "Build 5.2.2600 x86 free" WindowsXP-KB936929-SP3-x86-symbols-update-ENU.exe

return

:InstallSymbolPackage [product version installer]

set prog=%symbols\%@UnQuote[%installer]
if not IsFile "%prog" return

set description=%@unquote[%product] %@unquote[%version]
call ask `Do you want to install symbols for %description?` y
if %? ==  0 return 1	

REM Ensure empty dest dir exists
set dest=%temp\symbols
call DelDir "%dest"
call MakeDir "%dest"

echo.
echo Installing symbols for %description...

"%prog" %args
SymStore add /r /f "%dest" /s "%SymbolDir" /t %@quote[%product] /v %@quote[%version]

call DelDir "%dest"

return

:SourceServer
REM Reference: http://msdn.microsoft.com/msdnmag/issues/06/08/usethesource/default.aspx
text
************************************
* Source Server
************************************
endtext

gosub FindExe "Microsoft\Source Server"
if %_? != 0 return %_?

REM Initialize
set SourceServerInstallDir=%exe
set SourceServerDir=%programs32\Source Server
set DebuggingToolsDir=%programs32\Debugging Tools for Windows
set VsDir=%programs32\Microsoft Visual Studio 8\Common7\IDE

REM If debugging tools for windows is installed update SourceServer files
iff exist "%programs32\Debugging Tools for Windows\sdk\srcsrv" then
  call CopyDir "%DebuggingToolsDir\sdk\srcsrv" "%SourceServerInstallDir"
  call CopyFile "%DebuggingToolsDir\srcsrv.dll" "%SourceServerInstallDir"
endiff

REM Do not set up the source server if VS is not installed
if not exist "%programs32\Microsoft Visual Studio 8\Common7\IDE" return 0

REM Update the VSS integration component
call CopyFile "%SourceServerInstallDir\srcsrv.dll" "%VsDir"
call CopyFile "%SourceServerInstallDir\SrcSrvTemplate.ini" "%VsDir\SrcSrv.ini"

call CopyDir "%SourceServerInstallDir" "%SourceServerDir"
call CopyFile "%SourceServerInstallDir\SrcSrvTemplate.ini" "%SourceServerDir\SrcSrv.ini"

call SetVar /s /p path "%SourceServerDir"

return

:DebuggingTools
REM Reference http://www.microsoft.com/whdc/devtools/debugging/debugstart.mspx
text
************************************
* Debugging Tools for Winodws
************************************
- Custom
  - (optional) Debug Transport Drivers (installs 1394DBG2.SYS)
endtext

gosub run "Microsoft\debugging\setup\dbg_%@OsArchitecture[]_6.9.3.113.msi"

echo Updating the path...
call SetVar /s /p path "%programs\Debugging Tools for Windows (%@OsArchitecture[])"

echo Updating icons...
call MergeDir /q "%pp\Debugging Tools for Windows (%@OsArchitecture[])" "%pp\Operating System\Other"

echo Initializing debuging symbol information...
call debugging symbols init

return

:MicrosoftMouse
:IntelliPoint
text
*******************
* Microsoft Mouse
*******************
- IntelliPoint is useful for battery level.
endtext

gosub run "Microsoft\IntelliPoint\IPx64_1033_7.10.344.0.exe"

echo Updating icons...

call DelFile "%pd\Microsoft Keyboard.lnk"
call MergeDir /q "%pp\Microsoft Keyboard" "%ao"

call DelFile "%pd\Microsoft Mouse.lnk"
call MergeDir /q "%pp\Microsoft Mouse" "%pp\Operating System\Other"

return

:RealVNC
REM editions - free, personal (P), and enterprise (E)
REM download - http://www.realvnc.com/products/download.html
REM Intel - \\Vmspfsfsch09\dev_rndaz\LicensedSoftware\VNC Enterprise Edition (vnc-E4_5_4-x86_x64_win32.exe)
text
****************************
* RealVNC
****************************
- Uncheck Start the VNC Server in Service-Mode
endtext

gosub ask 'Install Intel version?' n
if %? == 1 then
	gosub run "RealVNC\setup\vnc-E4_5_4-x86_x64_win32.exe"
else
	gosub run "RealVNC\setup\VNC-5.0.3-Windows.exe"
endiff

echo Updating icons...
call CopyFile "%pp\RealVNC\VNC Viewer\Run VNC Viewer.lnk" "%pp\Operating System\VNC.lnk"
call MergeDir /q "%pp\RealVNC" "%pp\Operating System\Other"

text
- Server, Options
  - Security
    - Select NT Logon Authentication
    - Check Allow Single Sign-On authentication
  - Inputs
    - Check Disable local inputs while server is in use
  - Desktop
    - Uncheck Remove wallpaper, Remote background pattern, and Disable user interface effects
    - Check When last client disconnects Lock workstation
- Viewer, Options
  - Colour, Colour level=Full
  - Scaling, Scale to Window Size
  - Misc
    - Check Allow dynamic desktop resizing
  - Load / Save, Defaults, Save
- Notes
  - Capabilities: Multi-platform support, allows viewing and control by multiple clients, free version has slower screen updates, other:
    - Works with high-color programs like VideoStudio (not possible with NetMeeting), 
    - The controlled machine can share applications using NetMeeting (not possible with Remote Desktop Connection)
  - Multiple displays are supported by scrolling in direction of other display.  If host has multiple displays 
    then scroll in direction of hosts other monitor does not scroll client.  Only scrolls in full screen
  - F8 context menu - Control-Alt-Delete, Full Screen, Minimize, Etc
  - Viewer does not  need to be installed, run VncViewer in bin
  - If Windows Firewall is installed, Allow exception for c:\Program Files\RealVNC\VNC4\winvnc4.exe
endtext

return

:vonage
text
************************
* Vonage Applicaitons
************************
endtext

gosub run "Vonage\setup\vonage-outlook-plugin-7.0.7.exe"
gosub run "Shareware\VDialer\vdialer_103.exe"

echo Updating icons...
call MergeDir /q "%pp\Vonage Contact Center" "%ao"

text
- File, Options, Add-Ins, VDialer, Add-in Options...
  - Username=XXX, Password=XXX, Lookup
  - Uncheck Show dialer form when making a call
endtext

return

:WindowsMobileReader
text
- You MUST install Micrsoft reader to the default directory.  Installs to \Windows
endtext

gosub run "Microsoft\Pocket PC\Reader V2.3\MSReaderPPCUSASetup.exe"

echo Updating icons...
PpcMoveLink "Microsoft Reader" "Applications\Reader.lnk"

text
- Reset device
endtext

return

:AmberPoint
REM WebService monitoring
text
************************
* AmberPoint
************************
endtext

gosub run "AmberPoint\AmberPointExpress(VS2005).exe"

return

:Infragistics
REM Intel has an unlimited license with this vendor.  Keys and installers at \\fmssqlrnd001.amr.corp.intel.com\software\infragistics 
text
************************************************
* Infragistics
************************************************
endtext

set p=Infragistics\NetAdvantage\setup\

gosub run "%p\NetAdvantage_ASPNET_20082_CLR35_Product.exe"
gosub run "%p\NetAdvantage_WinForms_20082_CLR20_Product.exe"
gosub run "%p\NetAdvantage_NET_20082_CLR35_Help.exe"

call ask `Do you want to install Infragistics toolbox items?` y
iff %? == 1 then
  echo Installing VisualStudio Toolbox...
  start /wait /pgm "%programs32\Infragistics\NetAdvantage 2006 Volume 2 CLR 2.0\Toolbox Utility\Infragistics.ToolboxUtility.exe" 6.2
endiff

echo Updating icons...
call MergeDir /q "%pp\Infragistics NetAdvantage 2006 Volume 2 CLR 2.0" "%pp\Development\Other"

return

:LogonStudio

REM LogonStudio requires fast user switching, which is not available in a domain.  
if "%UserDnsDomain" == "" return 1

iff defined NewOs then
	gosub run "StarDock\Setup\LogonStudioVista.exe"
else
	gosub run "StarDock\Setup\LogonStudio_public.exe"
else

REM Delete LogonStudio - "C:\Program Files\WinCustomize\LogonStudio\logonstudio.exe" /RANDOM
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\LogonStudio"

set SkinDir=%UserData\Stardock\Boot Skins
iff IsDir "%SkinDir" then
	call explorer "%SkinDir"
	pause
endiff

return

:StrokeIt
REM http://www.tcbmi.com/strokeit/
text
************************
* StrokeIt
************************
endtext

gosub run "Shareware\StrokeIt\setup\StrokeIt_0.9.7-Home-English.exe"

echo Updating icons...
call DelFile "%ud\StrokeIt.lnk"
call MergeDir /q "%up\StrokeIt" "%pp\Operating System\Other"

echo Updating registry...

REM Delete StrokeIt - C:\Users\jjbutare\AppData\Local\TCB Networks\StrokeIt\Bin\StrokeIt.exe
call registry 32 delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\StrokeIt"

echo Restoring the default profile...
call StrokeIt profile restore default

return


:AutoHotKey
:ahk
REM http://l.autohotkey.net/, http://www.autohotkey.com/download/
REM http://l.autohotkey.net/docs/AHKL_ChangeLog.htm
text
************************
* AutoHotKey
************************
- Express Installation
endtext

REM Close existing AutoHotKey instancnes to prevent file in use errors on upgrade
call AutoHotKey close

gosub run "AutoHotKey\setup\AutoHotkey v1.1.09.04.exe"

echo Updating icons...
call MergeDir /q "%pp\AutoHotKey" "%pp\Operating System\Other"

echo Updating registry...
call registry import "%install\AutoHotKey\setup\other\AutoHotkey-%@OsArchitecture[].reg"

iff not IsFile "%UserData\bin\keys.ahk" then
	copy /q "%PublicData\setup\keys.ahk" "%UserData\bin"
endiff

REM Start AutoHotKey non-elevated
call sudo /standard AutoHotKey.btm startup

return

:Nero
text
************************
* Nero
************************
- Install Nero without the Ask Toolbar
- Enter registered serial number
- Setup Type=Custom
- Uncheck Nero Home, InCD, Nero Mobile, Nero ShowTime
- Photos, Video, Music, Preview: Remove All
- Uncheck Configure Nero Scout on first usage (Nero Scout is a media indexer used by Nero Home)
endtext

REM gosub run "Ahead\Nero V7\Setup\Nero-7.5.1.1_eng.exe"
gosub run "Ahead\Nero V7\Setup\Nero-7.10.1.0_eng_update.exe"
gosub run "Ahead\Nero V7\Setup\Nero7_chm_eng.exe"

REM Documentation
echo Copying documentation...
set s=%ExeDir\doc
set d=%programs32\Nero\Nero 7
call CopyFile "%s\NeroBurningRom_Eng.chm" "%d\Core"
call CopyFile "%s\NeroRecode_Eng.chm" "%d\Nero Recode"

echo Updating icons...
call MoveFile "%pd\Nero StartSmart.lnk" "%pp\Applications"
call MoveFile "%pd\Nero Home.lnk" "%pp\Applications"
call MergeDir /q /rename "%pp\Nero 7 Ultra Edition" "%ao\Nero"

echo Updating registry...
call registry import "%Install\Ahead\Nero V7\Setup\Nero.reg"

REM Delete NeroFilterCheck - C:\\Program Files\\Common Files\\Ahead\\Lib\\NeroCheck.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\NeroFilterCheck"

REM Nero BackItUp Scheduler Application - "C:\Program Files\Ahead\Nero BackItUp\NBJ.exe"
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\NBJ"

REM BgMonitor_{79662E04-7C6C-4d9f-84C7-88D8A56B10AA} - "C:\Program Files\Common Files\Ahead\lib\NMBgMonitor.exe"
call registry.btm 32 delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\BgMonitor_{79662E04-7C6C-4d9f-84C7-88D8A56B10AA}"

echo Updating services...
call service manual NmIndexingService


text
- My Computer, Nero Scout, Options uncheck Enable Nero Scout
- (InCd) MyComputer, DVD Burner, Properties, InCd, Options, More, Preferences
  - General
    - Check Hide tray icon
    - Check Do not show 'Format complete' message
    - Check Enable the advanced options
  - Auto-Format
    - On blank disc insertion Open format dialog
- Recode, More, Options, General
  - Check If minimize, minimize to tray
  - Uncheck Offer to save detailed report after successful burn process  
- ShowTime, Preferences
  - General, Toolbar setting, Show All
  - Disc playback
    - Select Resume playback fromt the last scene
    - Uncheck Prompt user before playback resume
  - (unless causes playback error) Video, check Hardware Acceleration Enable
- Nero Burning ROM
	- File, Options
		- Compilation
			- Uncheck Start with new compilation
			- Uncheck Remember last used volume label
		- Expert Features
			- Check Do not eject the disc after burn is complete
	- Click the folder icon to switch the File Browser window off
- Notes
  - InCD: When formatting use UDF 2.01
	- Burning ROM
		- Use format DVD-ROM (UDF)
		- When burning
			- If DVD+-RW discs contain data you will be prompted to erase
			- Check Use multiple recorders, multi-select records to use
		- Alcohol 52%: View, Options, Emulation, Uncheck Ignore Media Type 
			- Required for for DVD+-RW to write/erase properly
		- Recorder, Disc Info, media type and Book Type (reported media type) is displayed
			- If Alcohol 52% is installed and Ignore Media Type is checked, media and book type for DVD+RW media
				will be reported as DVD-ROM instead of DVD+RW, and write/erase operations will fail
		- Benchmark: 9m21s to format and record 1761MB at 2.4x (3,324 KB/s)
endtext

return

:ConnectedNetworkBackup
text
**************************
* Connected Network Backup
**************************
- Account number and encryption key in wallet
- Use cnb to initiate backup or restore
- Reference: http://Clientbackup.intel.com
endtext

gosub RunExe "\\RRSCNB100\tlm_install\ReInstall.exe"
gosub run "Intel\Connected Network Backup\File Exclusion Tool\Setup.Exe"

echo Updating services...
call service manual ConnectedLauncher
call service manual CBRegCap

echo Updating icons...
call DelFile "%up\Startup\Connected TaskBar Icon.LNK"
call DelFile "%up\Connected TLM.LNK"
call MakeShortcut cnb.btm "%pp\Operating System\Intel Backup.lnk"

text
- Manually, set Operating System\Intel Backup.lnk icon to C:\Program Files\Connected\COBackup.exe
- Note: After running a backup, manually close the CNB system tray icon
endtext

return

:DaemonTools
REM Note: Installs the dtscsi driver, which must be manuall removed (service delete dtsci, del %WinDir\system32\drivers\dtscsi.sys)
text
************************
* Daemon Tools
************************
- Begin installation, reboot, uncheck DAEMON Tools Search Bar
endtext

gosub run "Shareware\Daemon Tools\setup\daemon403-%@OsArchitecture[].exe"

echo Updating icons...
call DelFile "%pd\DAEMON Tools.lnk"
call MergeDir /q "%pp\DAEMON Tools" "%pp\Operating System\Other"

text
- Virtual CD/DVD-ROM, Set number of devices..., 2 drives
- Options, uncheck Secure Mode
endtext
pause

call MountVolToDev


text
- Rename new drives iso1 and iso2
- Note: Use iso to mount and unmount images
endtext

return

:MaxiVista
REM Uninstall requires manually deletion of video drivers: service delate maxivista&maxivistb&maxivistc, del %WinDir\system32\drivers\maxi*.sys
text
************************
* MaxiVista
************************
- For an upgrade, uninstall your existing installation and reboot (very important!!!)
- Two extended Displays
- When setup finishes click OK to run MaxiVista (to create viewers)
endtext

REM gosub run "MaxiVista\MaxiVista V3.0.29.exe"
gosub run "MaxiVista\MaxiVista v4 Beta\Maxivista_Setup_PrimaryPC_%@OsArchitecture[].exe"

echo Updating icons...
call DelFile "%up\Startup\MaxiVista MirrorPro Server All.lnk"
call DelFile "%ud\MaxiVista MirrorPro Server.lnk"
call MergeDir /q "%pp\MaxiVista MirrorPro Server" "%pp\Operating System\Other"
call MergeDir /q "%up\MaxiVista MirrorPro Server" "%pp\Operating System\Other"

call MergeDir /q "%up\MaxiVista Demo Server" "%pp\Operating System\Other"
call DelFile "%ud\MaxiVista Demo Server All.lnk"

call DelFile "%ud\MaxiVista MirrorPro Server All.lnk"
set dest=%PublicDocuments\Data\Bin
call MoveFile "%ud\MaxiVistaViewerA.exe" "%dest"
call MoveFile "%ud\MaxiVistaViewerB.exe" "%dest"
call MoveFile "%ud\MaxiVistaViewerC.exe" "%dest"

echo Updating registry...
set p=HKCU\Software\MaxiVista
if %@RegExist[%p\A3] == 1 call registry.btm 32 set "%p\A3\%UserName\lock_method" REG_DWORD 1
if %@RegExist[%p\B3] == 1 call registry.btm 32 set "%p\B3\%UserName\lock_method" REG_DWORD 1
if %@RegExist[%p\C3] == 1 call registry.btm 32 set "%p\C3\%UserName\lock_method" REG_DWORD 1

text
- (for each viewer) Select appropriate display for viewer
- Options..., Hotkeys, Toggle remote control mode=F6 (A), F7 (B), F8 (C)
endtext

return

:BaselineSecurityAnalyzer
text
****************************
* Baseline Security Analyzer
****************************
- Install on primary computer and check others over network
endtext

gosub run "Microsoft\Baseline Security Analyzer\MBSASetup-EN.msi"

echo Updating icons...
call MoveFile "%pp\Microsoft Baseline Security Analyzer.lnk" "pp\Operating System"

return

:UltraMon
REM http://www.realtimesoft.com/ultramon/download.asp
text
************************
* UltraMon
************************
- Check only Profiles and Shortcuts
endtext

REM New version requires updating reg file
set version=3.1.0

gosub run "UltraMon\setup\UltraMon_%version%_en_%@OsArchitecture[].msi"

echo Stopping UltraMon...
call UltraMon.btm stop

echo Updating icons...
call MoveFile "%pp\UltraMon.lnk" "%pp\Operating System"
call DelFile "%pp\Startup\UltraMon.lnk"

echo Registry settings...

REM Delete UltraMon - "C:\Program Files\UltraMon\UltraMon.exe" /auto
call registry.btm delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\UltraMon"

call registry.btm import "%install\UltraMon\setup\UltraMon.reg"

set r=HKCU\Software\Realtime Soft\UltraMon\%version
call registry.btm 32 set "%r\Wallpaper\Image Directory" REG_SZ %@PublicPictures[]

REM UltraMon.scr conflicts with UltraMon name, so rename the screen saver
iff exist "%WinDir\UltraMon.scr" then
	move /q "%WinDir\UltraMon.scr" "%WinDir\UltraMonSs.scr"
endiff

REM Create the destination profile directory
call MakeDir "%UserData\UltraMon\profiles"

REM Remove the  existing profile directory  if it is not a link
iff %@IsLink["%AppData\Realtime Soft\UltraMon\%version\Profiles"] == 0 then
	call DelDir.btm "%AppData\Realtime Soft\UltraMon\%version\Profiles"
	iff %? != 0 then
		EchoErr Unable to delete the existing profile directory.
		return 1
	endiff
endiff

REM Link the UltraMon Profile directory
linkd "%AppData\Realtime Soft\UltraMon\%version\Profiles" "%UserData\UltraMon\profiles" 

return

:IntelSpeedDialer
REM ISS Product 10862 (was 11963)
text
************************************************
* Intel Speed Dialer
************************************************
endtext

text
Intel\Calendar\Intel Speed Dialer\v2.0.2.0:
- copy contents to "C:\Program Files (x86)\IntelSpeedDial"
- run "C:\Program Files (x86)\IntelSpeedDial\OutlookAddin\setup.exe"
endtext
pause

return

:IntelBridgePlugIn
REM ISS Product 9268 (was 8245), http://iss.intel.com/ProductInfo/TabProductInfo.asp?Product=9268&CanInstall=0
text
************************************************
* Intel Bridge PlugIn
************************************************
endtext

call outlook.btm close

gosub run "Intel\BridgePlugIn\BridgePlugInSetup.msi" OfficePlugin32
if %_? != 0 return %_?

text
- Tools, Trust Center..., Add-ins, Go..., check Reservationless Conferecing and wait for prompt
- Reservationless Settings
  - Dial-in number(s): 916-356-2663, 8-356-2663  
  - Bridge Label=B:
  - Paascode Label=P:
- Note: When starting Outlook this addin contacts OCSP.SFO1.VERISIGN.COM, an invalid DNS. 
  The IE proxy must be configured correctly otherwise slow Outlook startup.
endtext
call outlook.btm start
pause

return

:CiscoIpCommunicator
REM ISS product 9959 (was 9667)
text
************************************************
* Intel Cisco IP Communicator
************************************************
endtext

gosub run "Cisco\IP Communicator\Cisco IP Communicator v7.0.6.0.exe"

echo Updating icons...
call MergeDir /q "%pp\Cisco IP Communicator" "%ao"
call DelFile.btm "%pd\Cisco IP Communicator.lnk"

text
- Ensure connected to the Intel network
- (to show all audio devices in Cisco IP Communicator) Sound
  - Disable unused devices
  - Playback and Recoding, Bluetooth, Set as Default Communications Device
- Skins, Compact Mode
- Always on Top
- Preferences...
  - Audio
    - Headet=Bluetooth Hands-free Audio
    - Speakerphone=Handset=Ringer=Default WIndows Audio Device
    - Advanced, Mode=Handset,Headset, Noise Suppression, uncheck Enabled
  - Network (greyed out if not running as administrator)
    - Use this Device Name=<desk device name, PO559110539533>
    - TFP Server: 10.194.191.5, 10.194.63.3
  - Display
endtext
call CiscoIpCommunicator start
call os sound
return

return

:Lync
REM - Lync - http://cse.intel.com/lyncpackage.htm, \\fmsmadenti001\cse\public\LYNC\RTM\Client
:lync

gosub run "Microsoft\Lync\client\LyncSetup%@OsBits[].exe"

echo Updating icons...
call MergeDir /q /r "%pp\Microsoft Lync" "%ao\Office\Lync"

echo Updating registry...

set r=HKEY_CURRENT_USER\Software\Microsoft\Communicator
call registry set "%r\AutoRunWhenLogonToWindows" REG_DWORD 0 >& nul:

text
- Personal, uncheck Automatically start Lync when I log on to Windows
endtext

return

:AnyDVD
REM Installs drivers AnyDVD and ElbyCDIO
text
************************
* AnyDVD
************************
endtext

gosub run "SlySoft\AnyDVD\SetupAnyDVD7210.exe"

echo Updating registry...
TaskEnd /f AnyDvd >& nul:

REM License must be added to the x86 registry key
call registry 32 import "%install\SlySoft\AnyDVD\Key.AnyDVDHD.reg"

REM Delete AnyDVD - C:\Program Files\SlySoft\AnyDVD\AnyDVD.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\AnyDVD"

echo Updating icons...
call MergeDir /q "%pp\SlySoft" "%ao"
call DelFile "%pd\AnyDVD.lnk"
call DelDir "%ud\AnyDVDHD"
call DelFile "%ao\SlySoft\AnyDVD\AnyDVD History.lnk"
call DelFile "%ao\SlySoft\AnyDVD\Register AnyDVD.lnk"
call DelFile "%ao\SlySoft\AnyDVD\Uninstall.lnk"

text
- Drives, Selection, uncheck virtual drives
- Program Settings, Uncheck AutoStart
endtext

return


:CloneDVD
text
************************
* CloneDVD
************************
endtext

gosub run "SlySoft\CloneDVD\SetupCloneDVD2930Slysoft.exe"
gosub run "SlySoft\CloneDVD Mobile\SetupCloneDVDmobile1901.exe"

echo Updating registry...

REM License must be added to the x86 registry key
call registry 32 import "%install\SlySoft\CloneDVD\Key.CloneDVD.reg"
call registry 32 import "%install\SlySoft\CloneDVD Mobile\Key.CloneDVDmobile.reg"

echo Updating icons...
call MergeDir /q /rename "%pp\Elaborate Bytes" "%ao\SlySoft"
call MergeDir /q "%pp\SlySoft" "%ao"
call DelFile "%ao\SlySoft\CloneDVD2\CloneDVD2 Revision History.lnk"
call DelFile "%ao\SlySoft\CloneDVD2\Register CloneDVD2.lnk"
call DelFile "%ao\SlySoft\CloneDVD2\Uninstall.lnk"
call DelFile "%pp\CloneDVDmobile.lnk"
call DelFile "%pd\CloneDVD2.lnk"
call DelFile "%pd\CloneDVDmobile.lnk"


return

:GoogleEarth
text
************************
* Google Earth
************************
endtext

gosub run "Google\Earth\GoogleEarthWin.exe"

echo Updating icons...
call MergeDir /q "%pp\Google Earth" "%ao"
call MoveFile "%pd\Google Earth.lnk" "%pp\Applications"

echo - Note: Save files are in %CloudData\Google Earth

return

:GoogleDesktop
REM Update - "C:\Users\jjbutare\AppData\Local\Google\Update\GoogleUpdate.exe" /c
text
************************
* Google Desktop
************************
- Choose Desktop Features, uncheck all
endtext

gosub run "Google\Desktop\GoogleDesktopSetup.exe"
gosub run "Google\Desktop\TweakGDS_Setup.exe"

REM Google Desktop Search - "C:\Program Files\Google\Google Desktop Search\GoogleDesktop.exe" /startup
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Google Desktop Search"

echo Updating icons...
call MoveFile "%pd\Google Desktop.lnk" "%pp\Applications"
call MergeDir /q "%pp\Google Desktop" "%ao"

text
Adding additional index locations
- (explorer) Computer, Add a Network Location
- (TweakGDS) Indexing, quit GDS, Add..., restart GDS
endtext
call os computer
start /pgm "%programs32\PodSync.com\TweakGDS\TweakGDS.exe"
pause


text
- Preferences
  - Desktop Search, Number of Results Display 100 results per page in the browser
  - Display
    - Quick Find, Display 10 Quick Find results
		- Display Mode, None
- Notes
  - Auto-hide, close, or move dock to another monitor as needed
  - Ctrl-Ctrl to open a search dialog on the active window
endtext
pause

echo Updating icons...
call MoveFile "%ud\TweakGDS.lnk" "%pp\Operating System"

return

:FeedDemon
text
************************
* FeedDemon
************************
- Import an OPML file or URL, Documents\data\FeedDemon\*.opml
endtext

gosub run "Intel\FeedDemon\FeedDemonIntel.exe"

echo Updating icons...
call MergeDir /q "%pp\FeedDemon" "%ao"

text
- Options, System Tray
  - Show FeedDemon in system tray=When minimized
  - Check Minimize to system tray instead of closing
  - When new items are received, show desktop alert=Never
endtext

return

:ZoneTick
REM Reference: http://sdtoday.intel.com/Show.aspx?FromTab=home&AID=304 (iss 7710)
text
************************
* ZoneTick
************************
endtext

gosub run "WR Consulting\ZoneTick\anuko_world_clock_full_setup.exe"

echo Restoring the default profile...
call ZoneTick.btm profile restore default

echo Updating icons...
call MergeDir /q "%pp\ZoneTick" "%ao"

return

:Audacity
REM http://audacity.sourceforge.net/
text
************************
* Audacity
************************
endtext

gosub run "Shareware\Audacity\audacity-win-unicode-1.3.12.exe"
gosub run "Shareware\Audacity\LADSPA_plugins-win-0.4.15.exe"

echo Updating icons...
call MakeDir "%pp\Media\Other"
call DelFile "%ud\Audacity 1.3 Beta (Unicode).lnk"
call MoveFile "%pp\Audacity 1.3 Beta (Unicode).lnk" "%pp\Media"


text
- Edit, Preferences...
  - Devices, Recording Device=nnn
  - Libraries, MP3 Library Version, Locate..., Public\Documents\data\bin\lame_enc.dll
endtext

return

:FileTransferManager
REM Reference: http://transfers.ds.microsoft.com/FTM/ or http://transfers.ds.microsoft.com/ftm/default.aspx?target=install
text
************************
* File Transer Manager
************************
endtext

gosub run "Microsoft\File Transfer Manager\FTMSetup.msi"

echo Updating icons...
call DelFile "%pp\File Transfer Manager.lnk"
call DelFile "%ud\File Transfer Manager.lnk" 

call MakeShortcut "%programs32\Microsoft File Transfer Manager\TransferMgr.exe" ^
	"%pp\Operating System\File Transfer Manager.lnk"


text
- Options..., 
	- General, Files received will be placed in this folder=\Documents\data\download
	- Performance, Maximum Concurrent Transfer=4
endtext

return

:InternetExplorer
:ie
REM http://www.microsoft.com/windows/ie/default.mspx
REM http://www.microsoft.com/downloads/en/details.aspx?FamilyID=62E67358-DA9A-499D-AA19-EB93996CA8E0
text
************************
* InternetExplorer
************************
endtext

gosub run "Microsoft\Internet Explorer\setup\IE10-Windows%_WinVer%-%@OsArchitecture[]-en-us.exe"

echo Update registry...

REM Number of simultaneous requests allowed to a single HTTP server for HTTP 1.0 and 1.1 protocols.  Defaults are 2 and 4.
REM Reference: http://support.microsoft.com/kb/282402
call registry.btm 32 set "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\MaxConnectionsPer1_0Server" REG_DWORD 10
call registry.btm 32 set "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\MaxConnectionsPerServer" REG_DWORD 10

echo Updating favorites...
call DelFile "%UserProfile\Favorites\Links\Customize Links.url"
call DelFile "%UserProfile\Favorites\Links\Free Hotmail.url"
call DelFile "%UserProfile\Favorites\Links\Windows Media.url"
call DelFile "%UserProfile\Favorites\Links\Windows.url"

echo Installing extensions...
REM gosub XMarks
REM gosub CoolIris

echo Updating icons...
if not defined server call DelFile "%up\Internet Explorer.lnk"
call MoveFile "%up\Internet Explorer.lnk" "%ao"
call MoveFile "%up\Internet Explorer (64-bit).lnk" "%ao"
call MergeDir /q "%up\Accessories" "%pp\Applications"

text
- Search (Hourglass), Search Providers, Google, Wikipedia Visual Search
- Tools, Internet Options...
  - (workgroup) Security, Local intranet, Sites,
    uncheck Automatically detect intranet network, check rest
  - Advanced
    - (development)
       - Uncheck Disable script debugging (both)
       - Check Display a notification about every script error
    - Security, check Allow active content to run in files on My Computer
- Notes
  - Press the CTRL key while clicking links, or use the middle mouse button. 
  - Click any tab with the middle mouse button to close it. 
  - Press ALT+ENTER from the address bar or search box to open the result in a new tab. 
endtext
call InternetExplorer start
pause

return

:Cooliris

gosub run "Microsoft\Internet Explorer\extension\cooliris-win-iefull-release-1.11.6.31225.en-US.msi"

echo Updating icons...
call MergeDir /q "%up\Cooliris" "%ao"
call DelFile "%ud\Launch Cooliris.lnk"

return

:XMarks

gosub run "LastPass\setup\xmarks-installer-for-ie-1.3.4.msi"

echo Updating icons...
call MergeDir /q "%up\Xmarks" "%ao"

echo Updating registry...

REM Delete Xmarks - C:\Program Files (x86)\Foxmarks\IE Extension\foxmarkssync.exe -q
call registry.btm delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Xmarks"

return

:BrowserHomePage

set HomePageFile=%UserData\replicate\default.htm
set HomePageUrl=file:///%HomePageFile
if not IsFile "%HomePageFile" return 1

echo Setting Internet Explorer home page...
echo - Tools, Internet Options, Use Current
call InternetExplorer.btm "%HomePageUrl"
pause

iff %@IsInstalled[firefox] == 1 then
	echo Setting Firefox home page...
	echo - Close other tabs
	echo - Tools, Options, Main, Use Current Page
	call firefox.btm "%HomePageUrl"
	pause
endiff

call chrome "%HomePageUrl"

return

:OracleDrivers
REM Reference - http://istg.intel.com/EPS/KTBR/KTBR_HR/dba/GENItools.htm
text
************************
* Oracle Database Drivers
************************
- TODO: test install to c:\Program Files\OraHome, write down config: OraHome, etc, check and doc OraHome location in subsequent installs, ensure only c:\Oracle, ensure ping test successful
- Disable McAfee OnAccess scan
- Install Runtime components (160MB)
- Net Service configuration
- Installer, install from
  - Oracle\ODBC Drivers ora92054\Disk1\stage\products.jar
- Usage (move to document)
  - PL/SQL Developer
    - Tools, Find Database Objects, Owner=SYSADM, Name=%<text>% (% is wildcard)  
endtext

gosub run "Intel\dbConnector for Oracle V9.2.0.6\9201\install\win32\setup.exe"
gosub run "Intel\dbConnector for Oracle V9.2.0.6\9206\install\setup.exe"
gosub run "Allround Automations\PL SQL Developer V6.0.5.931\Setup.exe"

REM Copy configuration files
set dir=c:\oracle\ora92\network\admin
call CopyFile "%SetupFiles\tnsnames.ora" "%dir"
call CopyFile "%SetupFiles\sqlnet.ora" "%dir"

REM Test
echo Testing connection to production GENI server...
C:\oracle\ora92\bin\TNSPING.EXE geni8
echo If the tnsping fails with an error "No message file for product=NETWORK", re-run the initial setup.
pause

echo Updating icons...

call MakeDir "%pp\Development\Other\Oracle"
call MergeDir /q "%pp\Oracle - OraHome92" "%pp\Development\Other\Oracle"
call MergeDir /q "%pp\Oracle Installation Products" "%pp\Development\Other\Oracle"

call MergeDir /q "%up\PLSQL Developer" "%pp\Development\Other"
call MoveFile "%ud\PLSQL Developer.lnk" "%pp\Development"

gosub RunProg odbcad32.exe


text
- System DSN, Add..., 
  - Oracle in OraHome92, Finish, Data Source Name=Geni, TNS Service Name=Geni8, User ID=sysuser, Test Connection
endtext

:Expression
REM http://www.microsoft.com/expression/products/StudioUltimate_Overview.aspx
text
************************
* Expression
************************
endtext

set p=Microsoft\Expression

call ask `Install Expression 4 (requires activation)?` n
iff %? == 1 then
	gosub run "%p\setup\en_expression_studio_4_ultimate_x86_dvd_537032.iso"
	gosub run "%p\update\Web 4 SP1.exe"
	gosub run "%p\update\Blend 4 SP1.exe"
	gosub run "%p\update\Encoder 4 SP1.exe"
else
	gosub run "%p\setup\en_expression_studio_3_x86_dvd_401336.iso"
	gosub run "%p\update\en_expression_web_3_sp2.exe"
endiff

echo Moving Web Sites directory...
call MergeDir /rename "%UserDocuments\Web Sites" "%UserDocuments\code\web\sites"
call MakeDir "%UserDocuments\code\web\sites"
attrib /q /d -s -h "%UserDocuments\code\web\sites"

echo Updating icons...
gosub ExpressionIcons

echo Cleanup...
call DelDir ask "%UserDocuments\Expression"

echo Configure Expression Encoder...
text
<PrimitiveObject Name="LastDirectory_Import">%UserDocuments\media\convert</PrimitiveObject>
<PrimitiveObject Name="LastDirectory_Job">%UserDocuments\media\convert\jobs</PrimitiveObject>
endtext
call expression encoder config
pause

return

:ExpressionIcons

set p=%pp\Development\Other\Expression
call MergeDir /q /rename "%pp\Microsoft Expression" "%p"
call MergeDir /q /rename "%ud\Expression" "%ud\code\web"
call MergeDir /q /rename "%p\Microsoft Expression Blend SDK" "%p\Expression Blend SDK"
call MoveFile "%ud\Expression\Expression Design\Samples 2.lnk" "%p\Design Samples.lnk"
call MoveFile "%p\Microsoft Expression Encoder 4 Screen Capture.lnk" "%p\Expression Encoder Screen Capture.lnk"
call MoveFile "%p\Microsoft Expression Encoder 4 SDK.lnk" "%p\Expression Encoder SDK.lnk"
call MoveFile "%p\Microsoft Expression Web 4 SuperPreview.lnk" "%p\Expression Web SuperPreview.lnk"

pushd "%p"
for file in ("Microsoft Expression*4.lnk") call MoveFile "%file" "%@left[-6,%@right[-10,%file]].lnk"
popd

call MergeDir /q /rename "%pp\Microsoft Office" "%ao\Office"
gosub SilverlightIcons

return

:Alcohol52
REM Installs
REM - SPTD (SCIS Pass Through) Device service if AnyDVD is not installed.  The SPTD driver requires manual uninstall.
REM - StarWind iSCSI Service (StarWindService)  provides network drive sharing (optional)
REM Note
REM - Requires a reboot to install the SPTD driver, then run the install again
text
************************
* Alcohol 52%
************************
endtext

gosub run "Alcohol Software\Alchohol 52\Alcohol52_retail_1.9.6.5429.exe"

echo Updating icons...
call DelFile "%pd\Alcohol 52?.lnk"
call MergeDir /e "%pp\Alcohol 52`%%`" "%pp\Operating System\Other"

echo Updating services...
call service manual StarWindService
call service manual StarWindServiceAE


text
- View, Options
	- Virtual Drive
		- Number of Virtual Drivers=2
		- Uncheck Remount images upon system reboot
		- Drive Letter
      - Device 0=F:
      - Device 1=G:
    - Shell Extension, Select iso or Select all
  - Emulation
    - Uncheck Ignore Media Type (for DVD+-RW to write/erase properly in Nero)
endtext
pause

gosub LabelIso

return

:Delphi
REM Updates - http://info.borland.com/devsupport/delphi/downloads/
text
************************
* Delphi
************************
endtext

call ask `Do you want to run install.exe?`
iff %? == 1 then

  gosub FindExe "Borland\Delphi V5.0\INSTALL.EXE"
  if %_? != 0 return %_?

  REM Run exe from a share (error running from UNC)
  call UncConnect s: "%ExeDir"
  s:\install.exe
  pause

endiff

gosub run "Borland\Delphi V5.0 Enterprise Update Pack 1 Build 6.18\D5EntUpdate.exe"

echo Updating icons...
call MergeDir /q "%pp\(directory name)" "%ao"

return

:PowerShell
REM Reference http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx
text
************************
* PowerShell
************************
endtext

iff %_WinVer == 5.1 then
	gosub run "Microsoft\scripting\Power Shell\setup\PowerShell 1.0 for Windows %_WinVer %@OsArchitecture[].exe"
else
	gosub run "Microsoft\scripting\Power Shell\setup\PowerShell 1.0 for Windows %_WinVer %@OsArchitecture[].msu"
endiff
gosub run "Microsoft\Scripting\Power Shell\setup\PowerGUI.1.9.0.902.msi"

echo Updating icons...
call MergeDir /q /rename "%pp\Windows PowerShell 1.0" "%pp\Operating System\Other\PowerShell"
call MergeDir /q /rename "%pp\PowerGUI" "%pp\Operating System\Other"

return

:DynamicDnsCheck

REM Dynamic DNS  - if the host has a configuration file
iff exist "%install\Shareware\DNSer\config\%HostName.ini" then
  gosub DynamicDns
endiff

return %_?

:DynamicDns
REM Reference - http://members.dyndns.org
text
************************
* Dynamic DNS - DNSer
************************
endtext

gosub FindExe "Shareware\DNSer\Setup V2.0\DNSerSvc.exe"
if %_? != 0 return %_?

REM Copy / update the config file
set ConfigDir=%install\Shareware\DNSer\config

REM Use the template specific for this host
iff exist "%ConfigDir\%ComputerName.ini" then
  copy "%ConfigDir\%ComputerName.ini" "%WinDir\DNSerSvc.ini"

REM Use a default tempalte which registers the IP of the LAN adapter with the Dynamic DNS service
else
  copy "%ConfigDir\template.ini" "%WinDir\DNSerSvc.ini"
  echo %@IniWrite[%WinDir\DNSerSvc.ini,Source,Adapter,%@IpAdapterDescription[LAN]]
  echo %@IniWrite[%WinDir\DNSerSvc.ini,Srv1,URL,http://members.dyndns.org/nic/update?hostname=%ComputerName.podzone.net&myip=%s&system=dyndns&wildcard=NOCHG]
endiff

REM Copy the service
copy "%install\Shareware\DNSer\setup\DNSerSvc.exe" "%WinDir"

REM Install and start the service
"%WinDir\DNSerSvc" /install
net start DNSerSvc 

return

:nVidia
REM Driver: http://www.nvidia.com/Download/Find.aspx?lang=en-us
REM Scan: http://www.nvidia.com/Download/Scan.aspx?lang=en-us
REM System tools: http://www.nvidia.com/object/nvidia_system_tools_6.03.html
REM NTune: http://www.nvidia.com/object/sysutility.html
REM Installs:
REM Path: c:\Program Files (x86)\NVIDIA Corporation\Physx\Common
REM Service: 
REM - nvUpdatusService - NVIDIA Settings Update Manager, check for new updates
REM - Stereo Service - NVIDIA Stereoscopic 3D Driver Service (3D glasses)
REM - nvsvc - Provides system and desktop level support to the NVIDIA display driver
REM     Note: In 2010 on Oversoul the nVidia service changed the display settings to undesired settings, 2011 trying again
REM - nTuneService - display the Performance and System Stability sections of the NVIDIA control panel (clock and fan adjustment, etc).
text
************************
* nVideo Video Drivers
************************
endtext

iff defined NewOs then
	gosub run "nVidia\driver\320.18-desktop-win8-win7-winvista-%@OsBits[]bit-english-whql\setup.exe"
else
	gosub run "nVidia\driver\178.24_geforce_win%_WinVer%_%@OsBits[]bit_english_whql\setup.exe"
endiff

echo Updating services...
call service manual "Stereo Service"
call service manual "nvUpdatusService"

echo Updating icons...
call MergeDir /q "%pp\NVIDIA Corporation" "%pp\Operating System\Other"
call MoveFile "%ud\nTune.lnk" "%pp\Operating System\NVIDIA Corporation"
call MoveFile "%ud\NVIDIA Monitor.lnk" "%pp\Operating System\\NVIDIA Corporation"

call DelFile "%pd\NVIDIA System Monitor.lnk"
call DelFile "%pd\Performance.lnk"
call DelFile "%pd\Play Portal Now.lnk"
call DelFile "%pd\System Update.lnk"
call DelFile "%pd\3D Vision Photo Viewer.lnk"

text
- Tools, Calabration Screen, click monitor adjust button (right button on Dell monitor)
- NVIDIA Control Panel
  - 3D Settings, Set SLI and Physx configuration, SLI configuration=Maximize 3D performance
endtext

return

:SilverRun
REM \\vmsddedm800\Distribution SR RDM 2.8.4.4\SR-RDM2844-IntelCorporation.exe
REM \\FMEA1PUB006\SilverRun\documentarchive\installation\SilverRun2.8.2\SR-RDM282.exe
text
*************************
* SilverRun Data Modeling
*************************
- License Manager, check TCP\IP
endtext

gosub run "SilverRun\SR-RDM2844-IntelCorporation.exe"

echo Updating icons...
call MergeDir /q "%pp\(directory name)" "%ao"

call TextEdit "C:\Program Files\SILVERRUN-RDM 2.8.2\LSHOST"

text
- Validate that LSHOST contains one entry: FMSEDM801
endtext

return

:HarmonyRemote
REM http://www.logitech.com/en-us/440/6441?section=downloads&bit=&osid=14
text
************************
* Harmony Remote
************************
- Uncheck Install Logitech Desktop Messenger
- Plug in the harmony remote
endtext

gosub run "Logitech\Harmony Remote\LogitechHarmonyRemote7.7.0-WIN-x86.exe"

echo Updating icons...
call DelFile "%pp\Startup\Logitech Harmony Remote V7.lnk"
call DelFile "%pd\Logitech Harmony Remote Software 7.lnk"
call MergeDir /q "%pp\Logitech" "%ao"

return

:Python
REM http://www.python.org/download/, http://portablepython.com/
text
************************
* Python
************************
echo - Destination Directory=<paste>
endtext


echo %@ClipW[%programs32\Python27] >& nul:
gosub run "Shareware\Python\python-2.7-x86.msi"

echo %@ClipW[%programs64\Python27] >& nul:
gosub run "Shareware\Python\python-2.7-x64.msi"

echo Updating icons...
call MergeDir /q "%pp\Python 2.7" "%pp\Development\Other"

return

:Perl
REM http://www.cpan.org/src/5.0/
text
************************
* Perl
************************
endtext

gosub run "Shareware\perl\ActivePerl-5.8.8.817-MSWin32-%@OsArchitecture[]-257965.msi"

echo Updating icons...
call MergeDir /q "%pp\ActivePerl 5.8.8 Build 817" "%pp\Development\Other"

return

:MicrosoftReader
text
************************
* Microsoft Reader
************************
endtext

gosub run "Microsoft\Reader\MSReaderSetupUSA.exe"

echo Updating icons...
call DelFile "%pd\Microsoft Reader.lnk"
call MoveFile "%pp\Microsoft Reader.lnk" "%pp\Applications"

return

:MagicIso
REM http://www.magiciso.com/download.htm
text
************************
* MagicIso
************************
- MagicISO creates ISO images
endtext

gosub run "MagicDisc\Setup_MagicISO v5.5.281.exe"

call registry import "%install\MagicDisc\MagicISO Intel License.reg"

echo Updating icons...
call DelFile "%ud\MagicISO.lnk"
call MergeDir /q "%up\MagicISO" "%pp\Operating System\Other"
call MergeDir /q "%pp\MagicISO" "%pp\Operating System\Other"
call CopyFile "%pp\Operating System\Other\MagicISO\MagicISO.lnk" "%pp\Operating System"

return

:MagicDisc
text
************************
* MagicDisc
************************
- MagicDisc mounts ISO images
endtext

gosub run "Shareware\MagicDisc\setup_magicdisc74.exe"

echo Updating icons...
call DelFile "%ud\MagicDisc.lnk"
call DelFile "%up\Startup\MagicDisc.lnk"
call MergeDir /q "%up\MagicDisc" "%pp\Operating System\Other"
call CopyFile "%pp\Operating System\Other\MagicDisc\MagicDisc.lnk" "%pp\Operating System"

return

:SpeedFan
REM download http://www.almico.com/sfdownload.php
REM - giveio driver, c:\windows\system32\giveio.sys	
REM - speedfanSpeedFan Device Driver, Windows (R) 2000 DDK provider, c:\windows\system32\speedfan.sys	
text
************************
* SpeedFan
************************
endtext

gosub run "Shareware\SpeedFan\installspeedfan447.exe"

echo Updating icons...
call MoveFile "%ud\SpeedFan.lnk" "%pp\Operating System"
call MergeDir /q "%up\SpeedFan" "%pp\Operating System\Other"
call MergeDir /q "%pp\SpeedFan" "%pp\Operating System\Other"

text
- Readings, Configure, Options, check start minimized
endtext
call app SpeedFan
pause

return

:IsapiRewrite
text
************************
* ISAPI Rewrite
************************
- (Display pre-installation instructions)
endtext

gosub run "Shareware\ISAPI Rewrite\isapi_rwl_%@OsArchitecture[]_0065.msi"

echo Updating icons...
call MergeDir /q "%up\Helicon" "%pp\Development\Other"

return

:Trillian
REM http://www.trillianastra.com/
REM Download: http://www.ceruleanstudios.com/sneakpreview/trillian-v4.0a-current.exe, beta, beta
REM Build 75: http://blog.ceruleanstudios.com/?p=315
text
************************
* Trillian
************************
endtext

gosub run "Trillian\trillian-v4.0a-current.exe"

echo Updating icons...
set dest=%pp\Applications
call MoveFile "%up\startup\Trillian.lnk" "%dest"
call MoveFile "%ud\Trillian.lnk" "%dest"
call MoveFile "%up\Trillian.lnk" "%dest"

if not defined NewOs call os DisableMsnMessenger

call trillian profile restore default


text
- Preferences
  - Message Windows
    - Conveying Activity, uncheck Flash the window
    - When a new message window is created..., Select Hide the window and notify me
   - Notifications, Notification Windows, Notify me when, Check New messages arrive in a private session
  - Plugins, check AIM, ICQ, MSN
   - Advanced Preferences, Automation
      - Uncheck Hotkey: Ctrl-Shift-A (conflict with VisualStudio)
- Notes
  - Many settings are stored on the server
  - Secure IM: Trillian can secure (encrypt) IM traffice using ICQ or AIM.  To initiate
    a secure connection the contact must be online and in the contact list. 
endtext

return

:WindowsDesktopSearch
text
************************
* Windows Desktop Search
************************
endtext

if %@IsXp[] == 0 return

gosub run "Microsoft\Windows Desktop Search\WindowsDesktopSearch-KB917013-XP-%@OsArchitecture[]-enu.exe"

echo Updating icons...
call MoveFile "%pp\Windows Desktop Search.lnk" "%pp\Applications"

return

:RegCleaner
text
************************
* Registry Cleaner
************************
endtext

gosub run "Shareware\RegCleaner\RegCleaner.exe"

echo Updating icons...
call DelFile "%pd\TweakNow RegCleaner Std.lnk"
call MergeDir /q "%pp\TweakNow RegCleaner Std" "%pp\Operating System\Other"

return

:NotepadPP
:npp
REM Home - http://notepad-plus.sourceforge.net/uk/site.htm
REM Download - http://notepad-plus-plus.org/download/v6.1.2.html
REM Plugins 
REM   - http://superb-east.dl.sourceforge.net/sourceforge/npp-plugins/
REM   - http://sourceforge.net/apps/mediawiki/notepad-plus/index.php?title=Plugin_Central
REM XML Tools - http://sourceforge.net/project/showfiles.php?group_id=189927&package_id=264094
text
************************
* Notepad++
************************
- Uncheck Run Notepad++
endtext

gosub run "Shareware\Notepad++\setup\npp.6.4.5.Installer.exe"

set d=%install\Shareware\Notepad++

REM Delete existing plugs and install default
call ask `Do you want to delete current plugins and install the default plugins?` y
iff %? == 1 then
	echo Installing plugins...
	call DelDir contents "%programs32\Notepad++\plugins"
	call CopyDir "%d\plugins\default" "%programs32\Notepad++\plugins"
	call CopyFile "%d\plugins\XML Tools External Libraries\*" "%programs32\Notepad++"
	call CopyFile "%d\plugins\updater\*" "%programs32\Notepad++\updater"
	echo.
endiff

echo Installing auto-completion API's...
call CopyDir "%d\api" "%programs32\Notepad++\plugins\APIs"
echo.

echo Updating registry...
call registry import "%d\setup\NotepadPP.reg"

echo Restoring the default profile...
call notepadpp.btm profile restore default

echo Updating icons...
call DelFile "%ud\Notepad++.lnk"
call DelFile "%pd\Notepad++.lnk"
call MergeDir /q "%up\Notepad++" "%ao"
call MergeDir /q "%pp\Notepad++" "%ao"

REM Restart the AutoHotKey script so NotepadPP is recognized
call AutoHotKey.btm restart

text
- Settings, Preferences, MISC, uncheck Minimize to system tray
- Settings, Shortcut Mapper...,  Reload from Disk=Ctrl+R
- Explorer, Search=*.txt, Open with, Choose Default program...
  - Notepad++, check Always use the selected program to open this kind of file
- keyboard shortcuts 
  ctrl-n/w=new/close,  ctrl+/-=zoom
  [shift]ctrl-tab=switch, ctrl-shift-o=file switcher
  [alt]click drag=[block] select, ctrl-space=auto complete
endtext
call notepadpp.btm
pause

return

:ManageEngine
REM Reference: http://manageengine.adventnet.com/products/applications_manager/
text
************************
* ManageEngine
************************
endtext

gosub run "AdventNet\ManageEngine_ApplicationsManager.exe"

return

:Eclipse
REM Download Eclipse for Java EE Developers: http://www.eclipse.org/downloads
text
************************************
* Eclipse - Java Develop Environment
************************************
endtext

REM Select version of Eclipse to install, or if no installation files found, select and Eclipse to configure
gosub FindExe Java\Eclipse\setup\*.zip
iff %_? == 0 then

	set EclipseVersion=%@word["-",2,%@FileName[%exe]]
	set EclipseDir=%programs%\Eclipse\%EclipseVersion%
	
	set InstallDir=%EclipseDir
	gosub RunExe "%exe%"
	
else
	pause Press any key to select the installed version of Eclipse to configure...
	call eclipse.btm select init
	if %? != 0 return %?
endiff

call ask `Do you want to set the default JRE for Eclipse %EclipseVersion ?` y
if %? == 1 call eclipse.btm %EclipseVersion% SetJre

set CodeDir=%LocalCode\test\eclipse%EclipseVersion%

echo Creating directories...
call MakeDir "%CodeDir%"

echo Moving data folder...
call MakeLink merge "%UserData\.eclipse" hide "%UserHome\.eclipse"

text
- Workspace=<paste>
- (Workspace setup) see Eclipse Notes\Workspace\Setup
- (Project setup) see Eclipse Notes\Project\Setup
endtext
echo %@ClipW[%CodeDir] >& nul:
call eclipse.btm %EclipseVersion%
pause

call ask `Do you want to install default plugins?` y
if %? == 1 gosub EclipsePlugIns

echo - Configure workspace or restore existing workspace configuration from data\profile\Eclipse to 
echo   %CodeDir
text
- Window, Preferences, Java, Installed JREs, Search..., c:\Program Files\Java and c:\Program Files (x86)\Java.
- Check the default JRE.
endtext
call eclipse.btm %EclipseVersion% start
pause

return

:EclipseInit

iff "%EclipseDir" == "" .or. "%EclipseVersion" == "" then
	call eclipse.btm select init
	if %? != 0 return %?
endiff

return 0

:EclipsePlugIns

for plugin in (OpenHomePage JBossTools TfsEclipsePlugIn) (
	call ask.btm `Install the %plugin plugin?` y
	iff %? == 1 then
		gosub %plugin
		if %_? != 0 return %_?
	endiff
)

return

:EclipsePlugIn [PlugInArg]

gosub EclipseInit
if %_? != 0 return %_?

REM Arguments
set PlugIn=%@UnQuote[%PlugInArg]
iff "%PlugIn" == "" .and. %# != 0 then
	set PlugIn=%@UnQuote[%1]
	shift
endiff

iff "%PlugIn" == "" then
	echo An Eclipse plugin was not specified.
	return 1
endiff

REM Use the default plugin folder if we can't find the plugin (when not specied from the command line), and a path was not already specified for it 
iff not IsFile "%PlugIn" .and. "%@path[%PlugIn]" == "" then
	set PlugIn=Java\Eclipse\plugins\%PlugIn
endiff

iff not IsFile "%PlugIn" then
	gosub FindExe "%PlugIn"	
	if %_? != 0 return 1
endiff

echos Installing the %@FileName[%PlugIn] plugin...
copy /q %@quote[%exe] "%EclipseDir%\plugins"
echo done.

return

:OpenHomePage
text
************************
* OpenHomePage Plugin
************************
endtext

gosub EclipsePlugin OpenHomePage_1.0.0.jar
if %_? != 0 return %_?

iff not IsFile %LocalCode\home.htm .and. IsFile "%UserData\replicate\default.htm" then
	ln --symbolic "%UserData\replicate\default.htm" %LocalCode\home.htm
	ln --symbolic "%UserData\replicate\base.css" %LocalCode\base.css 
	attrib +h %LocalCode\home.htm %LocalCode\base.css
endiff

return

REM JadClipse plugin - http://jadclipse.sourceforge.net/wiki/index.php/Main_Page
:JadClipsePlugin
text
************************
* JadClipse Plugin
************************
endtext

gosub EclipsePlugIn `"jadclipse_3.%@if[ %EclipseVersion gt 3.1 ,3,1].0.jar"`
if %_? != 0 return %_?

text
- Windows, Preferences
  - Java, JadClipse
    - Directory for temporary files=c:\temp
    - Debug
      - Check Output original line numbers as comments
      - Check Align code for debugging
    - Formatting
      - Check Output fields before methods
      - Check Don't insert a newline before opening brace
  - (optional) File Associations, *.class, JadClipse Class File Viewer, Default
endtext
call eclipse %EclipseVersion% clean

return

REM Microsoft Visual Studio Team Foundation Server Plugin for Eclipse
REM - Download: http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=af1f5168-c0f7-47c6-be7a-2a83a6c02e57
:TfsEclipsePlugin
text
************************
* TFS Eclipse Plugin
************************
endtext

gosub FindExe "Microsoft\Visual Studio\setup\PluginForEclipse\TFSEclipsePlugin-UpdateSiteArchive-VL-10.0.0.zip"
if %_? != 0 return %_?

echo %@clipw[%exe] >& nul:
text
- Help, Install New Software...
  - Add..., Archive..., <paste>
	- Work with: --Only Local Sites--, check Visual Studio Team Explorer Everywhere 2010
	- Uncheck Contact all update sites during install to find required software
- Open Team Fondation Server Exploring perspective, Add Existing Team Project
  - Server=http://source.intel.com:8080,http://ws08:8080/tfs
  - Team Projects=HCMS
- Project, Team, Share Project..., 
endtext
call eclipse %EclipseVersion% start

return

REM JBoss Tools plugin - http://www.jboss.org/tools/download/ 
:JbossTools
text
************************
* JBoss Tools Plugin
************************
endtext

gosub EclipseInit
if %_? != 0 return %_?

set ToolsDir=Java\JBoss\tools
set ToolsVersion=
set ToolsSetup=`%ToolsDir\%ToolsVersion\image`

switch %@left[3,%EclipseVersion]
case 3.6
	set ToolsVersion=3.2.0
case 3.5
	set ToolsVersion=3.1.0.M4
case 3.4
	set ToolsVersion=3.0.1
case 3.3
	set ToolsVersion=2.1.2.GA
endswitch

iff "%ToolsVersion" == "" then
	EchoErr JBoss Tools setup for Eclipse %EclipseVersion is not present.
	return 1
endiff

set InstallDir=%programs\JBoss Tools\%ToolsVersion
gosub run "%ToolsSetup"

call eclipse.btm %EclipseVersion% LinkPlugin JBossTools "%InstallDir"

text
- Refer to JBoss notes for configuration, or copy existing configuration from below or Saba\Intel\eclipse
  - <workspace>\.metadata\.plugins\org.eclipse.wst.server.core\servers.xml
  - <workspace>\.metadata\.plugins\org.eclipse.core.runtime\.settings\org.eclipse.wst.server.core.prefs
  - <workspace>\<project>\.packages
endtext
call eclipse %EclipseVersion% clean
pause

return

:EvilLyrics
text
************************
* Evil Lyrics
************************
endtext

gosub run "Shareware\EvilLyrics\evillyrics.exe"

echo Updating icons...
call DelFile "%ud\EvilLyrics.lnk"
call MergeDir /q "%up\EvilLyrics" "%ao"
call MergeDir /q "%pp\EvilLyrics" "%ao"

return

:.AndroidDevCore
text
************************
* Android Development
************************
endtext

call MakeDir "%pp\Development\Android\Other"

call install.btm android

return

:android

REM Install the Android SDK to LocalAppData (install diectory cannot contain spaces or the Android virtual devices do not work)
set InstallDir=%LocalAppData\Google\android-sdk-windows
gosub run "Google\Android\sdk\android-sdk_r12-windows.zip"

echo Moving data folder...
call MakeLink merge "%UserData\.android" hide "%UserHome\.android"
call MakeLink merge "%UserData\.android" hide "%UserSysHome\.android"

REM Update the Android SDK
text
- Virtual devices, New..., Name=test, Target=Android 2.3.3 - API Level 10, Size=20
- Available packages, Android Repository, check an appropriate tools, documentation, platform, and samples, such as:
  - Android SDK Platform-tools, revision 6
  - Documentation for Android SDK API13, revision 1
  - SDK Platform Android 2.3.3, API 10, revision 1
  - Samples for SDK API 10, revision 1
endtext
call android sdk manager
pause

REM Install Eclipse plugins
echo %@ClipW[https://dl-ssl.google.com/android/eclipse] >& nul:
text
- Help, Install New Software
  - Add..., Name=Android Plugin, Location=<paste>
  - check Developer Tools, close Eclipses
endtext
call sudo /standard eclipse start
pause

REM Install Eclipse plugins
call android init
echo %@ClipW[%SdkDir] >& nul:
text
- Window, Preferences, Android
  - SDK Location=<paste>, Apply
endtext
call sudo /standard eclipse start
pause

REM Restart AHK for the Android plugin to be visible when AHK starts Eclipse
call sudo /standard AutoHotKey.btm restart

return

:.NetDevCore
text
************************
* .NET Development
************************
endtext

call MakeDir "%pp\Development\.NET\Other"

call install.btm VisualStudio NUnit ReSharper WebPlatformInstaller

return

:WebPlatformInstaller
REM download - http://www.microsoft.com/web/downloads/platform.aspx
text
************************
* Web Platform Installer
************************
endtext

gosub run "Microsoft\development\other\wpilauncher.exe"

echo Updating icons...
call MoveFile "%pp\Microsoft Web Platform Installer.lnk" "%pp\Development\.NET\Web Platform Installer.lnk"
call MergeDir /q "%pp\IIS 7.0 Extensions" "%ServerPrograms\Other"

return

:SilverlightSdk
REM downloads  http://www.silverlight.net/downloads
REM 	Developer Runtime (debugging) http://go.microsoft.com/fwlink/?LinkID=229323
REM   SDK  http://www.microsoft.com/en-us/download/details.aspx?id=28359
REM   toolkit (additonal controls) http://silverlight.codeplex.com/ http://silverlight.codeplex.com/releases/view/78435
REM   tools (developer runtime, SDK, Visual Studio 2010 support) http://www.microsoft.com/en-us/download/details.aspx?id=28358
REM version http://www.microsoft.com/getsilverlight/Get-Started/Install/Default.aspx
text
************************
* Silverlight SDK
************************
endtext

gosub run "Microsoft\.NET\Silverlight\development\silverlight_sdk.exe"
gosub run "Microsoft\.NET\Silverlight\development\Silverlight_Developer_%@OsArchitecture[].exe"
gosub run "Microsoft\.NET\Silverlight\development\Silverlight_5_Toolkit_December_2011.msi"

gosub VsIcons

return

:NUnit
REM download - http://www.nunit.org/?p=download
text
************************
* NUnit
************************
endtext

set version=2.6.2
gosub run "Shareware\.NET\NUnit\setup\NUnit-%version%.msi"

echo Updating icons...
call MergeDir /q "%up\NUnit %version%" "%pp\Development\.NET\Other"

call ask `Add NUnit as a Visual Studio tools (not needed if using ReSharper)?` y
iff %? == 1 then
	echo %@ClipW["%programs32\NUnit %version%\bin\net-2.0\nunit.exe"] >& nul:
	text
- Tools, External Tools..., Add
  - Title=NUnit or NUnit Console
  - Command=<paste> or nunit-consol[-x86].exe
  - Arguments=$(ProjectDir)bin/Debug/$(TargetName)$(TargetExt) or $(ProjectDir)$(ProjectFileName)
  - (console) Check Use Output Window
- Note: Add a reference to nunit.framework to test projects
	endtext
	call sudo /standard VisualStudio start
	pause
	
endiff

return

:ScreenSavers
text
************************
* Screen Savers
************************
endtext

if %@IsWindowsClient[] == 0 return

gosub FindExe "Shareware\Really Slick Screensavers V1.0"
if %_? == 0 copy /q "%exe\*.scr" "%WinDir\System32"

return

:EasyBCD
REM - Beta: http://neosmart.net/forums/forumdisplay.php?f=7
text
************************************************
* EasyBCD - Boot Loader Configuration
************************************************
endtext

gosub run "NeoSmart Technologies\EasyBCD 2.0.1.exe"

echo Updating icons...
call DelFile "%pd\EasyBCD*"
call MergeDir /q "%pp\NeoSmart Technologies" "%pp\Operating System\Other"

return

:N2O
text
************************
* N2O
************************
endtext

REM N2O Group
net LocalGroup n2o /add /comment:"n2o Users"
net LocalGroup n2o jjbutare cstegman lkitterman /add

net share "n2o"="%PublicDocuments\group\n2o" %NetShareOptions /Remark:"n2o group files."
call explorer.btm "%PublicDocuments\group"
echo - n2o group full control
pause

echo - Refer to IisMagic instructions to setup WebDAV n2o share on magic

return

:Synergy
REM Keyboard Mouse remote control
REM http://synergy2.sourceforge.net/
text
************************
* Synergy
************************
endtext

gosub run "Shareware\Synergy\SynergyInstaller-1.3.1.exe"

echo Updating icons...
call DelFile "%ud\Synergy.lnk"
call MergeDir /q "%pp\Synergy" "%pp\Operating System\Other"
call MergeDir /q "%up\Synergy" "%pp\Operating System\Other"


text
- Server (shring keyboard and mouse)
endtext

return

:ObjectDock
text
************************
* Object Dock
************************
endtext

gosub run "StarDock\ObjectDock\setup\objectdockplus_190.exe"

call ObjectDock RestoreLicense

REM Start ObjectDock to create the folders and registry keys needed below
call ObjectDock start
pause

REM Move the ObjectDock folder in the user documents directory
echos Moving ObjectDock user directory...

set dest=%UserData\StarDock\ObjectDock\library

set r=HKCU\Software\Stardock\ObjectDock
call registry.btm 32 set %r\ImageLibraryLocation REG_SZ %dest

call MergeDir /q /rename "%UserDocuments\Stardock\ObjectDock Library" "%dest"
call DelDir "%UserDocuments\Stardock"

echo done.

echo Restoring the default profile...
call ObjectDock profile restore default

echo Updating icons...
call DelFile "%ud\ObjectDock.lnk"
call DelFile "%up\Startup\Stardock ObjectDock.lnk"
call MergeDir /q "%up\StarDock" "%pp\Operating System\Other"
call MergeDir /q "%pp\StarDock" "%pp\Operating System\Other"


text
- If video performance (slow window painting) restart ObjectDock 
endtext

return

:EpsonV100
REM drivers http://www.epson.com/cgi-bin/Store/support/supDetail.jsp?BV_UseBVCookie=yes&oid=72343&infoType=Overview
text
************************
* Epson V100 Scanner
************************
endtext

gosub run "Epson\Perfection V100 Scanner\driver\v3.24A\Setup.exe"
gosub run "Epson\Perfection V100 Scanner\Guide\setup.exe"

echo Updating icons...

set base=%ao\Perfection V100
call MakeDir "%base"

call MoveFile "%pd\EPSON Scan.lnk" "%base"
call MoveFile "%pd\Epson PhotoCenter.url" "%base"
call MoveFile "%pd\Perfection V100P User's Guide.lnk" "%base"

call MergeDir /q /rename "%pp\EPSON Creativity Suite" "%base\Creativity Suite"
call MergeDir /q /rename "%pp\EPSON Scan" "%base\Scan"
call MergeDir /q /rename "%pp\Epson\Perfection V100P User's Guide" "%base\doc"

call DelDir "%pp\Epson"
 
REM Scanner properties
text
- EPSON Perfection V10/100, Properties, Events
  - Start Button, Start this program = EPSON Scan
endtext
call os.btm scanner

return

:ViaEnvy24
text
************************
* Via Envy Audio Driver
************************
endtext

gosub run "Via\Envy24\Setup V5.20A\Setup.exe"

echo Updating icons...
call DelFile "%pp\Envy24HF ADeck Control Panel.lnk"


text
- Set S/PDIF and speaker configuration
endtext

return

:SysInternals
text
************************
* SysInternals Tools
************************
endtext

echo Updating registry...
call SysInternals eula

echo Restoring the default profile...
call SysInternals profile restore default

echo Registering ShellRunAs...
start /pgm ShellRunAs /reg

iff %_WinVer ge 6.0 then
	echo Updating firewall...
	call firewall rule add "PsExec" `dir=in action=allow protocol=TCP localport=RPC RemoteIP=LocalSubnet profile=domain,private program="%WinDir\system32\services.exe" service=any`
endiff

return

:AlbumCoverArtDownloader
REM http://www.unrealvoodoo.org/hiteck/projects/albumart/
text
*****************************
* Album Cover Art Downloader
*****************************
endtext

gosub run "Shareware\Album Cover Art Downloader\albumart-1.6.6-setup.exe"

echo Updating icons...
call MakeDir "%pp\Media\Other"
call MergeDir /q "%up\Album Cover Art Downloader" "%pp\Media\Other"


text
- Settings, Configure Album Cover Art Downloader...
  - Sources, for each source check Enable 
  - Targets
    - Freedesktop.org and Generic, Uncheck Enable
    - MP3 files and Windows Media Player, check Enable
- View, uncheck Hide albums with cover images
- View, View mode, Click View the music collection sorted into folders.
endtext

return

:LogMeIn
REM download - 
text
************************
* LogMeIn
************************
- On the LogMeIn web site delete previous computer account if it exists
- Custom, Description=<computer name>
endtext

gosub run "LogMeIn\LogMeIn.msi"

echo Updating icons...
call MoveFile "%pp\LogMeIn.lnk" "%pp\Operating System"

echo - (Computer Management) Create a local account for each secondary user
call os ComputerManagement
pause

text
- (for each secondar user) Users, Secondary Users, Add New Secondary User
  - Secondary User's email address=NNN
  - Computer Access Permision, Groups/Computers, check the computer name
endtext
call http://LogMeIn.com
pause
	
text
- Home, Preference
  - Remote Control, Default answer for confirmation message=No
  - (for each secondary user that is not in the administrators group) Security Settings, Access Control, Add
    - User name=<user name>, Add
    - Check Remote Control R and W
endtext
call https://LocalHost:2002/main.html

return

:Areca
text
************************
* Areca Backup
************************
endtext

gosub run "Shareware\Areca\areca-5.2.1-win32-setup.exe"

echo Updating icons...
call MoveFile "%pd\Areca.lnk" "%pp\Operating System"
call MoveFile "%ud\Areca.lnk" "%pp\Operating System"
call MergeDir /q "%pp\Areca" "%pp\Operating System\Other"
call MergeDir /q "%up\Areca" "%pp\Operating System\Other"


text
- Notes
	- When creating a backup Target
		- Check Compression Zip 64
		- Check Track directories
		- Check Store permissions
	- To schedule a backup select Create backup shortcut
	- Encryption does not work
endtext

return

:Silverlight
:SilverlightPlayer
:SilverlightRuntime
REM http://www.microsoft.com/silverlight/resources/install.aspx
text
************************
* Silverlight Player
************************
endtext

gosub run "Microsoft\.NET\Silverlight\setup\Silverlight v5.1.10411.exe"

echo Testing...
call InternetExplorer.btm 32 http://www.microsoft.com/silverlight/default_ns.aspx

echo Updating icons...
gosub SilverlightIcons

return

:SilverlightIcons

call MoveFile "%pp\Microsoft Silverlight\Microsoft Silverlight.lnk" "%pp\Applications\Accessories\Silverlight.lnk"
call DelDir quiet "%pp\Microsoft Silverlight"

set base=%pp\Development\Other
call MakeDir "%base\Silverlight"
call MoveFile "%pp\Microsoft Silverlight 3 SDK\Welcome.lnk" "%base\Silverlight\Silverlight 3 SDK Welcome.lnk"
call MoveFile "%pp\Microsoft Silverlight 4 SDK\Welcome.lnk" "%base\Silverlight\Silverlight 4 SDK Welcome.lnk"
call MoveFile "%pp\Microsoft Silverlight 4 SDK\Welcome.lnk" "%base\Silverlight\Silverlight 4 SDK Welcome.lnk"

call MergeDir /q /rename "%pp\Microsoft Silverlight 5 SDK" "%base\Silverlight\Silverlight 5 SDK"
call MergeDir /q /rename "%pp\Microsoft Silverlight 5 Toolkit December 2011" "%base\Silverlight\Silverlight 5 Toolkit"
call MergeDir /q /rename "%pp\WCF RIA Services V1.0 SP2" "%base\Silverlight\WCF RIA Services V1.0 SP2"

call DelDir quiet "%pp\Microsoft Silverlight*"
		
return

:IntelRapidStorage
:IntelMatrix
:rst
REM Download: http://downloadcenter.intel.com/Product_Filter.aspx?ProductID=2101
REM Installs
REM - System Run : IAStorIcon - C:\Program Files (x86)\Intel\Intel(R) Rapid Storage Technology\IAStorIcon.exe
REM - Service: IAStorDataMgrSvc - Intel(R) Rapid Storage Technology - "C:\Program Files (x86)\Intel\Intel(R) Rapid Storage Technology\IAStorDataMgrSvc.exe"
REM    Provides storage event notification and manages communication between the storage driver and user space applications 
REM - Driver: iaStor - Intel RAID Controller -c:\windows\system32\drivers\iastor.sys - Intel Rapid Storage Technology driver - x64
REM - Driver: iaStorV	- c:\windows\system32\drivers\iastorv.sys - Intel Matrix Storage Manager driver - x64
text
************************************************
* Intel Rapid Storage RAID Controller
************************************************
- check Install Intel Control Center
endtext

gosub run "Intel\Rapid Storage\setup\RST v12.5.0.1066.exe"

echo Updating icons...
call MergeDir /q "%pp\Intel" "%pp\Operating System\Other"

text
- Intel Matrix Storage Console, right click on volume, Enable Volume Write-Back Cache
endtext

return

:IntelProNetworkAdapter
:ProSet
REM http://downloadcenter.intel.com/SearchResult.aspx?lang=eng&keyword=%22PRO%22Network%22Connections%22LAN%22Driver#
REM http://ark.intel.com/products/52963/Intel-82579V-Gigabit-Ethernet-PHY?wapkw=Intel%2082579V
REM Installs:
REM - Service: Intel(R) PROSet Monitoring Service - C:\Windows\system32\IProsetMonitor.exe
REM   The Intel(R) PROSet Monitoring Service actively monitors changes to the system and updates affected network devices to keep them running in optimal condition.  Stopping this service may negatively affect the performance of the network devices on the system.
REM - Path: C:\Program Files\Intel\WiFi\bin\; C:\Program Files\Common Files\Intel\WirelessCommon\
text
*******************************
* Intel PRO Network Adapter
*******************************
- (optional) Uncheck Advanced Networking Services 
endtext

gosub run "Intel\PRO Network Adapter\setup\PROWin%@WindowsVersion[]_%@OsBits[]_v17.4.exe"

gosub ProSetFinal
return

:ProSetFinal

text
- LAN, Properties, Configure...
  - (optional) Advanced, Locally Administered Address=<MAC address from HostInfo>
endtext
call network connections
pause

return

:IntelSsdToolbox
REM download - http://downloadcenter.intel.com/SearchResult.aspx?lang=eng&keyword=%22SSD+510%22
text
************************
* Intel SSD Toolbox
************************
endtext

gosub run "Intel\ssd\toolbox\setup\Intel SSD Toolbox - v3.1.2.exe"

echo Updating icons...
call DelFile "%pd\Intel SSD Toolbox.lnk"
call DelFile "%ud\Intel SSD Toolbox.lnk"
call MergeDir /q "%pp\Intel" "%pp\Operating System\Other"
call MergeDir /q "%up\Intel" "%pp\Operating System\Other"

text
- Intel SSD Optimizer, Schedule, Add
- Fix other areas with an exclamation point
endtext
call intel SsdToolbox
pause

REM Common SSD setup
gosub ssd 

return

:IntelMotherboardUtilities

call ask `Do you want to install the Intel Desktop Utilities?` n
if %? == 1 gosub IntelDesktopUtilities

call ask `Do you want to install the Intel Extreme Tuning Utility?` n
if %? == 1 gosub IntelExtremeTuningUtility

call ask `Do you want to install the Intel Integrator Assistant?` n
if %? == 1 gosub IntelIntegratorAssistant

return

:IntelDesktopUtilities
REM Monitor hardware devices (temperature and fan speed)
REM http://www.intel.com/design/motherbd/software/idu/index.htm
REM http://downloadcenter.intel.com/SearchResult.aspx?keyword=%22%22intel+desktop+utilities%22%22
REM Installs 
REM - Driver: smbusp - Intel(R) SMBus 2.0 Driver - c:\windows\system32\drivers\intelsmb.sys - System Management Bus 2.0 (SMBus) Driver
REM - System Run: ipTray.exe - "C:\Program Files (x86)\Intel\Intel Desktop Utilities\ipTray.exe" - Tray application for Intel(R) Desktop Utilities
REM - Service: Intel(R) Desktop Boards FSC Application Service - C:\Program Files (x86)\Intel\FSC\FSCAppServ.exe
REM    Supports the instrumentation of the Sensors and Fan Speed Controllers utilized on Intel Desktop Boards.
REM - Service : IduService - Intel(R) Desktop Utilities Service - "C:\Program Files (x86)\Intel\Intel Desktop Utilities\iduServ.exe"
REM   Manages IDU component communication and alerts
REM -  smbusp
text
*******************************
* Intel Desktop Utilities
*******************************
endtext

gosub run "Intel\Motherboard\utility\Desktop Utilities\setup v3.2.3.052\Setup.exe"

echo Updating icons...
call MergeDir /e "%pp\Intel" "%pp\Operating System\Other"
call MergeDir /e "%up\Intel" "%pp\Operating System\Other"
call DelFile "%pd\Intel(R) Desktop Utilities.lnk"

echo Updating registry...

REM Delete ipTray.exe - "C:\Program Files (x86)\Intel\Intel Desktop Utilities\ipTray.exe"
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ipTray.exe"

text
- Options
  - Set Active Alterting Options, uncheck Blink tray icon and Pop up message
  - Set Sensor Threshold
    - Rename hard drive to SSD and RAID Array and set Upper to 50
endtext
call intel DesktopUtilities
pause

echo Updating services...

REM Set service to manual to prevent audio stutter
call service manual "Intel(R) Desktop Boards FSC Application Service"
call service manual "IduService"

return

:IntelExtremeTuningUtility
REM Change motherboard configuration, control cooling, monitor hardware, perform stress and performance tests
REM - http://www.intel.com/design/motherbd/software/xtu/index.htm
REM - http://downloadcenter.intel.com/SearchResult.aspx?lang=eng&keyword=%22Intel+Extreme+Tuning+Utility%22
REM Installs
REM - Service: XTUService - Intel(R) Extreme Tuning Utility - "C:\Program Files (x86)\Common Files\Intel\Intel Extreme Tuning Utility\PerfTuneService.exe" - Intel Extreme Tuning Utility hardware interface.
text
*******************************
* Intel Extreme Tuning Utility
*******************************
endtext

REM Version 3.0 only works on SandyBridge-E systems
gosub run "Intel\Motherboard\utility\Extreme Tuning Utility\setup v2.1.408.35.exe"

echo Updating services...

REM Change to manual as it crashes regularly
call service manual XTUSERVICE

echo Updating icons...
call DelFile "%pd\Intel*Extreme Tuning Utility.lnk"
call MergeDir /q /rename "%pp\Intel Extreme Tuning Utility" "%pp\Operating System\Other\Intel\Extreme Tuning Utility"

return

:IntelIntegratorAssistant
REM purpose: change bios, customize bios
REM http://www.intel.com/design/motherbd/software/iia/index.htm 
REM http://downloadcenter.intel.com/Detail_Desc.aspx?agr=Y&DwnldID=18672&ProdId=3273&lang=eng&OSVersion=%0A&DownloadType=%0ASoftware%20Applications%0A  and search http://downloadcenter.intel.com/SearchResult.aspx?keyword=%22%22integrator+assistant%22%22  and home path http://www.intel.com/design/motherbd/software/iia/index.htm 
text
*******************************
* Intel Integrator Assistant
*******************************
endtext

set InstallDir=%programs\Intel Integrator Assistant
gosub run "Intel\Motherboard\utility\Integrator Assistant\IIA_1.1.7.872a.zip"

return

:IntelDP67BG
REM http://downloadcenter.intel.com/SearchResult.aspx?lang=eng&keyword=%22DP67BG%22#
REM Installs
REM - Sytem Run (x86) - NUSB3MON - "C:\Program Files (x86)\Renesas Electronics\USB 3.0 Host Controller Driver\Application\nusb3mon.exe"
text
****************************
* Intel DP67BG Motherboard
****************************
endtext

set driver=Intel\Motherboard\DP67BG\driver
gosub run "%driver\ESATA_allOS_1.2.0.7700_PV\drvSetup.exe"

echo Updating icons...	
call MergeDir /q "%pp\Renesas Electronics" "%pp\Operating System\Other\Intel"
call MergeDir /q "%up\Marvell" "%pp\Operating System\Other\Intel"

call install.btm IntelRapidStorage

echo Checking for updated drivers...
if %? == 1 ShellRun http://www.intel.com/p/en_US/support/detect?redirector_count=1&

return

:IntelP35

REM Windows 7  comes with P35 chipset drivers
iff %@IsWindows7[] == 1 return

echo Installing Intel Northbridge (P35 Bearlake) and southbridge (ICH9R) Chipset drivers..
gosub run "Intel\Chipset\V8.3.1.1009\infinst_autol.exe"

return

:Intel865Perl
text
************************
* Intel Box 865 Motherboard
************************
endtext

set driver=Intel\865PerlX\driver

echo Intel 865 Chipset drivers...
gosub run "%driver\chipset\INF_AllOS_8.4.0.1016_PV_Intel.exe"

call install.btm IntelProNetworkAdapter IntelMotherboardUtilities

iff not defined NewOs then
	gosub run "%driver\AUD_ALL32_5.12.1.5240_PV2.EXE"

	REM SoundMAX "C:\Program Files\Analog Devices\SoundMAX\Smax4.exe" /tray
	echo Delete SoundMAX tray icon:
	call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SoundMAX"

	call MergeDir /e "%pp\SoundMAX" "%pp\Operating System\Other"
endiff
	
return

:LenovoLaptop
************************************************
* Lenovo Laptop
************************************************

REM Fan control and temperature monitoring - need if have issues with fan speed under high cpu utilization
gosub ThinkPadFanContoller

gosub run "Lenovo\drivers\Hotkey v3.02.0000.exe"
gosub run "Lenovo\drivers\Power Manager v3.12.exe"
gosub run "Lenovo\drivers\UltraNav v14.0.16.0 %@OsArchitecture[].exe"

REM Instal Bluetooth drivers to enable additional profiles (devices) such as the Voyager PRO+.
gosub run "Lenovo\drivers\Bluetooth v6.2.1.2900.exe" 
gosub BroadcomBluetooth false

return

:LenovoT400Laptop
************************************************
* Lenovo T400 Laptop
************************************************
endtext

gosub LenovoLaptop
gosub run "Lenovo\T400\drivers\video 7xd652ww.exe"
gosub run "Lenovo\T400\drivers\audio v4.92.12.0.exe"
gosub run "Lenovo\T400\drivers\card reader 7kss73ww.exe"

return

:Hp8560wLaptop
:Laptop
REM download - http://h20000.www2.hp.com/bizsupport/TechSupport/SoftwareIndex.jsp?lang=en&cc=us&prodNameId=5071173&prodTypeId=321957&prodSeriesId=5071171&swLang=13&taskId=135&swEnvOID=4060
text
************************************************
* HP EliteBook 8560w Laptop
************************************************
endtext

set DriverDir=Hewlett Packard\EliteBook 8560w\driver

REM Instal Bluetooth drivers to enable additional profiles (devices) such as the Voyager PRO+.
REM gosub run "%DriverDir\Broadcom 2070 Bluetooth\v20110430\Setup.exe" 
REM gosub BroadcomBluetooth false

REM PROSet/Wireless Networking
REM gosub run "%DriverDir\PROSet Wireless\Wireless_15.3.1_s64.exe"
REM gosub run "%DriverDir\NIC\PROWinx64.exe"
REM gosub ProSetFinal

echo Updating registry...

REM Delete QLBController - C:\Program Files (x86)\Hewlett-Packard\HP HotKey Support\QLBController.exe /start
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\QLBController"

return

:GigabyteGaP35Dq6
text
************************************************
* Gigabyte GA-P35-DQ6 Motherboard
************************************************
endtext

call install.btm RealTekNic RealTekAudio

REM Intel Matrix RAID Controller
REM - 6 SATA ports on Intel southbridge ICH9R SATA controller, IDE/ACHI/RAID modes.
REM - AHCI/RAID supports eSata.  
gosub IntelRapidStorage

REM EasyTune - fan control, tune motherboard, not needed in Windows 7
call install.btm EasyTune

REM GSATA - Gigabyte SATA controler 
REM - 2 SATA ports.  IDE/AHCI/RAID modes.  AHCI/RAID supports eSata and  requires boot disk for OS install.  Installs drivers JGOGO, JRAID
REM - Gigabyte SATA controller in ACHI/RAID mode requires boot disk for OS install
REM - May be a cause of blue screens.
REM gosub run "Gigabyte\motherboard\GA-P35-DQ6\driver\disk\GigaByte SATA RAID V1.17.20.03\setup.exe"

REM BIOS updater - view or update BIOS
gosub run "Gigabyte\motherboard\GA-P35-DQ6\utility\atBIOS\Setup.exe"

echo Updating icons...
call MergeDir /q /rename "%pp\GIGABYTE" "%pp\Operating System\Other\Gigabyte"
call MoveFile "%pp\Gigabyte Technology Corp\Gigabyte Raid Configurer.lnk" "%pp\Operating System\Other\Gigabyte"
call DelDir "%pp\Gigabyte Technology Corp"

return

:PowerMixer
REM Download - http://www.actualsolution.com/download.htm
REM Beta - http://www.actualsolution.com/power_mixer/beta.htm
text
************************
* Power Mixer
************************
endtext

iff defined NewOs then
	gosub run "Actual Solution\Power_Mixer_3.6.exe"
else
	gosub run "Actual Solution\Power_Mixer_2.7.exe"
endiff

echo Updating icons...
call MergeDir /q "%up\Power Mixer" "%ao"
call DelFile "%ao\Power Mixer\Home Page.lnk"
call DelFile "%ao\Power Mixer\Online Registration.lnk"
call DelFile "%ao\Power Mixer\Uninstall Power Mixer.lnk"

echo Updating registry...

REM Delete Power Mixer - "C:\Program Files (x86)\Power Mixer\pwmixer.exe" /m
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Power Mixer"

echo Restoring the default profile...
call PowerMixer profile restore default

REM LogMeIn tries to create wheel.dll if it is not present when Power Mixer is running
iff IsDir "%programs32\LogMeIn" .and. not exist "%programs32\LogMeIn" then
	copy /q "%programs32\Power Mixer\wheel.dll" "%programs32\LogMeIn"
endiff

text
Options
- View, Display for 1.0 sec
- Mixer
  - (prevent excessive references to wheel.dll by processes in ProcExp)
    - Uncheck By mouse wheel when cursor is over
    - Uncheck By mouse wheel
    - Uncheck By mouse
  - Method=Audio Taper
  - Speed=40
- System
  - Uncheck Run on Windows Startup
  - Check Start minimized
  - Check Minimize to tray on Close
- Presets, New
  - Enter preset name=Analog&Digital
  - Select Realtek High Definition Audio, Edit
    - Priority=1, Speaker settings=Stereo speakers|5.1 speakers|Stereo speakers
		- Priority=2, Default playback device=Realtek HD Audio output|Realtek Digital Output
  - Select output Realtek HD Audio output|Realtek Digital Output, Edit, Volume=20|50|50
  - Select line front|rear|na |100/50/Enable
	- (all lines to not change) Right click on Vol|Bal|M/S columns until grey
- HotKeys, select audio device, Edit
  - Check all, Ctrl+Num8/2/1/3/.
- Tray icon, 
  - Double-click action=Open Standard Mixer
  - Tray icon image=Chameleon
- Note: 
  - PowerMixer crashes when setting options: delete configuration files
  - Presets
    - Set default audio device: Edit the audio device
    - Set levels: right click on Vol|Bal|M/S (mute) to toggle between not changing (grey) and setting.
    - Outputs: set the level for the output
    - Lines: set the level for the outputs individual lines of the output, usually to 100
endtext

return

:CloneDrive
REM download - http://www.slysoft.com/en/download.html
REM installs:
REM - ElbyDelay drive LowerFilter
REM - VirtualCloneDrive vcddaemon in Startup
REM - VirtualCloneDrive CloseTray shell extension (elbyvcdshell.dll)
REM - Drivers: ElbyCDIO, ElbyDelay, VClone
text
************************
* CloneDrive
************************
- check Associate .iso/.udf files
endtext

gosub run "SlySoft\CloneDrive\SetupVirtualCloneDrive5450.exe"

echo Updating icons...
call DelFile "%pd\Virtual CloneDrive.lnk"
call MergeDir /q "%pp\Elaborate Bytes" "%pp\Operating System\Other"

text
- Settings
  - Number of Drives=2
  - Check Virtual Sheep
  - Uncheck Show Tray Icon
endtext
gosub RunProg "%programs32\Elaborate Bytes\VirtualCloneDrive\VCDPrefs.exe"
pause 

gosub LabelIso

return

:LabelIso
echo `- Rename new drives iso<n>`
call MountVolToDev

return

:Yugma
text
REM Installs dfmirage service, Mirage Driver, DemoForge, LLC, c:\windows\system32\drivers\dfmirage.sys	
***************************
* Yugma - web conferencing
***************************
endtext

gosub run "http://yugma.com"

echo Updating icons...
call MoveFile "%ud\Yugma.lnk" "%pp\Applications"
call MergeDir /q "%up\Yugma" "%ao"

return

:TortoiseSVN
:VisualSVN
REM download http://tortoisesvn.net/downloads.html http://www.visualsvn.com/visualsvn/download/
REM Installs: REM - Path: C:\Program Files\TortoiseSVN\bin
text
*****************************
* TortoiseSVN Source Control
*****************************
- Select all features
endtext

gosub run "Shareware\TortoiseSVN\TortoiseSVN-1.8.1.24570-%@OsArchitecture[]-svn-1.8.1.msi"
gosub run "VisualSVN\VisualSVN-3.5.2.msi"

echo Updating icons...
call MergeDir /q "%pp\TortoiseSVN" "%pp\Development\Other"
call MergeDir /q "%pp\VisualSVN" "%pp\Development\Other"
call MergeDir /q "%up\VisualSVN" "%pp\Development\Other"

iff %@IsIntelHost[] == 1 then

	echo Software Solutions setup...
	echo - Place all certificates in the following store=Trusted Root Certificate Authorities
	call certificate install "%UserData\certificate\public\azscsistfs001.amr.corp.intel.com.crt"
	pause
	
	call SoftwareSolutionsUpdate
	
else
	text
Creating projects...
- Create folder, right click, SVN Checkout...
- DIS: c:\dis, URL=svn://dev.technologist-4-hire.com/dis,
	endtext
	call explorer "%LocalCode"
	pause

endiff

text
- Settings, External Programs, Diff Viewer and Merge Tool, External
  c:\Program Files (x86)\Beyond Compare 3\BComp.exe
endtext
pause

return

:FingerprintReader
REM http://www.microsoft.com/hardware/mouseandkeyboard/DownloadResult.aspx?prod=pf_fr&os=WVista_32&lang=en&driverVersion=DigitalPersona%20Password%20Manager%202.0
text
************************************************
* Fingerprint Reader - Digital Persona Manager
************************************************
endtext

gosub run "Microsoft\Fingerprint Reader\DPPM_201_ENG.exe"

echo Updating icons...
call MergeDir /q "%pp\DigitalPersona Password Manager" "%pp\Operating System\Other"

echo Restoring the default profile...
call FingerprintReader profile restore default

return

:XboxWirelessReceiver
REM http://www.microsoft.com/hardware/download/download.aspx?category=Gaming
text
************************
* Xbox Wireless Receiver
************************
endtext

gosub run "Microsoft\Xbox\Wiresless Receiver\Xbox360_v6.2.0029_%@OsBits[]Eng.exe"

echo Updating...
start /pgm "%programs32\Microsoft Xbox 360 Accessories\Checker.exe" -forcecheck
pause

echo Updating icons...
call MergeDir /q /rename "%pp\Microsoft Xbox 360 Accessories" "%pp\Games\Other\Xbox Accessories"

return

:AmazonCloudPlayer
REM https://www.amazon.com/gp/dmusic/mp3/player?ie=UTF8&%2AVersion%2A=1&%2Aentries%2A=0#latestUploads
REM https://www.amazon.com/gp/dmusic/order/amd-get-interstitial.html/ref=dp_amp_get_amd_for_dl_click
text
************************
* Amazon MP3
************************
endtext

gosub run "Amazon\other\AmazonCloudPlayerInstaller337.exe"

echo Updating icons...
call MakeDir "%ao\Amazon"
call MergeDir /q /rename "%up\Amazon Cloud Player" "%ao\Amazon\Cloud Player"
call DelFile "%ud\Amazon Cloud Player.lnk"

text
- Configuratioin, General
  - All downloads are sgtored here=Libraries\Music (roo) Public Music or Music
endtext

return

:Audible
REM Sonos setup (streams from PC) - http://audible.custhelp.com/app/answers/detail/a_id/3192/kw/sonos/r_id/166
text
************************
* Audible
************************
endtext

gosub run "Amazon\other\Audible Active Setup.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Audible" hide "%UserDocuments\audible"

echo Updating icons...
call MergeDir /q "%pp\AudibleManager" "%ao"
call DelFile.btm "%ud\Audible Manager.lnk"

echo - General Settings, My Documents\data\audible\downloads
start /pgm "%programs32\Audible\Bin\AudibleDownloadHelper.exe"
pause

text
- Music, Set Up Services..., Add, Audible
- Notes: 
  - Sonos supports only Type 4 audible audio (.aa extension)
  - media.btm router will copy books to the router
  - Music will be displayed under Genres, Audibooks
endtext
call sonos start
pause

return

:AdobeDigitalEditions
REM http://www.adobe.com/products/digital-editions/download.html
text
*************************
* Adobe Digital Additions
*************************
endtext

gosub run "Adobe\DigitalEditions\ADE_2.0_Installer.exe"

REM Move data folder
call MakeLink merge "%UserData\Adobe Digital Editions" hide "%UserDocuments\My Digital Editions"

echo Updating icons...
call MergeDir.btm /quiet "%pp\Adobe" "%ao"
call DelFile.btm "%pp\Adobe Digital Editions 2.0.lnk"
call DelFile.btm "%pd\Adobe Digital Editions 2.0.lnk"

return

:Kindle
REM http://www.amazon.com/gp/feature.html/ref=kcp_pc_mkt_lnd?docId=1000426311
REM http://www.ebook-converter.com/kindle-drm-removal.htm
text
************************
* Kindle
************************
- Installs: Kindle reader for PC
endtext

gosub run "Amazon\Kindle\setup\Kindle for PC v1.10.6.40500.exe"
gosub run "Amazon\Kindle\converter\Kindle DRM Removal v5.0.0.0.exe"

echo Creating data folders...
call MakeDir "%UserData\Kindle"
call MakeDir "%UserData\Kindle DRM Removal"
call MakeDir "%UserDocuments\Kindle DRM Removal"
attrib +h "%UserDocuments\Kindle DRM Removal"

echo Updating icons...
call MergeDir /q "%pp\Amazon" "%ao"
call MergeDir /q "%up\Amazon" "%ao"
call MergeDir /q /rename "%ao\Amazon\Amazon Kindle" "%ao\Amazon\Kindle"
call MergeDir /q "%up\Kindle DRM Removal" "%ao"
call DelFile "%pd\Kindle.lnk"
call DelFile "%ud\Kindle.lnk"
call DelFile "%ud\Kindle DRM Removal.lnk"
call DelFile "%ao\Amazon\Kindle\Uninstall Kindle.lnk"

text
Kindle for PC
- Tools, Options
  - General, uncheck Automatically install updates
  - Content, Change Folder, data\Kindle

- Kindle DRM Removal
  - Check Check if eBook file copy from Kindle reader, input Kindle Serial Number
  - Kindle Serial Number=NNN
  - Set Output Folder=My Documents\data\Kindle DRM Removal
  - Remote all Kindle ebooks in folder, Input Folder=My Documents\data\download
endtext
ShellRun "https://www.amazon.com/gp/digital/fiona/manage?ie=UTF8&ref_=sv_kinc_7&signInRedirect=1&#manageDevices"
call kindle start
call kindle decrupt
pause

return

:BitTorrent
text
************************
* BitTorrent
************************
endtext

gosub run "shareware\BitTorrent\BitTorrent-6.0.exe"

echo Updating icons...
call MergeDir /q "%pp\BitTorrent" "%ao"

return

:DriveMonitor
text
************************
* Acronis Drive Monitor
************************
endtext

gosub run "Acronis\setup\Drive Monitor v1.0.0.187.exe"

echo Updating icons...
call MergeDir /q "%pp\Acronis" "%pp\Operating System\Other"
call MoveFile "%pd\Acronis Drive Monitor.lnk" "%pp\Operating System"

return 

:DiskDirector
REM http://www.acronis.com/support/updates/
text
- Complete install
endtext

REM Disk Director Suite cannot be install on servers
if defined server return

gosub run "Acronis\setup\DiskDirector v11.0.0.2343.exe"

echo Updating icons...
call MergeDir /q "%pp\Acronis" "%pp\Operating System\Other"

REM Acronis shortcuts include special characters in place of spaces that interfere with normal processing
call DelFile "%ud\Acronis OS Selector.lnk" "%pd\Acronis*.lnk"

return

:TrueImage
REM http://www.acronis.com/support/updates
REM 
REM Installs:
REM - Startup
REM    HKCU, TrueImageMonitor. c:\program files\acronis\trueimageworkstation\trueimagemonitor.exe	
REM    HKLM, Acronis Scheduler2 Service, "C:\Program Files (x86)\Common Files\Acronis\Schedule2\schedhlp.exe"
REM - Service
REM   fltsrv, Acronis Storage Filter Management
REM   fltsrv30, Acronis Storage Filter Management (Build 30)
REM - Other: Acronis True Image Shell Extensions
REM - Update (validate and update with new version on oversoul)
REM   Acronis Scheduler2 Service, Acronis Scheduler Helper	Acronis	c:\program files\common files\acronis\schedule2\schedhlp.exe	
REM - AcronisTimounterMonitor, Monitor for Acronis True Image Backup Archive Explorer	Acronis	c:\program files\acronis\trueimageworkstation\timountermonitor.exe	
REM - AcronisOSSReinstallSvc, File not found: C:\Program Files\Common Files\Acronis\Acronis Disk Director\oss_reinstall_svc.exe	
REM - AcrSch2SvcProvides task scheduling for Acronis applications.	Acronis	c:\program files\common files\acronis\schedule2\schedul2.exe	
REM - tifsfilter, Acronis True Image File System Filter	Acronis	c:\windows\system32\drivers\tifsfilt.sys	
REM - timounter, Acronis True Image Backup Archive Explorer	Acronis	c:\windows\system32\drivers\timntr.sys	
REM - relog_ap, Acronis Relogon Authentication Package	Acronis	c:\windows\system32\relog_ap.dll	
REM 
REM Disk Director Suite installs:
REM - snapman, Acronis Snapshot API	Acronis	c:\windows\system32\drivers\snapman.sys	
text
************************
* Acronis TrueImage
************************
- Complete install
endtext

gosub run "Acronis\setup\True Image v15.0.0.6154.exe"
gosub run "Acronis\setup\True Image Plus Pack v15.0.0.6154.exe"

echo Updating icons...

call MergeDir /q "%pp\Acronis" "%pp\Operating System\Other"
call DelFile "%pd\Acronis Online Backup.lnk"
call DelFile "%pd\Acronis True Image Home 2012.lnk"

REM Delete Acronis Scheduler2 Service  - "C:\Program Files (x86)\Common Files\Acronis\Schedule2\schedhlp.exe"
call registry.btm delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Acronis Scheduler2 Service"

text
- Tools, Options
  - Default Backup Options, Compression Level, Maximum
endtext
gosub RunProg "%programs32\Acronis\TrueImage\TrueImage.exe"
pause

text
- Notes: Backup location: <backup drive>\acronis
endtext

return

:OsSelector
text
************************
* Acronis OS Selector
************************
- Requires Acronis Disk Directory Suite
- Install OS Selector only on on one partition
endtext

echo Installing OS Selector...
gosub RunProg "%programs32\Acronis\Acronis Disk Director\OSSelectorSetup.exe"
pause

text
- Tools, Options
	- Display Properties=1,024x768, 72Hz
- Select Boot from floppy A:, click Hide the selected operating system
- Remove unused operating systems
- Edit existing (Select os, Properties) or create new (Tools, OS Detection Wizard)
  - General Propertes, Edit the operating system name
  - Partitions, select other partitions, Hide
	- Close and open, verify C: boot,system, d: data drive, rest hidden
endtext
gosub RunProg "%programs32\Acronis\Acronis Disk Director\OS_Selector.exe"
pause


text
- Tools, Options
  - Generation Options, No, do not protect folders
  - Startup Options, With timeout=10sec
  - Display Properties, Screen resolution=1,280 by 1,024 pixels, Color quality=High (24 bit)
  - Input Devices=PS/2 or USB compatible (if OS fail to boot with restart, use No mouse)
- Operating System, Properties
  - General Properties, Edit the operating system name=<volume name>, Change Icon...
  - Partitions, validate drive letters, ensure only one Windows partition is visible
  - Folders, Properties, Enagle or disable restoring the folder contents=Disabled
endtext

return

:RealTekNic
REM PCIe: http://www.realtek.com.tw/downloads/downloadsView.aspx?Langid=1&PNid=13&PFid=5&Level=5&Conn=4&DownTypeID=3&GetDown=false
REM PCI: http://www.realtek.com.tw/downloads/downloadsView.aspx?Langid=1&PNid=13&PFid=4&Level=5&Conn=4&DownTypeID=3&GetDown=false&Downloads=true
text
************************
* RealTek NIC
************************
endtext

iff %@IsWindows7[] == 1 then
	gosub run "RealTek\PCIe NIC\Win7 Driver V7.009.11202009\setup\setup.exe"
endiff

echo Updating icons...
call MergeDir /q "%pp\Realtek" "%pp\Operating System\Other"

echo - Verify Realtek driver is installed and if required run setup again 
call os DeviceManager
pause

return

:RealTekAudio
REM Drivers: http://www.realtek.com.tw/downloads/downloadsView.aspx?Langid=1&PNid=14&PFid=24&Level=4&Conn=3&DownTypeID=3&GetDown=false
text
************************
* RealTek Audio
************************
endtext

echo Closing audio software...
call WindowsMediaPlayer close
call iTunes close
call PowerMixer close

gosub run "RealTek\High Definition Audio\v2.70\setup.exe"

text
- Realtek HD Audio Manager
  - i, uncheck Display icon in notifcationa rea
  - Digital Output
    - (if present) DTS Connect, Music Mode
    - Default Format, DTS Interactive (if present) or DVD Format
  - Speakers, Back Panel, double click blue, check Front Speaker Out
- Control Panel, Sound, Playback, Realtek Digital Output, properties
  - Supported Formats click on an Encoded format and Sample Rate then Test
  - Check Dolby Digital and 48.0 Khz
endtext
call RealTekAudio.btm start
pause

gosub SoundListen

return

:VgaEasyBoost
REM Change configuration and update BIOS
REM download - http://www.gigabyte.com/products/product-page.aspx?pid=3799#utility
text
***************************
* Gigabyte VGA Easy Boost
***************************
- Use VGA@BIOS only if cannot update BIOS using Easy Boost
endtext

gosub run "Gigabyte\GPU\Easy Boost\vga_utility_easy_boost_v1.0.4.1.EXE"
REM gosub run "Gigabyte\GPU\VGA@BIOS\vga_utility_atbios_ver4.3.exe"

echo Updating icons...
call DelFile "%pd\EasyBoost.lnk"
call MergeDir /q "%pp\GIGABYTE" "%pp\Operating System\Other"
call MergeDir /q "%up\GIGABYTE" "%pp\Operating System\Other"

return

:EasyTune
REM Tune motherboard settings, view system statistics (temperature, fan), control thermal (fan)
REM Updates http://www.gigabyte-usa.com/Support/Motherboard/Utility_List.aspx
REM EasyTune: Installs Drivers: ET5Drv and MarkFun_NT (previous: gdrv)
text
************************
* EasyTune
************************
endtext

gosub run "Gigabyte\motherboard\utility\Easytune\VB7.1221.1\Setup.exe"

echo Updating registry...

REM Delete EasyTuneV - C:\Program Files (x86)\Gigabyte\ET5Pro\ETcall.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\EasyTuneVPro"

echo Updating icons...
call MoveFile "%pd\EasyTune5 Pro.lnk" "%pp\Operating System"
call MergeDir /q "%pp\Gigabyte" "%pp\Operating System\Other"

text
- Smart Fan, 28%-100% from 35c to 66c
endtext
call app EasyTune
pause

return

:XmlNotepad
REM http://www.microsoft.com/downloads/details.aspx?familyid=72d6aa49-787d-4118-ba5f-4f30fe913628&displaylang=en
text
************************
* XML Notepad
************************
endtext

gosub run "Microsoft\other\XmlNotepad.msi"

echo Updating icons...
call MoveFile "%ud\XML Notepad 2007.lnk" "%pp\Development\XML Notepad.lnk"
call MergeDir /q /rename "%up\XML Notepad 2007" "%pp\Development\Other\XML Notepad"


text
- Notes
  - Drag and drop files onto the XmlNotepad icon in QuickLinks
endtext

return

:PinnacleGameProfiler
REM Installs: PinnacleUpdateSvc
text
************************
* Pinnacle Game Profiler
************************
endtext

gosub run "PowerUp Software\Pinnacle Game Profiler\setup\Pinnacle Game Profiler v5.5.0.2.exe"

REM Delete Pinnacle Game Profiler - "C:\Program Files (x86)\PowerUp Software\Pinnacle Game Profiler\pinnacle.exe" -atboottime
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Pinnacle Game Profiler"

echo Updating services...
call service manual PinnacleUpdateSvc

echo Updating icons...
call DelFile "%pd\Pinnacle Game Profiler.lnk"
call MergeDir /q "%pp\Pinnacle Game Profiler" "%pp\Games\Other"

return

:GameJackal
text
************************
* GameJackal
************************
- Profile Key: oversoul 52918-39382-4145361111-13536
endtext

gosub run "SlySoft\Game Jackal\SetupGameJackal4117.exe"

echo Updating registry...
call registry import "%install\SlySoft\Game Jackal\Key.GameJackal.reg"

REM Delete Maplom - C:\Program Files\SlySoft\Game Jackal\GameJackal.exe /silent
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Maplom"

echo Updating icons...
call DelFile "%ud\Game Jackal.lnk"
call MergeDir /q "%pp\SlySoft" "%pp\Games\Other"
call CopyFile "%pp\Games\Other\SlySoft\Game Jackal\Game Jackal.lnk" "%pp\Games"

return

:GameTap
text
************************
* GameTap
************************
endtext

gosub run "GameTap\gametap_setup.exe"

echo Updating icons...
call DelFile "%pd\GameTap.lnk"
call MergeDir /q "%pp\GameTap" "%pp\Games\Other"
call CopyFile "%pp\Games\Other\TameTap\GameTap.lnk" "%pp\Games"

return

:mmc
REM MMC 3.0 supports .NET snap-ins
text
********************************
* Microsoft Management Console
********************************
endtext

REM MMC 3.0 comes with server and new clients
if defined NewOs .or. defined server return

gosub run "Microsoft\Windows\mmc\MMC V3.0 for Windows %_WinVer %@OsArchitecture[].exe"

echo Optimizing...
if "%@search[mmcperf]" != "" mmcperf

return

:FingerAuth
text
************************
* FingerAuth
************************
endtext

REM FingerCap driver supported only on x86
if "%@OsArchitecture[]" != "x86" return 1

REM Install the fingerprint reader driver
REM x64 support: http://forum.griaule.com/viewtopic.php?t=3884
gosub run "Mozilla\Firefox\extension\setup\FingerCap_USB_Driver_1.2_Installer.exe"

REM Install FingerAuth	
call Firefox "%install\Mozilla\Firefox\extension\setup\FingerAuth1.0.1.0.xpi"
pause
	
REM Restore the FingerAuth profile
call FingerAuth profile restore default

return

:IsoRecorder
text
************************
* ISO Recorder
************************
endtext

iff %@IsNewOs[] == 1 then
	gosub run "shareware\ISO Recorder\ISORecorder v3 %@OsArchitecture[].msi"
else
	gosub run "shareware\ISO Recorder\ISORecorder v2.msi"
endiff

return

:LimeWire
REM http://www.limewire.com
text
************************
* LimeWire
************************
endtext

REM LimeWire installs a JRE if not present
if not IsDir "%programs32\Java" gosub jre

gosub run "Shareware\LimeWire\LimeWireWin V5.4.6.exe"

echo Updating icons...
call MakeDir "%pp\Media\Other"
call MoveFile "%ud\LimeWire*.lnk" "%pp\Media\LimeWire.lnk"
call MergeDir /q "%up\LimeWire" "%pp\Media\Other"

text
- Notes
  - If connection not strong, File, Disconnect then File, Connect
endtext

return

:7zip
REM download http://www.7-zip.org/download.html
text
************************
* 7-Zip
************************
endtext

set prefix=7z922
set ExeBase=Shareware\7-Zip\setup\%prefix
set exe32=%ExeBase-x86.exe
set exe64=%ExeBase-x64.msi

REM x64 OS 32 bit programs use x86 7-zip when running, install x64 exe last so the 7-zip file manager icon is x64
gosub run "%exe32"
iff "%@OsArchitecture[]" == "x64" then
	echo %@ClipW[%programs\7-Zip\] >& nul:
	echo `- (ensure correct install location) *** Location, Browse, <paste> ***`
	gosub run "%exe64"
endiff

REM Update bin files
copy /q /u "%programs\7-zip\7-zip.chm" "%PublicData\bin\win32" >& nul:
copy /q /u "%programs32\7-zip\7z.exe" "%programs32\7-zip\7z.dll" "%PublicData\bin\win32" >& nul:
copy /q /u "%programs64\7-zip\7z.exe" "%programs64\7-zip\7z.dll" "%PublicData\bin\win64" >& nul:

echo Updating icons...
call MergeDir /q "%pp\7-Zip" "%ao"

text
- Tools, Options
  - System, select all Types, click + above All Users
  - Editor, C:\Program Files\Sublime Text 2\sublime_text.exe
  - Diff=C:\Program Files (x86)\Beyond Compare 3\BComp.exe
  - Settings, check Show system menu
endtext
call 7zip start
pause

return

:SetPoint
REM Change hot key function, configure mouse (pointer speed and acceleration, Smart Move), view battery level.
REM - Downloads: http://www.logitech.com/en-us/support/mice/wireless-mouse-m510
REM - Services:  
REM   - LMouFilt: Logitech SetPoint KMDF Mouse Filter Driver
REM   - LHidFilt: Logitech SetPoint KMDF HID Filter Driver
REM   - LBTServ: Logitech Bluetooth Service
REM - Startup: "%programs\Logitech\SetPoint\SetPoint.exe" /s
text
***************************************
* Logitech SetPoint (keyboard and mice)
***************************************
endtext

gosub run Logitech\SetPoint\setpoint651_%@OsArchitecture[].exe

echo Updating registry...

REM Delete EvtMgr6 - C:\Program Files\Logitech\SetPointP\SetPoint.exe /launchGaming
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\EvtMgr6"

echo Updating icons...
call MergeDir /quiet "%pp\Logitech" "%pp\Operating System\Other"
call DelFile.btm "%up\Startup\Logitech . Product Registration.lnk"
call DelFile.btm "%pd\Logitech Mouse and Keyboard Settings.lnk"
call DelFile.btm "%pp\Logitech SetPoint.lnk"

text
- Pointer and Scrolling Settings, Pointer Speed=2, Pointer Acceleration=Medium, 
endtext
start /pgm "%programs\Logitech\SetPointP\SetPoint.exe" /ss
pause

return

:LogitechWebCam
REM download http://www.logitech.com/index.cfm/435/3480&cl=us,en
REM updates "C:\Program Files\Common Files\logishrd\WUApp64.exe" -v 0x046d -p 0x0994 -b 0x0006 -f Video -d 11.80.1048.0 -m Logitech
REM
REM Version
REM  - Microsoft video camera driver used by default if LogitechWebcam not installed
REM  - Windows Update downloads  V11.4.0.1145 - driver only, did not crash system
REM  - Windows Update now downloads  QuickCam V11.80.1065 - driver and gui, stability not tested
REM  - QuickCam V11.5 software - drivers and GUI app, caused blue screen on Vista x64 when using GUI
REM  - QuickCam V11.90.1263 software - drivers and GUI app,  Worked fine on oversoul.
REM  - Webcam 1.00.1280 - testing on oversoul
REM 
REM Services:
REM LVCOMSer - Logitech Video COM Service
REM LVPrcSrv/LVPr64 - Process Monitor - Injector service
REM LVSrvLauncher - Launcher for Logitech Video Components.
REM 
REM Drivers:
REM  LVcKap/LVcKap64 - Logitech AEC Driver
REM LVMVDrv - Logitech Machine Vision Engine Loader
REM lvpopflt/lvpopf64 - Logitech POP Suppression Filter
REM LVPr2Mon/LVPr2M64 - Logitech LVPr2Mon Driver
REM lvrs/lvrs64 - Logitech RightSound Filter Driver
REM lvselsus/lvsels64 - Logitech Selective Suspend Filter
REM LVUSBSta/LVUSB64 - Logitech USB Monitor Filter
REM LVUVC/LVUVC64 - QuickCam Orbit/Sphere AF(UVC)
REM 
REM Run: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
REM LogitechCommunicationsManager - "C:\Program Files\Common Files\LogiShrd\LComMgr\Communications_Helper.exe"  - for advanced camera features
REM LogitechQuickCamRibbon - "C:\Program Files\Logitech\QuickCam\Quickcam.exe" /hide

text
************************
* Logitech Webcam
************************
endtext

gosub run "Logitech\Webcam\lws280_full.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Logitech" hide "%UserHome\Logitech"

echo Updating registry...

call registry.btm delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Logitech Download Assistant"

REM Delete LogitechQuickCamRibbon - "C:\Program Files\Logitech\QuickCam\Quickcam.exe" /hide
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\LogitechQuickCamRibbon"

REM Delete Logitech Vid- "C:\Program Files (x86)\Logitech\Logitech Vid\vid.exe" -bootmode
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Logitech Vid"

REM Delete LWS - C:\Program Files (x86)\Logitech\LWS\Webcam Software\LWS.exe -hide
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\LWS"

echo Updating icons...
set dest=%ao\Logitech\Logitech Webcam Software
call MergeDir /q /rename "%pp\Logitech" "%dest"
call MoveFile "%pd\Logitech Webcam Software*.lnk" "%dest"
call MoveFile "%pd\Logitech Vid HD.lnk"  "%dest"
call DelFile "%up\Startup\Logitech . Product Registration.lnk"

return

:WigginPrinter

iff %@IsWindows8[] == 1 then
	text
- Add a printer
- Windows Update
- Brother, Brother HL-4070CDW
- Printer name=study
- Do not share this printer
- Printer preferences
  - Layout, Print on Both Sides=Flip on Long Edge
  - Paper/Quality, Color=Black & White
	endtext
	call printer.btm add
	pause
	return 0

elseiff %@IsWindows7[] == 1 then
	text
- Add a network, wireless or Bluetooth printer
- Select HL-4070CWD series (Brother)
- Printer name=office (desktop) or wiggin (mobile)
- Do not share this printer
	endtext
	call printer.btm add
	pause
	return 0
endiff

echo Installing Brother HL-4070cdw...
call ask `Do you want to install the print monitor?` n
iff %? == 1 then
	gosub BrotherHl4070
else
	gosub run "Brother\HL-4070cdw\driver\deploy\Wiggin Printer %@OsArchitecture[].exe"		
	gosub BrotherHl4070Final
endiff

return

:BrotherHl4070
REM Driver: http://welcome.solutions.brother.com/bsc/public/us/us/en/dlf/download_top.html?reg=us&c=us&lang=pskillen&prod=hl4070cdw_all
REM Installs:(xp) BrPar service, BrSplService (Brother XP spl Service).   These services are not required to print, and caused the LAN drive to fail to start on jjbutare-mobl.
text
************************
* Brother HL-4070cdw
************************
- (Select Driver) Brother HL-4070CDW series
- (option) Custom Installation, check PS(PostScript Emulation) Driver
-	(Select Connection) Brother Peer-to-Peer Network Printer
- (Select a Printer) Uncheck Set by Node Name
- Printrs
  - Rename, printer
  - Properties, Printer Preferences...m Custom, Duplex/Booklet=Duplex
endtext

gosub run "Brother\HL-4070cdw\driver\Full V1.01\Driver\Inst\ENGLISH\setup.exe"
gosub run "Brother\HL-4070cdw\driver\Deployment Wizard V1.42.10\setup.exe"

echo Updating registry...
call registry import "%install\Brother\HL-4070cdw\driver\deploy\monitor.reg"

echo Updating icons...
set dest=%pp\Operating System\Other 
call MergeDir /q "%pp\Brother HL-4070CDW" "set src=%pp\Brother Personal Utilities"

gosub BrotherHl4070Final

return

:BrotherHl4070Final

REM Parallel port driver is not needed for new Windows operating systems
if %@IsNewOs[] == 0 call service demand BrPar

text
- Note: printer is installed to a printer port that specified the IP address explicitly.  
  Host file entries do not function correctly (no status updates and hung while printing).
  If the printer IP address changes, update the printer port with the new IP address.
endtext

return

:GraphEdit
text
**********************************
* DirectShow SDK Filter Graph Edit
**********************************
endtext

gosub FindExe "Microsoft\DirectX\GraphEdit\GraphEdit Setup x86.reg"
if %_? != 0 return %_?

REM Filter property pages
regsvr32 /s "%PublicBin\x86\PropPage.dll"
call registry import "%exe"

echo Updating icons...
call MakeDir "%pp\Media\Other"
call MakeShortcut "%PublicBin\win32\GraphEdit.exe" "%pp\Media\Graph Edit 32.lnk"

echo Configuring x64 filter support...
iff "%@OsArchitecture[]" == "x64" then
	regsvr32 /s "%PublicBin\x64\PropPage.dll"
	call registry import "%ExeDir\GraphEdit Setup x64.reg"
	call MakeShortcut "%PublicBin\win64\GraphEdit.exe" "%pp\Media\Graph Edit 64.lnk"
endiff

return

:CoreAVC
REM https://customers.corecodec.com/
text
****************************************
* CoreAVC - H.264 Multi-core video codec
****************************************
- Uncheck Haali
endtext

gosub run "CoreCodec\CoreAVC\CoreAVC Professional v3.0.1.0.exe"

echo Updating icons...
call MergeDir /q "%pp\CoreCodec" "%pp\Media\Other"

return

:K-Lite
REM Software based codec package (mpeg-2, H.264, DivX), x86 explorer thumbnail generation
REM Download Mega: http://www.codecguide.com/ http://www.codecguide.com/klcp_64bit.htm
text
************************
* K-Lite Codec Package
************************
endtext

iff IsDir "%programs32\K-Lite Codec Pack" .or. IsDir "%programs64\KLCP64" .or. IsDir "%programs32\QuickTime Alternative" then
	echo - Uninstall K-Lite and QuickTime Alternative
	call os programs
	pause
endiff

echo.
echo Installing K-Lite x86 codecs...
set RunOptions=/silent /norestart /LoadInf=".\klmcp.ini"
gosub run "Shareware\K-Lite\K-Lite Mega Codec Pack V4.4.5.exe"
if %_? != 0 return %_?

iff "%@OsArchitecture[]" == "x64" then
	echo.
	echo Installing K-Lite x64 codecs...
	
	gosub run "Microsoft\Visual Studio\redistributable\vcredist_x64.exe"	
	if %_? != 0 return %_?
	
	gosub run "Shareware\K-Lite\K-Lite Codec Pack x64 V1.6.2.exe"
	if %_? != 0 return %_?
	
endiff

REM QuickTime Lite - install if QuickTime is not installed
iff not IsDir "%programs32\QuickTime" then
	echo.
	echo Installing QuickTime Lite (required for QuickTime VR)...
	set RunOptions=/norestart /LoadInf=".\quicktimealt.ini"
	gosub run "Shareware\K-Lite\quicktimealt270.exe"
	if %_? != 0 return %_?
endiff

echo Updating icons...
call MakeDir "%pp\Media\Other"
call MergeDir /q "%pp\K-Lite Codec Pack" "%pp\Media\Other"
call MergeDir /q "%pp\K-Lite Codec Pack x64" "%pp\Media\Other"
call MergeDir /q "%pp\QuickTime Alternative" "%pp\Media\Other"

REM Configure FFDShow Video
text

Configuring ffdshow video decoder...
- MPEG2=libavcodec (Windows MPEG2 codec stutters)
endtext
call FFDShow 32 configure video
if "%@OsArchitecture[]" == "x64" call FFDShow 64 configure video
pause

REM Configure Haali splitter
text

Configuring Haali Media Splitter...
- Options
  - (optional) Compatiblity, Autoload VSFilter=No
  - Input 
    - Input buffer size=16192 (or 32000, for audio stutter on high bitrate video)
    - Number of TS packets to scan=90000 ( prevent stutter on some computers for MP4 transport stream)
  - Output, Decode priority boost=On (to prevent stutter on some computers) 
endtext
call haali configure
pause


text
- Notes
  - Useful filters (set while video is playing or in ffdshow video decoder configuration):
    - OSD (On Screen Display), Deinterlacing
endtext

return

REM Wireshark - Network packet capture and analyzer
REM http://www.wireshark.org/download.html
REM driver - NPF (Network Packet Filter, installed with WinPCAP, if stopped must be started manually, or wun WireShark as administrator)
:Wireshark
text
************************
* Wireshark
************************
endtext

gosub run "Shareware\WireShark\setup\wireshark-win%@OsBits[]-1.8.3.exe"
 
echo Updating icons...
call MoveFile "%pp\Wireshark.lnk" "%pp\Operating System"
call MergeDir /q "%pp\Wireshark" "%pp\Operating System\Other"
call MergeDir /q "%pp\WinPcap" "%pp\Operating System\Other"

echo Updating services...
call service manual NPF

text
- View, Name Resolution, Enable for Network Layer
endtext

return

REM Nmap - port analyzer
:Nmap
text
************************
* Nmap
************************
endtext

gosub run "Shareware\NMap\nmap-4.68-setup.exe"

echo Updating icons...
call MergeDir /q "%up\Nmap" "%pp\Operating System\Other"
call MoveFile "%ud\Nmap - Zenmap GUI.lnk" "%pp\Operating System"

return

:MediaInfo
text
************************
* MediaInfo
************************
endtext

gosub run "Shareware\MediaInfo\setup\MediaInfo_0.7.7.1_GUI_Win32.exe"

echo Updating icons...
call MakeDir "%pp\Media\Other"
call MergeDir /q "%up\MediaInfo" "%pp\Media\Other"


text
- Setup
  - Output format=Tree
  - Check Shell InfoTip
endtext

return

:Skype
REM http://www.skype.com/go/getskype-full, http://download.skype.com/msi/SkypeSetup_6.3.0.105.msi
REM http://www.skype.com/business/products/software/
text
************************
* Skype
************************
- Options, uncheck Install Skype Extras Manager
endtext

REM call ask.btm `Install beta? ` n
set prefix=SkypeSetup_%@if[ 0 == 1 ,NA,6.3.0.105]
gosub run "Microsoft\Skype\setup\%prefix.exe"
call skype close

echo Updating registry...

REM Delete Skype - "C:\PROGRAM FILES (X86)\SKYPE\PHONE\SKYPE.EXE" /nosplash /minimized
call registry.btm 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Skype"

echo Updating icons...
call MoveFile "%pd\Skype.lnk" "%pp\Applications"
call MergeDir /q "%pp\Skype" "%ao"

text
- Tools, Options
  - Video settings, Webcam settings
    - Webcam control, adjust pan and tilt
    - Advanced Settings, uncheck right light, uncheck Gain Auto, 
  - Advanced, uncheck Show Skype watermark during calls
  - Advanced, Connection, uncheck use port 80 and port 443
endtext

return

:PrimoPDF
text
************************
* PrimoPDF - Create PDF
************************
endtext

gosub run "Nitro PDF\InternationalPrimoPDF.exe"

echo Updating icons...
call MergeDir /q "%pp\PrimoPDF" "%ao"
call MoveFile "%pd\PrimoPDF - Drop Files Here to Convert!.lnk" "%ao\PrimoPDF"

return

:FileZilla
text
************************
* FileZilla
************************
- Uncheck Shell Extension
endtext

gosub run "Shareware\FileZilla\setup\FileZilla_3.7.0.2_win32-setup.exe"

echo Updating icons...
call MergeDir /q "%pp\FileZilla FTP Client" "%pp\Operating System\Other"

echo Moving configuration data to the cloud...
call DropBox MoveConfig "%AppData\FileZilla" "%CloudData\FileZilla"

text
- Edit, Settings
  - (Intel network) Connection, FTP, FTP Proxy
    - Type of FTP Proxy=USER@HOST
    - Proxy host=proxy.fm.intel.com
  - Transfers, Maximum simultaneous transfers=10
endtext
call FileZilla
pause

return

:HdTune
text
************************
* HD Tune
************************
endtext

gosub run "Shareware\HD Tune\hdtune_255.exe"

echo Updating icons...
call DelFile "%ud\HD Tune.url"
call MergeDir /q "%pp\HD Tune" "%pp\Operating System\Other"

return

:SqlPrettyPrinter
text
************************
* SQL Pretty Printer
************************
endtext

gosub run "Gudu Software\SQL Pretty Printer\setup v2.9.0.msi"

echo Updating icons...
call MoveFile "%ud\SQL Pretty Printer.lnk" "%pp\Development"
call MergeDir /q "%up\SQL Pretty Printer" "%pp\Development\Other"


text
- SQL / Code Options, Setup New Hotkey
- Notes
  - Select text in any program and Ctrl-Alt-Backspace to format
endtext
start /pgm "%programs32\Gudu Software\SQL Pretty Printer\sqlpp.exe"

return

:TrueCrypt
REM download - http://www.truecrypt.org/downloads
text
************************
* TrueCrypt
************************
endtext

gosub run "Shareware\TrueCrypt\TrueCrypt Setup 7.1a.exe"

call MakeDir "%UserHome\Documents\data\TrueCrypt"

echo Updating icons...
call MergeDir /q "%pp\TrueCrypt" "%ao"
call MergeDir /q "%up\TrueCrypt" "%ao"
call DelFile "%ao\TrueCrypt\TrueCrypt Website.url"
call DelFile "%ao\TrueCrypt\Uninstall TrueCrypt.lnk"
call DelFile "%pd\TrueCrypt.lnk"

text
- Settings, Hot Keys...
  - Mount Favorite Volumes - Control+Shift+Alt+F2
  - Dismount All - Control+Shift+Alt+F3
  - Force Dismount All, Wipe Cache & Exit - Control+Shift+Alt+F4
- Settings, Preferences
  - Uncheck Preserve modification timestamp of file containers
  - Check Cache passwords in driver memory
  - Uncheck Wipe cached passwords on auto-dismount and exit
- T:, Select File..., data\TrueCrypt, personal.tc, Mount
- Favorites, Add Mounted Volumes to Favorites...
  - Label of selected favorite volume=Personal
endtext
call sudo /standard TrueCrypt start
pause

return

:SecretAgent
text
************************
* SecretAgent
************************
endtext

gosub run "Information Security Corporation\SecretAgent\SA594.EXE"

echo Installing OpenPGP interoperability...
call CopyFile "%install\Information Security Corporation\SecretAgent\OpenPGP Interoperability\gpgisc.dll" "%programs32\SecretAgent 5"

echo Updating icons...
call DelFile "%pd\SecretAgent 5.lnk"
call MergeDir /q "%pp\SecretAgent 5" "%ao"


text
- Microsoft CryptoAPI Token Configuration: select certificate to use for Encryption and Signin
endtext

return

:Paint.NET
REM http://www.getpaint.net/download.html
text
************************
* Paint.NET
************************
endtext

gosub run "Shareware\Paint.NET\Paint.NET.3.36.exe"

echo Updating icons...
call DelFile "%pd\Paint.NET.lnk"
call MoveFile "%pp\Paint.NET.lnk" "%pp\Media"

return

:CrystalReportsServer11
text
****************************
* Crystal Reports Server 11
****************************
- Prerequisite:  SQL Server database named CMS
- Install Type=New, Use an existing database server
- CMS Database Information, Browse,  Machine Data Source, New..., System, Select a type of data source=System Data Source, 
  Select a driver=SQL Server, Name=CMS, Server=<db server>, Change the default database to=CMS
- Choose Web Component Adapter Type, check only IIS ASP.NET
endtext

gosub run "sap\Crystal Reports\Server XI Release 2 SP2\Setup.exe"

echo.
echo - Custom, uncheck all except Microsoft_SQL_Server_Wire_Protocol_Driver and Core
gosub run "sap\Crystal Reports\Data Drivers v5.1\setup.exe"

echo Updating icons...
call MergeDir /q "%pp\Business Objects" "%pp\Development\Other"


text
- Notes:
  - Default account: User Name=Administrator, Password=<blank>
  - Crystal Central Configuration Manager  control Crystal Report Server services
  - Crystal Import Wizard  import report files
  - Crystal Central Management Console  manage Crystal Report Server, including add/remove users, reports, plugins
endtext

return

:OsLoader
text
************************
* OS Loader 2000
************************
- Installation replaced MBR with an MBR Boot Manager
endtext

REM Copy install dir
set InstallDir=%programs32\OS Loader 2000
gosub run "OS Loader 2000\setup"

REM Install OS Loader 2000 in the MBR
call OsLoader setup

REM Register OS Loader 2000
call OsLoader register
	
text
- reboot, OS Loader menu
  - F2(Timer)=5
  - F3 (Options) 
    - Check AutoHide Parittions
    - Uncheck CD-Rom Boot Instructions
  - Select default partition, ctrl-f2
- reboot, BIOS: Boot, Hard Disk then CD-ROM
- reboot, run OsLoader.btm register
- Notes
  - Hold down shift, ctrl or alt key during system startup to bypass the boot menu.
  - OS installation: turn off AutoHide and hide all primary partitions except desired
endtext

return

:BioShock
text
************************
* BioShock
************************
endtext

echo Insert the BioShock DVD and run setup...
pause

call run "2K\BioShock\update\Bioshock Version 1.1 Patch Worldwide Retail.exe"

text
Creating Game Jackal profile...
- Create a Profile
- Profile name=BioShock
- Locate title=C:\Program Files\2K Games\BioShock\Builds\Release\Bioshock.exe
- Exit BioShock
endtext
call GameJackal start
pause


text
- Update BioShock.btm with Game Jackal Profile ID
- Graphics Options
  - Resolution=1280x768
  - Adjust Brightness
- Customize Controls, Use XBox 360 Controller
endtext

return

:Steam
text
************************
* Steam
************************
endtext

gosub run "Valve\Steam\SteamInstall.msi"

echo - close Steam
pause

echo Moving data folders...
call MakeLink merge "%UserData\Steam" "%programs32\Steam\steamapps"
call MakeLink merge "%UserDocuments\game\Amnesia" hide "%UserDocuments\Amnesia"

echo Updating registry...

REM Delete Steam - "C:\Program Files (x86)\Steam\Steam.exe"
call registry.btm 32 delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Steam"

echo Updating icons...
call MoveFile "%pd\Steam.lnk" "%pp\Games"
call MergeDir /q "%pp\Steam" "%pp\Games\Other"
call MergeDir /q "%up\Steam" "%pp\Games\Other"

return

:BeyondCompare
:bc
REM download - http://www.scootersoftware.com/download.php
REM plugins - http://www.scootersoftware.com/download.php?zz=kb_moreformats&cartid=482293831
REM license setup - http://www.scootersoftware.com/support.php?zz=kb_netsetup
text
************************
* Beyond Compare
************************
- Uncheck Launch Beyond Compare 3
endtext

gosub run "Scooter Software\Beyond Compare\setup\BCompare-3.3.8.16340.exe"
gosub run "Scooter Software\Beyond Compare\plugins\AllPlugins.exe"

echo Updating icons...
call MergeDir /q /rename "%pp\Beyond Compare 3" "%ao\Beyond Compare"
call MoveFile "%ao\Beyond Compare\Beyond Compare 3 Help.lnk" "%ao\Beyond Compare\Beyond Compare Help.lnk"
call MoveFile "%ao\Beyond Compare\Beyond Compare 3.lnk" "%ao\Beyond Compare\Beyond Compare.lnk"
call DelFile "%ao\Beyond Compare\Uninstall Beyond Compare 3.lnk"
call DelFile "%pd\Beyond Compare 3.lnk"


echo Restoring the default profile...
call BeyondCompare profile restore default

echo Moving data folder...
call MakeLink merge "%UserData\.jalopy.15" hide "%UserHome\.jalopy.15"

text
- Help, Enter Key..., check Register for all users, paste key
endtext
call sudo /standard BeyondCompare start
pause

return

:WinMerge
:wm
REM http://winmerge.org/
REM http://freemind.s57.xrea.com/xdocdiffPlugin/en/index.html
text
************************
* WinMerge
************************
- Check Plugins
endtext

gosub run "Shareware\WinMerge\WinMerge-2.12.4-Setup.exe"

set prefix=%install\Shareware\WinMerge

echo Creating directories...
call MakeDir "%UserDocuments\data\WinMerge\Filters"

echo Updating icons...
call MergeDir /q "%pp\WinMerge" "%ao"

echo Installing plugins...

REM xdocdiff does not work with new office document formats
REM call CopyFile "%prefix\xdocdiffPlugin_1_0_6b\xdoc2txt.exe" "%programs32\WinMerge"
REM call CopyFile "%prefix\xdocdiffPlugin_1_0_6b\zlib.dll" "%programs32\WinMerge"
REM call CopyFile "%prefix\xdocdiffPlugin_1_0_6b\MergePlugins\amb_xdocdiffPlugin.dll" "%programs32\WinMerge\MergePlugins"

if IsDir "%programs32\7-Zip" call CopyFile "%prefix\7zip\7zip_pad.xml" "%programs32\7-Zip"
if IsDir "%programs64\7-Zip" call CopyFile "%prefix\7zip\7zip_pad.xml" "%programs64\7-Zip"

echo Configuring...
echo %@ClipW[%install\Shareware\WinMerge\WinMerge Default Profile %@OsArchitecture[].ini] >& nul:
text
- Edit, Options
  - Import..., <paste>
  - General
    - Check Automatically scroll to first difference
    - Check Disable Splash Screen
    - Uncheck Close windows with ESC
    - Open-dialog Auto-Completion=From file system
  - System
    - External editor=%programs32\Notepad++\notepad++.exe
    - Filter folder=%UserData\WinMerge\Filters
  - Backup Files, uncheck File compare
  - Shell Integration, check Enable advanced menu 
- Plugins, List..., check Enable plugins
- Plugins, Automatic Unpacking
- Plugins, Reload plugins
- (if present) Help, Archive Support disabled...
  - Ensure 7-Zip and Merge7z457U.dll are found
- Notes:
  - Alt Up/Down - previous/next change
  - Alt Left/Right - move change from left to right file or vice versa
EndText
call WinMerge start

return

:Sandra
text
************************
* Sandra Benchmark
************************
endtext

gosub run "SiSoftware\Sandra\san1560.exe"

echo Updating icons...
call MoveFile "%pd\SiSoftware Sandra Lite 2009.SP1.lnk" "%pp\Operating System"
call MergeDir /q "%pp\SiSoftware" "%pp\Operating System\Other"


text
endtext

return

:Defraggler
text
************************
* Defraggler
************************
endtext

gosub run "Piriform\Defraggler\dfsetup116.exe"

echo Updating icons...
call DelFile "%ud\Defraggler.lnk"
call MergeDir /q "%up\Defraggler" "%pp\Operating System\Other"

return

:PerfectDisk
REM http://www.raxco.com/products/downloadit/perfectdisk_download.cfm
REM Installation MSI is saved to %programs32\Raxco\PD80Install for repairs
REM Services: PD91Agent
text
************************
* PerfectDisk
************************
- Do not register or check for updates
endtext

gosub run "Raxco\setup v10.00.114\Install.exe"
gosub run "Raxco\update\PD10ENp_%@OsArchitecture[].exe"

echo Updating services...
call service manual PDAgent

echo Updating icons...
call MoveFile "%pp\PerfectDisk 10.lnk" "%pp\Operating System"
call MoveFile "%pp\PerfectDisk 11.lnk" "%pp\Operating System"
call DelFile "%pd\PerfectDisk 10.lnk"
call DelFile "%pd\PerfectDisk 11.lnk"

text
- Select schedule type, none
- PerfectDisk Settings, 
  - General, Close button behavior=Exit PerfectDisk
  - System Resource Priority
    - CPU Priority=Below normal
    - Disk I/O, check Monitor and throttle
endtext
call PerfectDisk.btm start

return

:Mp3tag
REM http://www.mp3tag.de/en/
text
************************
* MP3tag
************************
endtext

gosub run "Shareware\Mp3Tag\mp3tagv252setup.exe"

echo Updating icons...
call MoveFile "%pd\Mp3tag.lnk" "%pp\Media"
call MergeDir /q "%pp\Mp3tag" "%pp\Media\Other"


text
- Add extended columns as needed, i.e. Rating=%rating wmp%
endtext

return

:FreeClip
REM http://m8software.com/clipboards/freeclip/freeclip.htm
text
************************
* Free Clip
************************
endtext

gosub run "Shareware\FreeClip\freeclip.exe"

echo Updating icons...
call DelFile "%ud\Spartan.lnk"
call MergeDir /q "%up\M8 Free Multi Clipboard" "%ao"

text
- Tools, Options
  - Use key=F12
  - Check Skip "Are you sure" dialog when permanently deleting
  - Uncheck Sound when new clips are cpatured
- Notes: F12 to show, click to paste
endtext

return

:HDHomeRun
REM Updates: http://www.silicondust.com/downloads
REM Instructions: http://www.silicondust.com/support/hdhomerun/instructions/
REM Zap2It: http://tvlistings.zap2it.com/tvlistings/ZCGrid.do?zipcode=87109
REM Lineup: http://www.silicondust.com/hdhomerun/lineup_web/US:87109#lineup_341416
REM Enables: WMC Capture Device Service and Windows Media Center Receiver Service
text
************************
* HDHomeRun Tuner
************************
endtext

gosub run "SiliconDust\HDHomeRun\setup\hdhomerun_windows_20100609beta1.exe"

echo Updating icons...
call DelFile "%pp\Startup\HDHomeRun Manager.lnk"
call MergeDir /q "%pp\HDHomeRun" "%pp\Media\Other"
call MergeDir /q "%pp\GuideTool" "%pp\Media\Other"
call MergeDir /q "%up\GuideTool" "%pp\Media\Other"

echo Updating tasks...
SchTasks /Change /Tn "updater.exe" /Disable >& nul:
SchTasks /Create /RU %@SystemAccount[] /RP * /SC OnIdle /I %SleepTaskIdleTime /TN "sleep" /TR "%@sfn[%PublicDocuments\data\bin\]\tcc.exe /c SleepTaskSleep.btm"

text
- Location, Country=United States, Zip/Postal Code=87109
- Application, Mainn Application=Windows Media Center, Preview Application=Windows Media Player
- Tuners, Source=Digital Cable
- Digital Cable, Scan
  - Zap2It Website, ZIP=87109, provider=Comcast - Digital
  - View
    - Check only desired channels
    - Guide Number=<zap2it channel number (except for digital channels, such as 2.1)>
    - Guide Name=<zap2it channel name>
endtext
call HdHomeRun.btm start
pause

text
- Tasks, Settings, TV
  - TV Signal, Set Up TV Signal
	- Guide, Edit Channels, Show Preview, check desired unlocked (unencrypted) channels
    - Note: scroll with page and arrow up/down
- TV, guide, click each channel (2nd column), Edit Channel
  - Find the channel in zap2it by comparing:
    - WMC channel number with HDHomeRun Setup Tune / Guide Number / GuideName
    - current program in the preview with zap2it current program
	- Channel number=<zap2it channel number (except for digital channels, such as 2.1)>
  - Rename, name=<zap2it channel name>
	- Edit Listings
    - type first few letters of channel name (i.e. kasa)
    - select correct listing (validate current listing with program in the preview)
    - validate 
  - Recorder, Recorder Storage, Record on drive=D:
endtext
call WindowsMediaCenter.btm start
pause

return

:ExtensionColumn
text
************************
* Extension Column
************************
endtext

if defined NewOs return 1

gosub FindExe "Shareware\Extension Column\setup %@OsArchitecture[]"
if %_? != 0 return %_?

echo Right click on CPExt.info and select Install
call explorer.btm "%exe"
pause

call registry import "%ExeDir\setup.reg"

text
- Columns, More..., check Ext
- Columns: Name, Size, Ext, Type, Data Modified
- Tools, Folder Options, View, Apply to All Folders
endtext 
call explorer.btm restart
call explorer.btm c:\
pause

return

:MceStandbyTool
REM download: http://slicksolutions.eu/mst.shtml
REM windows 7: http://www.degroeneknop.nl/forum/index.php/topic,4989.0/all.html
text
************************
* MCE Standby Tool
************************
endtext

gosub run "Shareware\MCE Standby Tool\setup\mst09098.exe"

echo Updating registry...

REM Delete MCE Standby Tool - "C:\Program Files (x86)\MCE Standby Tool\mst.exe" engine
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\MCE Standby Tool"

text
- Reboot, check Do not force reboots
- USB, Unacheck Disable selective USB suspend 
endtext

return

:QualityCenter
text
************************
* Quality Center
************************
endtext

gosub run "Hewlett Packard\Quality Center\QCExplorerAddIn.exe"

echo Updating icons...
call MergeDir /q "%pp\Quality Center" "%ao"
call CopyFile "%ao\Quality Center\QCExplorer.lnk" "%pp\Applications\QualityCenter.lnk"

echo Address=http://qualitycenterrr.intel.com:8080/qcbin/start_a.htm

return

:Foglight
text
************************
* Foglight
************************
endtext

gosub run "Quest Software\Foglight\setup\setup.exe"

echo Updating icons...
call MergeDir /q "%pp\Quest Software" "%pp\Operating System\Other"
call MoveFile "%pd\4.2 Foglight Operations Console.lnk" "%pp\Operating System\Foglight.lnk"

return

:Easy2Sync
REM download: http://www.easy2sync.com/en/produkte/e2s4o_down_ex.php
REM archive: http://www.easy2sync.com/en/produkte/e2s4o_down_ver.php
text
************************
* Easy2Sync
************************
- Close Easy2Sync
endtext

gosub run "ITSTH\Easy2Sync\Easy2Sync Business v4.00.exe"

echo Restoring the default profile...
call Easy2Sync.btm profile restore default

echo Updating icons...
call MergeDir /q "%pp\Easy2Sync for Outlook" "%ao"

text
- Tools, Options, Confirm when, check When syncronizing a task for the first time, enable ALL confirmations
- New..., New Task...
  - What=Syncronize (Calendar Copy Intel to Wiggin)
  - Which Date=Contacts, (optional) Contacts, Notes, Tasks
  - With what=Local file or shared file in the local network
    - Search manually
    - Select PST file=\\oversoul\John\Documents\data\mail\home.pst
		- Select Contacts|Calendar|Notes|Tasks
  - Ready to sync!
    - This task will be saved as=contacts|calendar|contacts|notes|tasks
	  - Uncheck Start synchronizing when I click on "Finish".
  - Select task, Edit..., 
    - Data storages, Choose data storage...
      - Data storage 1|2, Passwords, Icons, Shortname..., Computer name=Intel|Wiggin
endtext
pause

echo Saving profile changes...
call Easy2Sync.btm profile backup

return

:WindowsLiveEssentials
:WindowsLive
:wle
REM http://download.live.com
REM Includes: Messenger, Mail, PhotoGallery, Toolbar, Writer, Family Safety, Add-In
text
************************
* Windows Live Essentials
************************
- Check Photo Gallery, Live Write
- (optional) Check other application as needed
endtext

gosub run "Microsoft\Live\wlsetup-web.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Live Writer" hide "%UserDocuments\My Weblog Posts"

echo Updating icons...
call MergeDir /q "%pp\Windows Live" "%ao"
call MoveFile "%pp\Windows Live ID.lnk" "%pp\Applications"
call MoveFile "%pd\Windows Live Messenger.lnk" "%ao\Windows Live"
call MoveFile "%pp\Windows Live Movie Maker.lnk" "%ao\Windows Live"
call MoveFile "%pp\Windows Live Photo Gallery.lnk" "%ao\Windows Live"

return

:radioSHARK
text
************************
* radioSHARK
************************
endtext

gosub run "Griffin Technology\radioSHARK\radioSHARK_v2.1.exe"

echo Restoring the default profile...
call radioSHARK.btm profile restore default

echo Updating icons...
call MergeDir /q "%pp\Griffin Technology" "%ao"
call DelFile "%up\Startup\radio SHARK Scheduler.lnk"

echo - Recording, Show Disabled Devices, radioSHARK, Enable
call os.btm sound
pause

text
- Configuration
  - Record & Playback, Quality=Best
  - Startup, uncheck Check for updates at startup and Stay in Systray on close
endtext
call radioSHARK.btm start
pause

return

:Airfoil
text
************************
* Airfoil
************************
endtext

echo DO NOT INSTALL - causes programs to launch in a suspended state
return 0

gosub run "Rogue Amoeba\Airfoil\Airfoil v2.7.5.exe"

echo Updating icons...
call MergeDir /q "%pp\Griffin Technology" "%ao"

iff "%@domain[]" != "" then
	echo - Inbound Rules, Airofoil and Airfoil speakers, Advanced, check Domain (4 rules
	call firewall console
	pause
endiff

echo Updating icons...
call DelFile "%pd\Airfoil.lnk"
call DelFile "%pd\Airfoil Speakers.lnk"
call MergeDir /q "%pp\Airfoil" "%pp\Media\Other"

text
- Interface, check Show Airfoil icon in system tray and Minimize Airfoil to system tray
- Startup, Automatically transmit to, check all
endtext
call AirFoil.btm start

return

:ProtectorSuite
REM Does not allow individual component installation, and password component nags to buy full version
text
************************
* Protector Suite
************************
endtext

gosub run "UPEK\Protector Suite for Windows 7 Build 5668 x86\setup.msi"

echo Updating icons...
call MergeDir /q "%pp\Protector Suite" "%pp\Operating System\Other"

return

:SoundSpectrumNotes

text
- Notes
  - WMP: ~10% CPU utilization, 32bit only, not all shortcut keys function
  - iTunes: ~30% CPU utilization
- Shortcuts
	- Information
		- [shfit] h=documentation/help
		- [shift] t=[auto] trackinfo
		- l=list current configs
		- r=frame rate
	- Other
		- \=hide console
    - u=reload and recreate current config
		- v=verbose
		- escape/shift return=full screen	
		- m=full screen resolution
		- `=snapshot
		- -+/[]=music response/preamp
		- qwe/asd/zxc=prev/next/slideshow ColorScheme/Background/WaveShape
		- f/g=slideshows off/on
		- 1,2,...=preset
endtext

return

:Aeon
REM http://www.soundspectrum.com/aeon/download.html
REM http://www.soundspectrum.com/support/download_products.html
REM http://www.soundspectrum.com/aeon/Documentation/version-history.html
text
************************
* Aeon
************************
endtext

gosub run SoundSpectrum\Aeon\Aeon_101_Platinum.exe

echo Updating icons...
call MergeDir /q "%pp\Aeon" "%pp\Media\Other"

gosub SoundSpectrumNotes

return

:WhiteCap
REM http://www.soundspectrum.com/whitecap/Documentation/version-history.html
REM http://www.soundspectrum.com/support/download_products.html
text
************************
* WhiteCap
************************
endtext

gosub run SoundSpectrum\WhiteCap\WhiteCap_571_Platinum.exe

echo Updating icons...
call MergeDir /q "%pp\WhiteCap" "%pp\Media\Other"
call DelFile "%pp\Media\Other\WhiteCap\SoundSpectrum Website.url"

gosub SoundSpectrumNotes

return

:LogParser
text
************************
* Log Parser
************************
endtext

gosub run "Microsoft\Log Parser\setup\LogParser.msi"
gosub run "Microsoft\Log Parser\setup\logparserlizardsetup.msi"

echo Updating icons...
call MergeDir /q "%pp\Log Parser 2.2" "%pp\Development\Other"
call MergeDir /q "%up\Log Parser Lizard" "%pp\Development\Other"

return

:Saba
text
************************
* Saba
************************
endtext

call saba.btm install all

return

:DesktopGadgets
text
***************************
* Windows Desktop Gadgets
***************************
endtext

set d=Microsoft\Windows\gadgets\setup

iff %@IsIntelHost[] == 1 then
	for file in (%SharedDocuments\data\install\Intel\gadgets\*.gadget) gosub run "%file"
endiff

pause

text
- Gadgets, Clock, Weather
endtext
call os.btm gadget show
pause

return

:HttpWatch
REM http://www.httpwatch.com/download/
text
************************
* HttpWatch
************************
endtext

gosub run "Simtec\httpwatch.exe"

echo Updating icons...
call MergeDir /q "%pp\HttpWatch Basic Edition" "%pp\Development\Other"

return

:Fiddler
REM http://www.fiddler2.com/fiddler2/
text
************************
* Fiddler
************************
endtext

REM gosub run "Shareware\Fiddler\Fiddler 2 Setup v2.3.6.4.exe"
gosub run "Shareware\Fiddler\Fiddler4BetaSetup.exe"
gosub run "Shareware\Fiddler\FiddlerSyntaxSetup.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Fiddler2" hide "%UserDocuments\Fiddler2"

echo Updating icons...
call MakeDir "%pp\Development\Fiddler\Other"
call MoveFile "%pp\Fiddler2.lnk" "%pp\Development\Other\Fiddler"
call MoveFile "%up\Fiddler2 ScriptEditor.lnk" "%pp\Development\Other\Fiddler"

return

:NirSoftLauncher
REM http://blog.nirsoft.net/2009/08/15/nirsoft-launcher-is-in-development-process/
text
************************
* NirSoftLauncher
************************
endtext

set InstallDir=%PublicDocuments\programs\NirSoft Launcher
gosub run "Shareware\NirSoft\NirSoft Launcher v1.00 beta.7z"

call MakeShortcut "%PublicDocuments\programs\NirSoft Launcher\NirLauncher.exe" "%pp\Operating System\NirSoft Launcher.lnk"

return

:LiberKey
REM http://www.liberkey.com/en/
text
************************
* LiberKey
************************
endtext

set InstallDir=%PublicDocuments\programs\LiberKey
gosub run "Shareware\LiberKey\LiberKey v4.5.zip"

call MakeShortcut "%PublicDocuments\programs\LiberKey\LiberKey.exe" "%pp\Applications\LiberKey.lnk"

return

:Defraggler
text
************************
* Defraggler
************************
endtext

gosub run "Shareware\Defraggler\dfsetup115.exe"

echo Updating icons...
call MergeDir /q "%up\Defraggler" "%pp\Operating System\Other"
call MoveFile "%pd\Defraggler.lnk" "%pp\Operating System"

return

:MyDefrag
text
************************
* MyDefrag
************************
endtext

echo - Remove previous versions
call os.btm programs
pause

set version=4.2.7
gosub run "Shareware\MyDefrag\setup\MyDefrag-v%version.exe"

echo Updating icons...
call MergeDir /q "%pp\MyDefrag v%version" "%pp\Operating System\Other"
call MoveFile "%pd\MyDefrag.lnk" "%pp\Operating System"
return

:Gears
text
************************
* Gears
************************
endtext
gosub run "Google\Gears\GearsSetup.exe"
return

:WindowsDriverKit
text
************************
* Windows Driver Kit
************************
- Check Full Development Environment
- Install Path=%LocalCode\WinDDK\7600.16385.0\
endtext

gosub run "Microsoft\Windows\Driver Kit\en_windows_driver_kit_for_windows_7_and_windows_server_2008_r2_x86_x64_ia64_dvd_400380.iso"

echo Updating icons...
call MergeDir /q "%pp\Windows Driver Kits" "%pp\Development\Other"

return

:Smilebox
text
************************
* Smilebox
************************
endtext

gosub run "Smilebox\SmileboxInstaller.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Smilebox" hide "%UserDocuments\My Smilebox Creations"

echo Updating registry...

REM Delete SmileboxTray - "C:\Users\jjbutare\AppData\Roaming\Smilebox\SmileboxTray.exe"
call registry.btm delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SmileboxTray"

echo Updating icons...
call DelFile "%ud\Smilebox.lnk"
call MoveFile "%up\Smilebox.lnk" "%pp\Applications"

return

:ImageMagick
REM - download http://www.imagemagick.org/script/binary-releases.php#windows
REM Graphic editing with command line and COM interfaces
text
************************
* ImageMagick
************************
- Check ImageMagickObject OLE Control
endtext

gosub run "shareware\ImageMagick\setup\ImageMagick-6.7.3-7-Q16-windows-%@OsArchitecture[]-static.exe"

echo Updating icons...
call DelFile "%ud\ImageMagick Display.lnk"
call MergeDir /q /rename "%pp\ImageMagick 6.7.3 Q16" "%pp\Media\Other\ImageMagick"

return

:SubsystemForUnix
:sfu
:sua
REM - Utilities and SDK: http://www.microsoft.com/downloads/en/details.aspx?FamilyID=dc03485b-629b-49a6-b5ef-18617d1a9804
REM - SUA packages: http://www.suacommunity.com/SUA.aspx#bundles (download the complete toolset) 
REM - SUA Tools: http://www.suacommunity.com/tool_warehouse.htm or ftp://ftp.interopsystems.com
REM - Xming:   http://www.straightrunning.com/candidate/
REM - Xming Fonts: http://sourceforge.net/projects/xming/files/Xming-fonts/7.5.0.25/Xming-fonts-7-5-0-25-setup.exe/download
text
******************************
* Microsoft Subsystem for Unix
******************************
endtext

REM Initialize
set p=Microsoft\Unix

REM Core
call os.btm optional
echo - Check Subsystem for UNIX-based Applications
pause

call ask `Minimal installation?` n
iff %? == 1 then
	gosub run "%p\tools\bash-current.exe"
else
	call SubsystemForUnixFull
endiff

echo Installing tools....
gosub run "%p\tools\tkman-current.exe"

echo Updating registry...
call registry import "%install\%p\other\setup.reg"

echo Updating icons...
call MoveFile.btm "%ud\XLaunch.lnk" "%pp\Operating System"
call MoveFile.btm "%ud\XMing.lnk" "%pp\Operating System"
call MergeDir.btm /q "%pp\Subsystem for UNIX-based Applications" "%pp\Operating System\Other"
call MergeDir.btm /q "%pp\Xming" "%pp\Operating System\Other"

iff "%UserSysHome" != "%UserHome" then
	echo Updating user home directory...	
	echo - paste clipboard contents after if [ "$HOME" != "" ]; then
	echo %@ClipW[export HOME=/dev/fs/D/Users/$(whoami)] >& nul:
	call TextEdit "%WinDir\SUA\etc\homedir.conf" "%WinDir\SUA\etc\profile"
	pause
endiff

return

:SubsystemForUnixFull
:SfuFull

REM Initialize
set p=Microsoft\Unix

REM SDK
text
Installing utilities and SDK...
- Custom Install
  - Check Base Utilities, Base SDK, GNU Utilities, and GNU SDK
- Security Settings, check all
endtext
gosub run "%p\SDK\%@OsArchitecture[]\setup.exe"

REM Tool bundle - x86 package is more complete and contains additional packages
text
Installing SUA community add-on tool bundles...
- Do not install X server
endtext
gosub run "%p\packages\pkg-current-bundlecomplete60x64.exe"
gosub run "%p\packages\pkg-current-bundlecomplete60x86.exe"

REM Additional tools
echo Installing tools....
gosub run "%p\tools\tkman-current.exe"

REM X Server
text
Installing X Window components...
- Standard PuTTY Link SSH client - use with orginal PuTTY
endtext
gosub run "UNIX\Xming\Xming-7-5-0-29-setup.exe"
echo - Check all fonts
gosub run "UNIX\Xming\Xming-fonts-7-5-0-25-setup.exe"

return

:bash
text
***************************
* Bash - Bourne Again Shell
****************************
endtext

echo Configuring bash...

set files=.bashrc .bash_profile .bash_logout .inputrc .minttyrc .gitconfig .dialogrc
for file in (%files) (
	
	set src=%UserBin\%file
	set link=%UserHome\%file
	
	iff %@IsLink["%link"] == 0 then
		if not IsFile "%src" touch "%src"
		call DelFile ask "%link"
		call MakeLink "%src" "%link"
		attrib +h "%link"		
	endiff
)

iff "%data" != "c:" then
	call MakeLink "%UserHome\.gitconfig" "%UserSysHome\.gitconfig"
endiff

REM .bash_history
touch "%UserHome\.bash_history"
attrib +h "%UserHome\.bash_history"

return

:ssh
text
************************
* SSH - Secure Shell
************************
endtext

REM Initialize
set SshHome=%UserHome\.ssh
set SshCloudHome=%CloudDocuments\data\.ssh

echo Creating data directory...
call MakeDir "%SshHome"
attrib /q /d +h "%SshHome"

echo Updating firewall...
call firewall rule add "SSH" `dir=in action=allow protocol=TCP localport=22 profile=private program="%programs\Cygwin\usr\sbin\sshd.exe"`

echo Server...
text
- privilege separation=yes, new local account=yes, install sshd as a service=yes, 
  value of CYGWIN for the daemon=ntsec, use a different account name=no, 
  create privileged account=yes, password=<administrator>
  - issues: service delete sshd; chmod -R 777 /var
EndText
call cygwin bash 'ssh-host-config'
net start sshd
pause

return

:Pandora
text
************************
* Pandora
************************
endtext

if "%@assoc[.air]" == "" gosub AdobeAir

gosub run "Pandora\pandora_2_0_5.air"
gosub run "Microsoft\Windows\gadgets\setup\PandoraOther.gadget"

echo Updating icons...
call DelFile "%pd\Pandora.lnk"
call MoveFile "%pp\Pandora.lnk" "%pp\Media"

return

:gSyncit
REM http://www.daveswebsite.com/software/gsync/updates.shtml
text
************************
* gSyncit
************************
endtext

call office.btm init
if %? != 0 return %?

gosub run "gSyncit\gSyncit_2_5_90_office%OfficeBits%.msi"

echo Updating registry...

REM Delete gSyncit - C:\Program Files\Fieldston Software\gSyncit\gsyncit.exe
call registry 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\gSyncIt"

echo Updating icons...
call MergeDir /q "%pp\gSyncit" "%ao"
call MergeDir /q "%up\gSyncit" "%ao"

text
- Calendar Sync, New
  - Calendar Mapping
    - Google Calendar (Feed Path), Select Calendar ..., John Butare
    - Outlook Calendar Folder, Select Calendar ..., Calendar
- Contact Sync, New
  - Google Gmail Contact Group=Other Contacts
  - Outlook Contact Folder=Contacts
- Notes, New, Outlook Notes Folder=Notes
- (optional) Tasks, New, Outlook Notes Folder=Notes
- Sync Options, check Minimize sync status dialog when syncronizing.
- Export Settings, Documents\data\profile\SnagIt\settings YYYYMMDD
endtext

return

:VirtualBox
REM http://www.virtualbox.org/
text
************************
* VirtualBox
************************
endtext

gosub run "Sun\VirtualBox\setup\VirtualBox-3.1.2-56127-Win.exe"

echo Updating icons...
call MergeDir.btm /q "%pp\Sun VirtualBox" "%pp\Operating System\Other"
call DelFile.btm "%pd\Sun VirtualBox.lnk"

call MakeDir.btm "%UserData\VirtualBox"

text
- File, Preferences...
  - General, Default Folders=Documents\data\VirtualBox
endtext

return

MotionPictureBrowser

:PlayMemoryies
:PictureMotionBrowser
:pmb
REM Installs: the autorun program and service are used for device recognition .
REM    Leave them enabled during initial recognition and setup, and then disable as don't currently
REM    use value added import for DSC-HX5V (GPS added to video moff/modd metadata files), and can run import manually from PMB Launcher
text
*****************************
* Sony Motion Picture Browser
*****************************
- Install, uncheck Restart Now
- Connect a Sony product and a Blu-ray burner, when prompted install special features
endtext

REM PMB must be installed from ISO image, otherwise setup fails
gosub run "Sony\Play Memories\setup\PMH_Upgrade1209a.exe"

echo Moving data folders...
call MakeLink merge "%UserData\Sony PMB" hide "%UserDocuments\Sony PMB"

echo Updating registry...

REM Delete PMBVolumeWatcher - C:\Program Files (x86)\Sony\PMB\PMBVolumeWatcher.exe
call registry.btm 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\PMBVolumeWatcher"

echo Updating services...

REM Set pmbdeviceinfoprovider to manual
call service manual pmbdeviceinfoprovider

echo Updating icons...
call MergeDir.btm /q "%pp\PlayMemories Home" "%pp\Media\Other"
call DelFile.btm "%pd\PlayMemories Home.lnk"
call DelFile.btm "%pd\PlayMemories Home Help.lnk"
call DelFile.btm "%pp\PlayMemories Home.lnk"

text
- Connect Sony devices to get dialog to add addition features
  - HDR-12 video camera to recognize video
endtext
call PictureMotionBrowser service start
pause

text
- Tools, Settings..., 
  - Add Folders, My Pictures, My Videos, Public Pictures and Public Videos	
- Share Publicly, Check for new Sharing Services...
endtext
call PictureMotionBrowser start
pause

return

:PDFZilla
text
****************************
* PDFZilla - PDF to Word
****************************
- Where should PDFZilla be installed=<paste>
endtext

echo %@ClipW[%programs32\PDFZilla] >& nul:
gosub run "Shareware\PDFZilla\setup v1.2.9.exe"

echo Updating icons...
call DelFile "%pd\PDFZilla.lnk"
call MergeDir /q "%pp\PDFZilla" "%ao"

text
- Please Enter the Registration Code=8061822TWDV6YUK
- PDF To Word Converter, Output Folder=Downloads
endtext

return

:FoxitReader
REM http://www.foxitsoftware.com/downloads/index.php
REM http://timheuer.com/blog/archive/2008/05/09/foxit-pdf-preview-handler.aspx
text
***************************
* Foxit Reader - PDF Reader
***************************
- Uncheck Shell Extensions, Install Foxit Reader Creator, Add-on for ...
- Uncheck Enable Safe Reading Mode
- Foxit PDF Creator Toolbor
  - Uncheck Install Foxit PDF Creator Toolbar
  - Uncheck Set Ask.com as my homepage
endtext

gosub run "Foxit\reader\setup\FoxitReader606.0722_enu_Setup.exe"
gosub run "Foxit\reader\setup\FoxitPdfPreviewHandlerSetup_1_1.msi"

echo Updating icons...
call DelFile "%pp\eBay.lnk"
call DelFile "%pd\eBay.url"
call DelFile "%pp\eBay.url"
call DelFile "%pd\Foxit Reader.lnk"
call MergeDir /quiet /rename "%pp\Foxit Reader" "%ao\Foxit Reader"

set prog=%programs32\Foxit Software\Foxit Reader\Foxit Reader.exe

call ask `Install plugins?` y
iff %? == 1 then
	copy /g "%install\Foxit\reader\plugins\lex_1.0.2007.2023.fzip" "%temp"
	echo %@ClipW["%temp\lex_1.0.2007.2023.fzip"] >& nul:
	echo - Help, Install Updates..., <paste>
	starg /pgm "%prog"
endiff

text
- Edit, Preferences
  - General, uncheck Show Start Page
  - History, Maximum number of documents in recently used list=10
  - Updater, Do not download
endtext
start /pgm "%prog"
pause

return

:calibre
REM Download - http://calibre-ebook.com/download
REM   Windows - http://calibre-ebook.com/download_windows
REM   All - https://dev.mobileread.com/dist/kovid/calibre/
text
************************
* Calibre Reader
************************
- Advanced, uncheck Add install directory to path
endtext

gosub run "Shareware\Calibre\setup\calibre-0.9.38.msi"

echo Updating icons...
call MoveFile "%pd\calibre - E-book management.lnk" "%pp\Applications"
call MergeDir /quiet "%pp\calibre - E-book Management" "%ao"

text
- choose a location for your books=Documents\data\books or cloud:\data\books
- Manufacturers=Amazon, Devices=Kindle PaperWhite
- E-Book Viewer, Configure, General, Page Flip options, Page flip duration=0 secs
- Notes: 
  - Organizes library folders by <author>\<book> on import or metadata change
  - Search uses regular expressions: not mobi and not pdf and not azw
  - Import content from the download directory using the Add books button (content
    is copied to the ebook location) 
endtext

return

:calibre2opds
REM http://calibre2opds.com/downloads/
text
************************
* calibre2opds
************************
endtext

set InstallDir=%programs\calibre2opds
gosub run "Shareware\calibre2opds\setup\calibre2opds-3.1-170M.zip"

echo Updating icons...
XxMkLink /q "%pp\Media\OPDS Catalog Generator.lnk" cmd "/c \"%programs\calibre2opds\rungui.cmd\"" "%programs\calibre2opds" "" 7

return


:SecurityEssentials
:mse
REM download: http://www.microsoft.com/security_essentials/
REM EMET download: http://blogs.technet.com/b/srd/, http://www.microsoft.com/download/en/details.aspx?id=1677
REM notes: scans for malware - virus (new) and spyware (replaces Windows Defender)
text
************************************
* Microsoft Security Essentials
************************************
endtext

gosub run "Microsoft\security\essentials\mse v4.2.223.1 %@OsArchitecture[].exe"
gosub run "Microsoft\security\EMET\EMET Setup.msi"

echo Updating icons...
call DelFile "%pd\Microsoft Security Essentials.lnk"
call MoveFile "%pp\Microsoft Security Essentials.lnk" "%pp\Operating System\Security Essentials.lnk"
call MergeDir /q "%up\Enhanced Mitigation Experience Toolkit" "%pp\Operating System\Other"

REM Real time monitoring increases  bin\*.exe file copy time 50x (1s->50s) 
text
Optionally disable components which significantly degrade system performance...
- Settings
  - Scheduled scan, uncheck Run a schedule scan on my computer
  - Real-time protection, uncheck Monitor file and program activity on your computer
endtext
call os.btm SecurityEssentials
pause
	
echo - Action Center, Change Action Center settings, Turn on/off Spyware and related protection and Virus protection
call os.btm ControlPanel
pause

return

REM Omron blood pressure monitor health management software
:Omron
text
************************
* Omron
************************
- Prefix installation directory with c:\Program Files
endtext

gosub run "Omron\HEM-790IT\setup\setup.exe"

echo Updating icons...
call DelFile "%ud\Omron Health Management Software Users Manual.pdf.lnk"
call DelFile "%ud\Omron Health Management Software.lnk"
call MergeDir /q "%up\Omron Health Management Software" "%ao"

return

:Comcast
text
************************
* Comcast Applications
************************
- ComcastAccess: non-intrusive DRM, works with Win7 x64, allows 3 computers to play Fancast xfinity content
endtext

gosub run "Comcast\ComcastAccessInstaller.exe"

echo Updating icons...
call MoveFile "%pp\ComcastAccess.lnk" "%pp\Media"

return

:HandBrake
text
************************
* HandBrake
************************
endtext

gosub run "Shareware\HandBrake\setup\HandBrake-0.9.4-Win_GUI.exe"

echo Updating icons...
call DelFile "%ud\Handbrake.lnk"
call MergeDir /q "%pp\Handbrake" "%pp\Media\other"
call DelDir /q "%up\Handbrake"

echo Restoring the default profile...
call HandBrake profile restore default

text
- Tools, Options, 
  - Default Path=D:\Users\jjbutare\Videos\converted
endtext

return

:TouchPack
text
************************
* Touch Pack
************************
endtext

gosub run "Microsoft\Windows\touch\touch-pack-web.exe"

echo Updating icons...
call DelFile "%pp\Bing Maps 3D.lnk"
call MergeDir /q /rename "%pp\Microsoft Touch Pack for Windows 7" "%ao\Touch Pack"
call MoveFile "%pd\Bing Maps 3D.lnk" "%ao\Touch Pack"
return

:MediaCoder
REM - Updates: http://www.mediacoderhq.com/
REM - Codecs
REM   - http://www1.mplayerhq.hu/MPlayer/releases/codecs/windows-essential-20071007.zip
REM   - http://xulplayer.googlecode.com/files/avisynth-20100223.7z 
REM   - http://d10xg45o6p6dbl.cloudfront.net/projects/m/mediacoder/lossless_audio_encoders_20090814.7z 
REM - XUL Player: http://xulplayer.sourceforge.net/xulplayer-bin.7z
text
************************
* MediaCoder
************************
endtext

gosub run "Shareware\MediaCoder\setup\MediaCoder v2011 build 5025 %@OsArchitecture[].exe"

call ask.btm `Install additional codecs (AVI support)?` n
if %? == 1 unzip.exe -o -j -e "%ExeDir\..\codecs\windows-essential-20071007.zip" -d "%programs\MediaCoder\codecs"

echo Updating icons...
call DelFile "%ud\MediaCoder x64.lnk"
call MergeDir /q "%up\MediaCoder x64" "%pp\Media\other"

text
- Config Wizard
  - Advanced Mode
  - Do you want to enable multi-threaded decoding? Enable
  - Do you want to set the output video resolution? No
  - How do you want to deal with the aspect ratio? I want to keep the original picture proportion. 
  - Do you want to adjust the video frame rate? No
  - Which format do you want to convert to? H.264 / AVC
  - Which bitrate mode do you want to use for video encoding? Variable Bitrate, High Quality
  - Which container format do you want to use? MP4
  - Which audio format do you want to encode to? AAC
  - Do you want to adjust the audio sample rate? No
  - Do you want to adjust the audio channels? No
- Notes:
  - Test playback with mplayer, install additional codecs if needed:
    "%programs\MediaCoder\codecs\mplayer.exe" \\oversoul\john\Desktop\1994_02_12.wmv
  - Average bitrates: SVHS video=3000, DV=4000
  - Profiles in Cloud\data\MediaCoder
endtext

return

:Sonos
REM http://sonos.com/support/
text
************************
* Sonos Music System
************************
endtext

gosub run "Sonos\setup\SonosDesktopController41.exe"

echo Updating icons...
call DelFile "%pd\Sonos.lnk"
call MergeDir /q  "%pp\Sonos" "%pp\Media\Other"

REM Register the Sonos COM scripts, which must always be available.  Registration fails if not done from the current working directory.
echo Registering COM scripts....
pushd %PublibBin
regsvr32 /s "ZonePlayerController.wsc"
regsvr32 /s "ZonePlayerFinder.wsc"
popd

text
- Manage, Music Library Settings...,
  - Music Library
    - Folders, Add, On a networked device, \\nas\music and \\nas\books, Username=sonos, password=NNNN
    - Advanced, check Update content every day at 2:00am
  - Services..., Add, Amazon Cloud Player/Audible/AUPEO!/iheartradio/Last.fm/Pandora Radio/Rhapsody/SiriusXM/Stitcher SmartRadio
endtext

return

:AviDemux
REM http://avidemux.berlios.de/download.html
text
************************
* AviDemux
************************
- Select the type of install=Full, uncheck Additional Languages
endtext

gosub run "Shareware\Avidemux\avidemux_2.5.4_win32.exe"

echo Updating icons...
call MoveFile "%pd\Avidemux 2.5.lnk" "%pp\Media"
call MergeDir /q "%pp\Avidemux" "%pp\Media\Other"

return

:SonyVegas
:vegas
REM http://www.sonycreativesoftware.com/download/updates/moviestudiope
REM http://www.sonycreativesoftware.com/download/updates/dvdastudio
text
**************************
* Sony Vegas Movie Studio
**************************
endtext

gosub run "Sony\Vegas\setup\moviestudiope11.0.283.exe"
gosub run "Sony\Vegas\setup\dvdarchitectstudio5.0.157.exe"

echo Updating icons...
set as=%pp\Media\Other\Sony\DVD Architect Studio
set vms=%pp\Media\Other\Sony\Vegas Movie Studio
call MergeDir /q "%pp\Sony" "%pp\Media\Other"
call MergeDir /q /rename "%pp\Media\Other\Sony\Vegas Movie Studio HD Platinum 11.0" "%vms"
call MergeDir /q /rename "%pp\Media\Other\Sony\DVD Architect Studio 5.0" "%as"
call MoveFile "%vms\Vegas Movie Studio HD Platinum 11.0.lnk" "%vms\Vegas Movie Studio.lnk"
call MoveFile "%as\DVD Architect Studio 5.0.lnk" "%as\DVD Architect Studio.lnk"
call DelFile "%vms\Vegas Movie Studio HD Platinum 11.0 Readme.lnk"
call DelFile "%vms\Video Capture 6.0 Readme.lnk"
call DelFile "%as\DVD Architect Studio 5.0 Readme.lnk"

echo Moving data folders...
call MakeDir "%UserData\DVD Architect Studio"
call MakeLink merge "%UserData\Vegas" hide "%UserDocuments\Vegas Movie Studio HD Platinum 11.0 Projects"

text
- Vegas Movie Studio, Options, shift click Preferences..., 
  - General, Temporary files folder=d:\temp
  - Internal
    - path, set all c: paths to D:\Users\jjbutare\Documents\data\Vegas\temp\NNN
    - threads, Maximum Video Render Threads=8, Max for Maximum Video Render Threads=12 
- DVD Archtiect Studio
  - File, Properties...
    - Aspect ratio=16:9
    - Check Start all new projects with these settings
  - Options, Preferences
    - General, uncheck Show logo splash screen on startup
		- Preview, Aspect ratio=16:9
		- Burning
			- Default  prepare folder=%UserData\DVD Architect Studio
			- Temporary files folder=d:\temp
endtext
pause

return

:Eraser
REM http://eraser.heidi.ie/
text
************************
* Eraser
************************
endtext

gosub run "Shareware\Eraser\Eraser 6.0.8.2273.exe"

echo Updating icons...
call DelFile "%pd\(prog).lnk"
call MoveFile "%pd\(prog).lnk" "%pp\Applications"
call MergeDir /q "%pp\(dir)" "%ao"

return

:InternetDownloadAccelerator
:IDA
text
********************************
* Internet Download Accelerator
********************************
endtext

gosub run "WestByte\Internet Download Accelerator\IDA v5.10.1.1269.exe"

echo Updating icons...
call DelFile "%ud\Internet Download Accelerator.lnk"
call DelFile "%ud\Play!.lnk                        "
call MergeDir /q "%pp\Internet Download Accelerator" "%pp\Operating System\Other"

echo Updating registry...

REM Delete Internet Download Accelerator - C:\Program Files (x86)\IDA\ida.exe -autorun
call registry delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Internet Download Accelerator"

echo Uninstall Firefox IDA plugins...
call firefox start
pause

echo %@ClipW[%UserData\download] >& nul:
text
- Tools, Options
  - General, uncheck Minimize to tray when closing
  - Downloads
    - Current folder for saving files=<paste>
    - Download folder detection type=Do not use
  - User Interface
    - Uncheck Show splash screen while starting
    - Uncheck Always open "Add download" window when adding new download
    - Events, Unmark on=selection of the download
  - Other
    - MyTopFiles setting, check Disable sending link info to the service
    - Uncheck Get news on popular files
endtext
ida
pause

return

:EverNote
REM http://www.evernote.com/about/download/windows.php?file=Win&btn=grey
text
************************
* EverNote
************************
endtext

gosub run "EverNote\setup\Evernote_4.6.7.8409.exe"

text
- View, check Thumbnail View, uncheck Show Left Panel
- Notes by=Title, uncheck Reverse Sort Order
- Hover over bottom of thumbnail view, zoom left
- Left channel 3 notes
- Right of Search, click down arrow
- Note, click down arrow to hide all levels
- Tools, Options
  - General 
    - Uncheck Autoamticall check for updates
    - Uncheck Show advertisements
    - Uncheck Show Evernote Premium in the left sidebar
  - Sync
    - Uncheck Enable sync notifications
    - Check Synronize automatically Every 15 minutes
  - Note, Note editor font=Arial 10
endtext
call EverNote close
call sudo /standard EverNote startup
pause

echo Updating icons...
call DelFile "%pd\Evernote.lnk"
call DelFile "%ud\Evernote.lnk"
call DelFile "%pp\Startup\EvernoteClipper.lnk"
call DelFile "%up\Startup\EvernoteClipper.lnk"
call MergeDir /q "%pp\Evernote" "%ao"

return

:UltraVNC
REM Installs: uvnc_service, mv2.sys driver
text
************************
* UltraVNC
************************
- Select Additional Tasks
  - Check Register UltraVNC Server as a system service (for Ctrl-Alt-Delete handling)
  - Check Create UltraVNC desktop icons
  - Check Associate UltraVNC Viewer with the .vnc file extension
  - Check UltraVNC Server driver install  
endtext

gosub run "UltraVNC\setup\UltraVNC_1.0.9.5_%@OsArchitecture[]_Setup.exe"

echo Updating icons...
call DelFile "%ud\UltraVNC Server.lnk"
call DelFile "%ud\UltraVNC Viewer.lnk"
call MergeDir /q "%pp\UltraVNC" "%pp\Operating System\Other"

text
- Security, VNC Password=NNN
- Screen Capture
  - Check Low Accuracy
  - Check Use system hookdll
  - Check Use mirror driver and Show Primary Display
  - Check Capture Alpha-Beldning
  - Check Remove Aero while connected
  - Check Remove Wallpaper while connected
endtext
call UltraVNC config
pause

text
- Admin Properties
  - Check Allow Loopback Conenctions
  - Uncheck Loopback Only
endtext
call UltraVNC server
pause

return

:DropBox
REM https://www.dropbox.com/install
text
************************
* DropBox
************************
- (new install) Ensure %CloudDocuments directory is empty
- Advanced, I want to choose where to put my Dropbox=%data\Users\jjbutare
endtext

gosub run "Dropbox\setup\Dropbox 2.2.8.exe" RunStandard

REM Icons are specific to each user, move them to user programs or else may run incorrect version that another user has installed
echo Updating icons...
call MakeDir "%up\Operating System\Other"
call MergeDir /q "%up\Dropbox" "%up\Operating System\Other"
call DelFile "%up\Startup\Dropbox.lnk"
call DelFile "%ud\Dropbox.lnk"
if "%data" != "c:"  call MakeShortcut.btm "%UserHome\Dropbox" "%UserSysHome\Dropbox.lnk"

call ask `Do you want to update index locations?` y
iff %? == 1 then

	call DropBox close

	set dir=%CloudDocuments\.dropbox.cache
	call MakeDir  "%dir"
	attrib /d -sh "%dir"

	REM Configure the index
	echo - Modify, %CloudDocuments, check Dropbox, uncheck .dropbox.cache
	call os index options
	pause

	REM Hide the Dropbox cache
	attrib /d +sh "%dir"

	call sudo /standard DropBox startup
endiff

text
- Preferences...
  - General
    - Uncheck Show desktop notifications
    - Uncheck Start Dropbox on system startup
  - (Intel) Proxies
    - Select Manual
    - Server=proxy.fm.intel.com
    - Port=911
- Explorer
  - Libraries, Documents, locations, 
    - Add..., <paste>
    - (not Intel) Move Up (to top)
    - (not Intel) Set as default save location
  - View, List
endtext
echo %@ClipW[%CloudDocuments] > nul:
pause

return

:LinkShellExtension
text
************************
* Link Shell Extension
************************
endtext

gosub run "Shareware\Link\setup\HardLinkShellExt_%@OsArchitecture[].exe"

echo Updating icons...
call MergeDir /q "%pp\Link Shell Extension" "%pp\Operating System\Other"
call MergeDir /q "%up\Link Shell Extension" "%pp\Operating System\Other"

echo Enabling icon overlays...
echo - Icon, HardLink, Priority for overlay icon=1
"%programs\LinkShellExtension\LSEConfig.exe"
pause 
echo - Icon, HardLink, Priority for overlay icon=-
"%programs\LinkShellExtension\LSEConfig.exe"
pause

return

:miro
text
************************
* Miro
************************
endtext

gosub run "Shareware\Miro\Miro_Installer.exe"

echo Updating icons...
call DelFile "%pd\Miro.lnk"
call MergeDir /q "%pp\Miro" "%pp\Media\Other"

return

:PSI
REM http://secunia.com/vulnerability_scanning/personal/
text
************************************************
* Secuina PSI - Personal Software Inspector
************************************************
- Uncheck Enable Auto-Updates
endtext

gosub run "Secunia\PSI\PSISetup.exe"

echo Updating icons...
call MoveFile "%pp\Secunia PSI.lnk" "%pp\Operating System"

text
- Configuration, Settings, uncheck all except Show detailed program changes
endtext
call psi
pause

return

:LinkSysBluetooth
REM HKLM\Microsoft\Windows\CurrentVersion\Run\BluetoothAuthenticationAgent, c:\windows\system32\bthprops.cpl, is required to store Bluetooth link keys
REM Removal requires manual deletion of services: btaudio, BTDriver, BTWDNDIS, BTWUSB
text
*****************************
* LinkSys Bluetooth Software
*****************************
endtext

gosub run "Linksys\Bluetooth USB Adapter USBBT100\Driver V1.05\setup.exe"

REM Hide desktop icon
call registry.btm 32 set "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\HideDesktopIcons\NewStartPanel\{6AF09EC9-B429-11D4-A1FB-0090960218CB}" REG_DWORD 1

echo Updating icons...
call DelFile "%pp\My Bluetooth Places.lnk"
call DelFile "%pp\..\My Bluetooth Places.lnk"
call DelFile "%pp\Startup\BTTray.lnk"
call MergeDir /q "%pp\Accessories" "%pp\Applications\Accessories"

echo Update driver...
gosub RunProg devmgmt.msc
echo - Bluetooth Radios, Generic Bluetooth Radio, Update Driver..., No, Advanced, Don't search, Linksys Bluetooth USB Adapter

return

:BroadcomBluetooth [update]
REM http://www.broadcom.com/support/bluetooth/update.php
REM Path: %programs\WIDCOMM\Bluetooth Software and %programs\WIDCOMM\Bluetooth Software\syswow64
text
*****************************
* Broadcom Bluetooth Software
*****************************
endtext

REM Run the setup that downloads the correct installer to ensure the correct licensing for the Bluetooth device is used.
REM Only run if update is true for cases where vendor specific driver is used.  Using the Broadcom software directly
REM can cause some errors with some systems and  devices (such as Lenovo laptops and Voyager PRO+)
if "%update" != "false" gosub run "Broadcom\Widcomm\Setup Download v6.5.1.2300.exe"

echo Updating icons...
call DelFile "%pp\Startup\Bluetooth.lnk"
call MoveFile "%pd\Bluetooth Problem Report.lnk" "%pp\Operating System"
call MoveFile "%pp\Bluetooth Problem Report.lnk" "%pp\Operating System"
call MergeDir /q "%pp\Accessories" "%pp\Applications"
call MergeDir /q "%up\Bluetooth Devices" "%pp\Operating System"
call DelDir /q "%UserDocuments\Bluetooth Exchange Folder"

text
- Options
  - Check Allow Bluetooth devices to find this computer
  - Check Allow Bluetooth device to connect to this computer
  - Check Show the Bluetooth icon in the notification area
- Share, Bluetooth Exchange Folder location=Downloads
endtext
call os bluetooth properties
pause

return

:IoGearBluetooth
REM Required for Plantronics Voyager Headset, Microsoft drivers are sufficient for Bluetooth keyboard and mouse decvices
REM http://www.iogear.com/support/dm/driver/GBU321#display
text
*****************************
* IOGear Bluetooth Software
*****************************
endtext

REM Instal the base  Bluetooth driver from IOGear to get the correct license then update the driver from Broadcom
gosub run "IOGear\BlueTooth Adapter GBU2210-321\setup\setup v6.2.1.500.exe"
gosub BroadcomBluetooth

return

:VisionApp
REM http://www.visionapp.com/germany/software/visionapp-remote-desktop
REM Intel corporate license: \\vmsdaklx001\software$\Visionapp_Remotedesktop
text
***************************
* VisionApp Remote Desktop
***************************
endtext

gosub run "VisionApp\Remote Desktop\setup\vRD2011inclPatch2.exe"

echo Updating icons...
call DelFile "%pd\visionapp Remote Desktop 2011.lnk"
call MergeDir /q "%pp\visionapp Remote Desktop 2011" "%pp\Operating System\Other"

echo Preparing connections...

set CloudDir=%CloudData\VisionApp
set LocalDir=%UserData\VisionApp

call MakeDir "%CloudDir" "%LocalDir"

echo - Add..., File..., Name=Personal, path=%CloudDir\settings.xml
echo - Add..., File..., Name=Intel, path=%LocalDir\settings.xml
text
- (CSIS) File, Environment Wizard, Add, Database, Connect to an Existing Database
  - Database server=azscsissql950,3180
  - Database name=VisionApp
  - User name=vRDDbUser
  - Password=VisionUser!1
endtext

call VisionApp start start
pause

echo Importing license...
echo `- ?, Info..., Import new license file, <paste>`
echo %@ClipW[%install\VisionApp\Remote Desktop\license\Intel Corporation_Global.xml] >& nul:
call VisionApp start
pause

text
- View, Icon Size, 24x24
- Navigation, Connectons, for each folder uncheck Sort Alphabetically
- Tools, Options, Application, check Pass-through authentication
endtext
call VisionApp start
pause

return

:Growl
REM http://www.growlforwindows.com/gfw/
REM http://code.google.com/p/android-notifier/
text
************************
* Growl
************************
endtext

gosub run "Shareware\Growl\setup\Growl_v2.0.6.1.msi"

echo Installing applications...
set InstallDir=`%programs32\Growl for Windows\apps\%@UnQuote[%app]`
for app in ("Android Notifier Desktop" "Gmail Growl" "System Monitor") (
	gosub run "Shareware\Growl\apps\%@UnQuote[%app]"
)

echo Updating icons...
call MoveFile "%ud\Growl.lnk" "%pp\Operating System\Other"
call MoveFile "%up\Growl.lnk" "%pp\Operating System\Other"

text
- Security
  - Uncheck Require password for LAN apps
  - Check Allow network notification
endtext
pause

return

:LastPass
:lp
REM https://lastpass.com/misc_download.php
REM Release notes - https://lastpass.com/upgrade.php?fromwebsite=1&releasenotes=1
REM LastPass for applications includes IE Anywhere to fill in forms in IE without the IE plugin.
text
************************
* LastPass
************************
- select No, do not import any of my insecure items
endtext

gosub run "LastPass\setup\LastPass Setup %@OsArchitecture[] v2.5.0.exe"
gosub run "LastPass\setup\LastPass for Applications Setup %@OsArchitecture[] v2.0.20.exe"

echo Updating registry...

REM Delete LastPass - C:\Program Files (x86)\LastPass\lastapp.exe
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\LastApp"

echo Updating icons...
call MergeDir /q "%up\LastPass" "%pp\Operating System\Other"
call MergeDir /q "%pp\LastPass" "%pp\Operating System\Other"
call DelFile "%pd\My LastPass Vault.lnk"

return

:UpdateChecker
text
****************************
* FileHippo Update Checker
****************************
endtext

text
- Settings
  - Results, Open results in Custom Browser=Chrome
  - Results, uncheck Hide beta versions, check Show the installation path
  - Custom Locations, Add..., Public Documents\data\bin\win32 and win64, Folder only
endtext
UpdateChecker.exe
pause

return

:TableauReader
text
************************
* Tableau Reader
************************
endtext

gosub run "Tableau\TableauReader.msi"

echo Moving data folder...
call MakeLink merge "%UserData\Tableau Repository" hide "%UserDocuments\My Tableau Repository"

echo Updating icons...
call DelFile "%pd\Tableau Reader 7.0.lnk"
call MoveFile "%pp\Tableau Reader 7.0.lnk" "%pp\Applications\Tableau Reader.lnk"

return

:SoundBlaster
:CreativeSoundBlasterXFi
REM http://support.creative.com/Products/ProductDetails.aspx?catID=1&CatName=Sound+Blaster&subCatID=208&subCatName=X-Fi&prodID=16770&prodName=PCI+Express+Sound+Blaster+X-Fi+Xtreme+Audio&bTopTwenty=1&VARSET=prodfaq:PRODFAQ_16770,VARSET=CategoryID:1
REM Installs
REM - System Run: SPIRunE - Rundll32 SPIRunE.dll,RunDLLEntry
REM - User Run: CTAutoUpdate - "C:\Program Files (x86)\Creative\Shared Files\Software Update\AutoUpdate.exe" /RunFromInstaller
text
******************************
* Creative Sound Blaster X-Fi
******************************
endtext

gosub run "Creative\PCI Express Sound Blaster X-Fi Xtreme Audio\setup\XFXA_PCDRV_LB_WIN8_1_05.exe"

echo Updating registry...

REM Delete CTAutoUpdate - "C:\Program Files (x86)\Creative\Shared Files\Software Update\AutoUpdate.exe" /RunFromInstaller
call registry delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\CTAutoUpdate"

echo Updating icons...
call MergeDir /q "%pp\Creative" "%pp\Operating System\Other"

gosub SoundListen

return

:SoundListen

text
- Recording, Listen, check Listen to this device, Levels=100
  - Advanced, Default Format=2 channel, 24 bit, 44100 Hz (Studio Quality)
- Notes
  - If audio playback stutters try other formats
  - If the computer does not sleep, try powercfg /requestoverride, disable Listen, 
    or disable the Recording device
endtext
call os sound
pause

return

:SeaTools
REM download - http://www.seagate.com/ww/v/index.jsp?locale=en-US&name=SeaTools&vgnextoid=720bd20cacdec010VgnVCM100000dd04090aRCRD
REM test and replace Seagate drives
text
************************
* Seagate Tools
************************
endtext

gosub run "Seagate\SeaTools\SeaToolsforWindowsSetup-1208.exe"

echo Updating icons...
call DelFile "%pd\SeaTools for Windows.lnk"
call MergeDir /q "%pp\Seagate" "%pp\Operating System\Other"

return

:PerformanceTest
text
************************
* Performance Test
************************
endtext

gosub run "PassMark\PerformanceTest\petst_x64.exe"

echo Updating icons...
call MergeDir /q "%pp\PerformanceTest (64-bit)" "%pp\Operating System\Other"

return

:xxcopy
text
************************
* xxcopy
************************
endtext

gosub run "Shareware\xxcopy\xxcopy.reg"

return

:ssd
text
****************************************
* SSD (Solid State Drive) common setup
****************************************
endtext

echo Disabling SuprtFetch (not required for SSD systems)...
call os.btm DisableSuperFetch

echo Configuring disk defragmentation schedule...
echo - Configure schedule..., uncheck Run on a schedule
call os defrag
pause

echo Other setup...
echo - Enable AHCI in BIOS
echo - Ensure SSD supports TRIM
pause

return

:AirPortExpress
REM http://support.apple.com/downloads/#airport utility windows
text
************************
* AirPort Express
************************
endtext

gosub run "Apple\AirPort\AirPortSetup v5.5.3.2.exe"

REM Delete System Run - AirPort Base Station Agent - "C:\Program Files (x86)\AirPort\APAgent.exe"
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\AirPort Base Station Agent"

echo Updating icons...
call MoveFile "%pp\AirPort Utility.lnk" "%pp\Operating System"
call MoveFile "%pp\Apple Software Update.lnk" "%pp\Operating System"

text
- Preferences
  - uncheck Check for updates Weekly
  - uncheck Monitor AirPort wireless devices for problems
endtext
pause

return

:AiCharger
REM Charge high current over USB spec (iPad)
REM http://event.asus.com/mb/2010/ai_charger/
text
************************
* AI Charger
************************
endtext

gosub run "Asus\AI Charger\V1.00.06\Setup.exe"

return

:MotorolaDroid
REM https://motorola-global-portal.custhelp.com/app/answers/detail/a_id/88481
text
*****************************
* Motorola Droid
*****************************
endtext

gosub run "Motorola\Droid\MotorolaDeviceManager_2.3.9.exe"

echo Updating icons...
call MergeDir /q "%pp\Motorola" "%pp\Operating System\Other"

text
- Connect the DroidX in USB Mass Storage mode
- Notification Area, MotoHelper, When Device Connects..., Do Nothing
endtext
pause

return

:ooVoo
REM http://www.oovoo.com/Download.aspx
text
************************
* ooVoo - video chat
************************
- uncheck Yes, I want to install the ooVoo Toolbar
endtext

gosub run "ooVoo\setup\ooVoo Setup v3.0.7.21.exe"

echo Updating registry...

REM Delete ooVoo.exe - C:\Program Files (x86)\ooVoo\oovoo.exe /minimized
call registry 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ooVoo.exe"

echo Updating icons...
call DelFile "%pd\ooVoo.lnk"
call MergeDir /q "%pp\ooVoo" "%ao"

return

:VistaSwitcher
text
************************
* VistaSwitcher
************************
endtext

gosub run "Shareware\VistaSwitcher\VistaSwitcher_1.1.4-x64.exe"

echo Updating registry...

REM Delete VistaSwitcher - "C:\Program Files\VistaSwitcher\vswitch64.exe" /startup
call registry 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VistaSwitcher"

echo Updating icons...
call DelFile "%pd\VistaSwitcher.lnk"
call MergeDir /q "%pp\VistaSwitcher" "%pp\Operating System\Other"

echo Restoring the default profile...
call VistaSwitcher profile restore default

echo Starting VistaSwitcher...
call sudo /standard VistaSwitcher startup

return

:WinSplit
text
************************
* WinSplit
************************
endtext

set InstallDir=%programs32\WinSplit Revolution
gosub run "Shareware\WinSplit Revolution\image.zip"

call WinSplit startup

return

:newt
text
************************************************
* NEWT - Network Emulator for Windows Toolkit 
************************************************
endtext

gosub run "Microsoft\other\newt v2.5.1 %@OsArchitecture[].msi"

echo Updating icons...
call MergeDir /q "%pp\Network Emulator for Windows Toolkit" "%pp\Operating System\Other"

return

:ReSharper
REM download: http://www.jetbrains.com/resharper/download/index.html http://www.jetbrains.com/resharper/download/index.html, http://confluence.jetbrains.net/display/ReSharper/ReSharper+8.0+Nightly+Builds
REM what's new: http://www.jetbrains.com/resharper/whatsnew/
REM cleanup: %LocalAppData%\JetBrains\ReSharper\v7.1\SolutionCaches
text
************************
* ReSharper
************************
endtext

gosub run "JetBrains\ReSharper\setup\ReSharperSetup.8.0.14.856.msi"

call Resharper profile restore default

text
- ReSharper, Options
  - Keyboards & Menus, ReSharper keyboard scheme=ReSharper 2.x or IntelliJ IDEA, Apply Scheme
  - Environment, Editor, Editor Behavior, uncheck Use CamelHumps
  - Environment, IntelliSense
    - Autopopup, C#, Where value is expected, Do not display
    - Completion Appearance, check Show Member Signatures and Show Summary
  - Code Editing, Code Cleanup, Add, default
    - Check all except C#, Reorder type members
    - C#, Use 'var' in declaration, Can Change/Always use/Always use
  - Tools, Unit Testing
    - Uncheck Save and restore Unit Test Sessions
    - Uncheck Wrap long lines in Unit Test Session output
    - Run up to 4 assemblies in parallel
endtext
call sudo /standard VisualStudio start
pause

return

:.NetMemoryProfiler
:MemProfiler
REM - download http://memprofiler.com/download.aspx
text
************************
* .NET Memory Profiler
************************
endtext

gosub run "SciTech\.NET Memory Profiler\MemProfilerInstaller4_5_184.exe"

echo Updating icons...
call MergeDir /q "%pp\.NET Memory Profiler 4.0" "%pp\Development\.NET\Other"

return

:dotTrace
REM download http://www.jetbrains.com/profiler/download/index.html
text
************************
* dotTrace
************************
endtext

gosub run "JetBrains\dotTrace\dotTracePerformanceSetup.5.2.1100.108.msi"
gosub run "JetBrains\dotTrace\dotTraceMemorySetup.%@OsArchitecture[].3.5.360.114.exe"

echo Updating icons...
call MergeDir /q "%pp\JetBrains dotTrace Performance 5.0" "%pp\Development\Other\"
call MergeDir /q "%pp\JetBrains dotTrace Memory 3.5" "%pp\Development\Other\"

return

:CruiseControlTray
:cctray
REM download from http://vmspwbld001/ccnetpreprod/ViewFarmReport.aspx or CruiseControl.NET home page, http://www.cruisecontrolnet.org/projects/cctray, http://cruisecontrol.sourceforge.net/, http://ccnet.sourceforge.net/CCNET/CCTray.html
text
************************
* CruiseControl Tray
************************
endtext

set version=1.8.3.0
REM call ask `Install old version (old build server)?` y
REM if %? == 1 set version=1.4.4-SP1

gosub run "Shareware\CruiseControl\tray\CruiseControl.NET-CCTray-%version-Setup.exe"

echo Restoring the default profile...
call CruiseControlTray profile restore default

echo Updating icons...
call DelFile "%ud\CCTray.lnk"
call DelFile "%up\Startup\CCTray.lnk"

call MergeDir /q "%up\CCTray" "%pp\Development\Other"

text
- File, Settings..., Build Projects, Add..., 
	- Add Server, vmspwbld001, vmspwbld001:21235, vmspwbld001:21236 
	- Projects (shift-click for multiple)
    - Antidote*, IntelNuGet*, Magellan*, Nuget*, RPIAD*, SCADA Portal*
endtext
pause

return

:DBArtisan
REM  download - https://downloads.embarcadero.com/reg/dbartisan
REM     \\azea1pub002\dev_rndaz\LicensedSoftware\Embarcadero\Embarcadero Products 2011\dbart900_11324.exe
text
************************
* DBArtisan
************************
- Serial Number=NNN
- DN Login name or Email=john3909
endtext

gosub run "Embarcadero\DBartisan\setup\dbart911_12210.exe"

echo Moving data folder...
call MergeDir /q /rename "%UserDocuments\Embarcadero" "%UserData\Embarcadero"

echo Updating registry...
set r=HKEY_CURRENT_USER\Software\Embarcadero\DBArtisan\9.1.1
set dir=%UserData\Embarcadero\DBArtisan
call registry set "%r\UserSQLScripts" REG_SZ "%@RegQuote[%UserData\sql]" >& nul:
call registry set "%r\Directories\ETSQLXJobCfg" REG_SZ "%@RegQuote[%dir\Directories\ETSQLXJobCfg]" >& nul:
call registry set "%r\Directories\IncludeFiles" REG_SZ "%@RegQuote[%dir\Directories\IncludeFiles]" >& nul:

call registry set "%r\Schema\Definition Directory" REG_SZ "%@RegQuote[%dir\DefFiles]" >& nul:
call registry set "%r\Schema\Report Directory" REG_SZ "%@RegQuote[%dir\Report]" >& nul:
call registry set "%r\Schema\Extraction Directory" REG_SZ "%@RegQuote[%dir\Extract]" >& nul:

echo Restoring the default profile...

REM Create the profile directory if it does not exist so it can be restored (profile method detection requires the directory exist)
call MakeDir "%AppData\Embarcadero\Data Sources"
call DBartisan profile restore default

echo Updating icons...
call MergeDir /q /r "%pp\Embarcadero DBArtisan 9.1.1" "%pp\Development\Other\DBArtisan"

text
File, Options...
- Datasource, Datasource Storage Management=File based datasource catalog
- Connection, Login Timeout=2
endtext
call sudo /standard DBartisan start
pause

return

:Telerik
REM download http://www.telerik.com/account/your-products.aspx
text
************************
* Telerik
************************
endtext

gosub run "Telerik\setup\Telerik.Web.UI_2012_1_215_Dev.msi"
gosub run "Telerik\setup\RadControls_for_Silverlight5_2012_1_0326_Dev.msi"

echo Updating icons...
call DelFile "%pd\RadControls for ASP.NET AJAX*Live Examples.lnk"
call DelFile "%pd\RadControls for Silverlight*Demos.lnk"
call MergeDir /q "%pp\Telerik" "%pp\Development\.NET\Other"

return

:sublime
text
************************
* Sublime Text Editor
************************
- Check add to explorer context menu
endtext

call ask.btm `Install v3 beta? ` n
iff %? == 1 then
	gosub run "Sublime\setup\Sublime Text Build 3047 %@OsArchitecture[] Setup.exe"
else
	gosub run "Sublime\setup\Sublime Text 2.0.2 %@OsArchitecture[] Setup.exe"
endiff

call MakeDir "%AppData\Sublime Text 2"

echo Restoring the default profile...
call sublime profile restore default

echo Updating icons...
call MoveFile "%pp\Sublime Text 2.lnk" "%pp\Applications"

iff IsDir "%CloudData" then
	echo Moving data folder...
	call MakeLink merge "%CloudData\Sublime" "%AppData\Sublime Text 2\Packages\User"
endiff

return

:ErStudio
REM Intel - install \\vmspaedm501\erstudio$, repository server vmspaedm551,  http://ersportal.intel.com
text
************************
* ErStudio
************************
- slp file=<paste>
- Repository Server=vmspaedm551
EndText

echo Finding the license file...
gosub FindExe "Embarcadero\ErStudio\setup\concurrent_132702.slip"
echo %@clipw[%exe] >& nul:

gosub run "Embarcadero\ErStudio\setup\erda_901.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Embarcadero\ERStudio" hide "%UserDocuments\ERStudio Data Architect XE"

echo Updating icons...
call MergeDir /q /rename "%pp\Embarcadero ERStudio Data Architect XE" "%pp\Development\Other\ERStudio"

return

:PowerPanel
REM download - http://www.cyberpowersystems.com/products/management-software/pppe.html?selectedTabId=resources&imageI=#tab-box
text
************************
* PowerPanel
************************
endtext

gosub run "CyberPower\PowerPanel\setup\pppe134-setup.exe"

REM Delete PowerPanel Personal Edition User Interaction - C:\Program Files (x86)\CyberPower PowerPanel Personal Edition\pppeuser.exe
call registry 32 delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\PowerPanel Personal Edition User Interaction"

echo Updating icons...
call MergeDir /q "%pp\CyberPower PowerPanel Personal Edition" "%pp\Operating System\Other"

return

:ThinkPadFanController
REM download - http://www.staff.uni-marburg.de/~schmitzr/donate.html (was http://sourceforge.net/project/shownotes.php?release_id=376867)
text
**************************
* ThinkPad Fan Controller
**************************
endtext

gosub run "Shareware\ThinkPadFanController\tpfc_v062.exe"

echo Updating icons...
call DelFile "%pd\TPFanControl.lnk"
call MergeDir /q "%pp\TPFanControl" "%pp\Operating System\Other"

return

:BetterExplorer
REM http://bexplorer.codeplex.com/
text
************************
* Better Explorer
************************
endtext

gosub run "Shareware\Better Explorer\setup\setup v2.0.0.631.exe"

echo Updating icons...
call MergeDir /q "%pp\Better Explorer" "%pp\Operating System\Other"
call MergeDir /q "%up\Better Explorer" "%pp\Operating System\Other"

return

:Toad
REM download Toad development suite - https://support.quest.com/Search/SearchDownloads.aspx?dsNav=Ns:P_DateLastModifiedSortable|101|-1|,N:268441797&Dt=Toad%20for%20SQL%20Server
text
************************
* Toad
************************
endtext

gosub run "Quest\Toad\setup\msxml.msi"
gosub run "Quest\Toad\setup\Toad Development Suite for SQL Server 5.8 Commercial.exe"

echo Moving data folder...
call MakeLink merge "%UserData\Benchmark Factory" hide "%UserDocuments\My Benchmark Factory"

echo Updating icons...
call DelFile "%pd\Benchmark Factory for Databases*.lnk"
call DelFile "%pd\Toad for SQL Server 5.8*.lnk"
call MoveFile "%pd\(prog).lnk" "%pp\Applications"
call MergeDir /q "%pp\Quest Software" "%pp\Development\Other"

return

:JpegLosslessRotator
REM http://annystudio.com/software/jpeglosslessrotator/#jpegr-download
text
************************
* JPEG Lossless Rotator
************************
endtext

gosub run "Shareware\JPEG Lossless Rotator\jpegr v8.0.0.0.exe"

echo Updating icons...
call DelFile "%pd\JPEG Lossless Rotator.lnk"
call MergeDir /q "%pp\JPEG Lossless Rotator" "%pp\Media\Other"

return

:PreviewHandlerPack
REM http://previewhandlers.codeplex.com/
text
************************
* Preview Handler Pack
************************
endtext

gosub run "Shareware\other\PreviewHandlerPackSetup.msi"

return

:GoogleDrive
:gd
text
************************
* Google Drive
************************
endtext

gosub run "Google\Drive\gsync.msi"

echo Updating registry...

REM Delete GoogleDriveSync - "C:\Program Files (x86)\Google\Drive\googledrivesync.exe" /autostart
call registry 32 delete "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\GoogleDriveSync"

echo Updating icons...
call DelFile "%ud\Google Drive.lnk"
call MergeDir /q "%pp\Google Drive" "%pp\Operating System\Other"
if "%date" != "c:" call MakeShortcut.btm "%UserHome\Google Drive" "%UserSysHome\Google Drive.lnk"

return

CloudFoundy

:CloudFoundry
REM http://www.cloudfoundry.com/
text
************************
* Cloud Foundry
************************
endtext

gosub run "CloudFoundry\setup\IronFoundry.CloudFoundryExplorer.%@OsArchitecture[].msi"
gosub run "CloudFoundry\setup\IronFoundry.Vmc.x64.msi"

echo Updating icons...
call DelFile "%pd\JPEG Lossless Rotator.lnk"
call MergeDir /q "%pp\Iron Foundry" "%pp\Development\Other"

text
- Manage Clouds, Login name:  your intel.com email address. Password:  your WWID
endtext

return

:WindowsSdk
text
************************
* Windows SDK
************************
endtext

gosub run "Microsoft\Windows\sdk\GRMSDK%@if[ %@OsArchitecture[] == x64 ,X]_EN_DVD.iso"

echo Updating icons...
call MergeDir /q /rename "%pp\Microsoft Windows SDK v7.1" "%pp\Development\Other\Windows SDK"

return

:NuGetPackageExplorer
:npe
text
************************
* NuGet Package Explorer
************************
endtext

gosub run "Shareware\.NET\NuGet\Package Explorer\NuGetPackageExplorer.application"

call MoveFile "%ud\NuGet Package Explorer.appref-ms" "%pp\Development\.NET"
call DelDir "%up\NuGet Package Explorer"

return

:doxygen
text
************************
* Doxygen
************************
endtext

gosub run "Shareware\Doxygen\setup\doxygen-1.8.2-setup.exe"

echo Updating icons...
call MergeDir /q "%pp\doxygen" "%pp\Development\Other"

return

:SqlPrompt
REM http://www.red-gate.com/products/sql-development/sql-prompt
text
************************
* SQL Prompt 5
************************
endtext

gosub run "RedGate\SQLPromptDownload.exe"

echo Updating icons...
call MergeDir /q "%pp\Red Gate" "%pp\Development\Other"

text
- SQL Prompt 5, Options...
  - Format, Tabs & wraping, Characters per line=120
  - Experimental Features, check Enable Tabs Instead of Spaces
endtext

return

:Nxt
text
************************
* NXT 
************************
endtext

gosub run "National Instruments\NXT\setup\setup.exe"

set InstallDir="%programs32\LEGO Software\LEGO MINDSTORMS Edu NXT\manual"
gosub run "National Instruments\NXT\manual"

echo Updating icons...
call MergeDir /q "%pp\LEGO MINDSTORMS Edu NXT 2.1" "%ao"
call DelFile "%pd\NXT 2.1 *.lnk"
call MakeShortcut "%programs32\LEGO Software\LEGO MINDSTORMS Edu NXT\manual\assets\languages\english\index.html" ^
	"%ao\LEGO MINDSTORMS Edu NXT 2.1\NXT Manual.lnk"

echo Moving data folder...
call MakeLink merge "%UserData\LEGO Creations" hide "%UserDocuments\LEGO Creations"

return

:Plex
REM http://www.plexapp.com/download/plex-media-center.php
text
************************
* Plex Media Center
************************
endtext

gosub run "Plex\setup\Plex-Media-Center-v3213059-en-US.exe"

echo Updating icons...
call MergeDir /q "%up\Plex Media Center" "%pp\Media\Other"

return

:Synology
text
************************
* Synology Assistant
************************
endtext

gosub run "Synology\DSM\setup\DSAssistant_2647\SynologyAssistantSetup-4.1-2647.exe"

echo Updating icons...
call MergeDir /q "%pp\Synology" "%pp\Operating System\Other"
call DelFile "%pd\Synology Assistant.lnk"

return

:OpenVPN
text
************************
* OpenVPN
************************
endtext

gosub run "Shareware\OpenVPN\setup\openvpn-install-2.3.0-I004-x86_64.exe"

echo Restoring the default profile...
call OpenVPN profile restore default

echo Updating icons...
call MergeDir /q "%pp\TAP-Windows" "%pp\Operating System\Other"
call MergeDir /q "%pp\OpenVPN" "%pp\Operating System\Other"
call DelFile "%pd\OpenVPN GUI.lnk"

return

:pGina
REM http://pgina.org/download.html
text
************************
* pGina
************************
endtext

set RunOptions=/silent
gosub run "Shareware\pGina\setup\pGinaSetup-3.1.7.1.exe"

echo Updating icons...
call MergeDir /q "%pp\pGina" "%pp\Operating System\other"

echo Restoring the default profile...
call pGina profile restore default

return

:ApacheDirectoryStudio
text
************************
* Apache Directory Studio
************************
endtext

gosub run "Apache\Directory Studio\setup\ApacheDirectoryStudio-win32-x86_64-2.0.0.v20130308.exe"

echo Updating icons...
call MergeDir /q "%up\Apache Directory Studio" "%pp\Operating System\other"

return

:MySqlWorkbench
text
************************
* MySQL Workbench
************************
endtext

gosub run "Shareware\MySql\mysql-workbench-gpl-5.2.47-win32.msi"

echo Updating icons...
call MergeDir /q "%pp\MySQL" "%pp\Development\Other"

return

:BlueGriffon
REM http://bluegriffon.org/pages/Download
text
************************
* BlueGriffon
************************
endtext

set InstallDir=%programs32\BlueGriffon
gosub run "Shareware\BlueGriffon\setup\bluegriffon-win32.zip"

echo Updating icons...
call MakeShortcut "%programs32\BlueGriffon\bluegriffon.exe" "%pp\Development\BlueGriffon.lnk"

return

:GitHub
text
************************
* GitHub for Windows
************************
endtext

gosub run "GitHub\setup\GitHubSetup.exe"
return

:CygwinGit
text
************************
* Cygwin git
************************
endtext

echo - git, git-gui, gitk, git-completion (optional, may slow bash startup)
call cygwin.btm install

return

:GitExtensions
REM https://code.google.com/p/gitextensions/ http://msysgit.github.com/
text
************************
* Git Extensions
************************
endtext

text
- check Msysgit
- install Extra application icons
- Checkout as-is, commit as-is
endtext
gosub run "Shareware\GitExtensions\setup\GitExtensions246SetupComplete.msi"

echo Configuring git...
git config --system http.sslcainfo "%programs32\git\bin\curl-ca-bundle.crt"
git config core.filemode false

echo Updating icons...
call MergeDir /q "%pp\Git" "%pp\Development\Other"
call MergeDir /q "%pp\KDiff3" "%pp\Operating System\Other"
call MoveFile "%pp\Git Extensions.lnk" "%pp\Development\Other\Git"
call DelFile "%pd\Git Bash.lnk"
call DelFile "%pd\Git Extensions.lnk"

text
- Git Extensions, check Check for uncommitted changes in checkout branch dialog
- Global settings
	- User name=jjbutare, User email=john.butare@intel.com, Editor="C:\Program Files\Sublime Text 2\sublime_text.exe",
	Mergetool=BeyondCompare3, Difftool=beyondcompare3
- SSH, Configure PuTTY, Path to=C:\Users\Public\Documents\data\bin\win32
- Checklist, review
endtext

return

:TortoiseGit
REM https://code.google.com/p/tortoisegit/ https://code.google.com/p/tortoisegit/wiki/Download?tm=2
text
************************
* TortoiseGit 
************************
endtext

gosub run "Shareware\TortoiseGit\setup\TortoiseGit-1.8.4.0-64bit.msi"

echo Updating icons...
call MergeDir /q "%pp\TortoiseGit" "%pp\Development\Other"

text
- Settings, Diff Viewer and Merge Tool, External
  c:\Program Files (x86)\Beyond Compare 3\BComp.exe
- Settings, Git, Credential, Credential helper=wincred - all Windows uses
  - do a clone with HTTPS and ensure second time no credential prompt
endtext

return

:SoapUI
REM http://sourceforge.net/projects/soapui/files/soapui/
text
************************
* SoapUI
************************
endtext

set InstallDir=%programs32\SoapUI
gosub run "Shareware\SoapUI\soapui-4.5.2-windows-bin.zip"

return

:EyeFi
text
************************
* Eye-Fi
************************
endtext

gosub run "Eye-Fi\setup.exe"

echo Updating icons...
call MergeDir /q "%up\Eye-Fi" "%pp\Media\Other"

return
